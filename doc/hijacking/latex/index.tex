\chapter{Hijacking degrees of freedom in oomph-\/lib}
\hypertarget{index}{}\label{index}\index{Hijacking degrees of freedom in oomph-\/lib@{Hijacking degrees of freedom in oomph-\/lib}}
Certain problem formulations require changing the equation corresponding to (having the same global number as) a particular degree of freedom.

For example, in steady free surface problems, there is a constraint on the total fluid volume, but no "{}obvious"{} associated degree of freedom. For these problems, a fluid pressure degree of freedom may be "{}traded"{} for the volume constraint. The "{}traded"{} degree of freedom remains a fluid pressure and must appear in the governing equations in that role. However, the equation associated with that unknown is no longer the continuity equation, but the volume constraint, see \href{../../navier_stokes/static_single_layer/html/index.html}{\texttt{ another tutorial }} for more details.

A similar situation arises when applying complex boundary conditions\+: perhaps the fluid velocity on the boundary is itself the solution of an equation depending on a local chemical concentration. One way of implementing such boundary conditions is to introduce a new variable representing the boundary velocity, solve the additional equation for that velocity and then impose that as a Dirichlet condition. However, the condition can be implemented without introducing a new variable by changing the equation associated with the fluid velocity on the boundary.

In {\ttfamily oomph-\/lib}, this type of process is known as {\bfseries{hijacking}} and uses the {\ttfamily Hijacked} wrapper class, which adds new member functions to the element\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{Data*\ hijack\_internal\_value(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \&n,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \&i)}
\DoxyCodeLine{Data*\ hijack\_external\_value(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \&n,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \&i)}
\DoxyCodeLine{Data*\ hijack\_nodal\_value(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \&n,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \&i)}
\DoxyCodeLine{Data*\ hijack\_nodal\_position\_value(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \&n,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \&i)}
\DoxyCodeLine{Data*\ hijack\_nodal\_spine\_value(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \&n,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \&i)}

\end{DoxyCode}


Calling any of these functions instructs the bulk element to set the specified residual and associated row in the Jacobian matrix to zero. For example, 
\begin{DoxyCode}{0}
\DoxyCodeLine{Hijacked<QPoissonElement<1,2>\ >\ *el\_pt\ =\ \textcolor{keyword}{new}\ Hijacked<QPoissonElement<1,3>\ >;}
\DoxyCodeLine{el\_pt-\/>hijack\_nodal\_value(0,0);}

\end{DoxyCode}
 sets to zero the residual associated with the first data value stored at the first (local) node in the element.

Note that hijacking is on a per element basis, so that if a degree of freedom is shared between elements it can be hijacked in all, none or some of them, as required.

The return type of each member function is a pointer to a {\ttfamily Data} object. This {\ttfamily Data} object is a "{}custom"{} object that consists of a (copy of a) single value corresponding to the "{}hijacked"{} degree of freedom and its global equation number. This object is provided so that it can be used as external data in other elements that assemble the "{}new"{} equations for the unknown, see \href{../../navier_stokes/static_single_layer/html/index.html}{\texttt{ another tutorial }} for an example. Note that this can lead to memory leaks unless the new object is safely deleted, so if you do not want to make use of the {\ttfamily Data} object you should precede the call to the member function by {\ttfamily delete}, e.\+g. 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{delete}\ el\_pt-\/>hijack\_internal\_value(0,0);}

\end{DoxyCode}


\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_notes}{}\doxysection{\texorpdfstring{Notes and Guidelines}{Notes and Guidelines}}\label{index_notes}

\begin{DoxyItemize}
\item If you do not assign a new equation to the "{}hijacked"{} unknown the Jacobian matrix will be singular because there will be a zero row.
\item Hijacking should take place before equation numbering.
\item The member function {\ttfamily Hijacked\+::unhijack\+\_\+all\+\_\+data()} can be used to reset all hijacked values in an element.
\item Hijacking will persist throughout adaptation, but only if the degree of freedom remains "{}active"{}. It is safest to {\ttfamily unhijack\+\_\+all\+\_\+data()} before adaptation and then hijack again in {\ttfamily actions\+\_\+after\+\_\+adapt()}.
\item All free surface elements are actually {\ttfamily Hijacked}, because hijacking is used to enforce the contact angle condition in certain circumstances.
\item The member function 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{double}*\ \&Hijacked::residual\_multiplier\_pt()\ }

\end{DoxyCode}
 can be used to set a double value that multiplies the hijacked residuals. The default and most common case it that the multiplier is zero, but non-\/zero values may be useful in homotopy continuation calculations in order to move smoothly between different types of boundary condition.
\end{DoxyItemize}\DoxyHorRuler{0}


\DoxyHorRuler{0}
 \DoxyHorRuler{0}
 \hypertarget{index_pdf}{}\doxysection{\texorpdfstring{PDF file}{PDF file}}\label{index_pdf}
A \href{../latex/refman.pdf}{\texttt{ pdf version}} of this document is available. \end{document}
