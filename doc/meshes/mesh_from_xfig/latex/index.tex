\chapter{Unstructured 2D Delaunay mesh generation with xfig and Triangle}
\hypertarget{index}{}\label{index}\index{Unstructured 2D Delaunay mesh generation with xfig and Triangle@{Unstructured 2D Delaunay mesh generation with xfig and Triangle}}
In this document we demonstrate how to use {\ttfamily oomph-\/lib\textquotesingle{}s} conversion routine {\ttfamily fig2poly} (a C++-\/based stand-\/alone executable, generated from the source code \href{../../../../demo_drivers/meshing/mesh_from_xfig_triangle/fig2poly.cc}{\texttt{ fig2poly.\+cc}} to create {\ttfamily \texorpdfstring{$\ast$}{*}}.{\ttfamily poly} files for \href{http://www.cs.berkeley.edu/~jrs/}{\texttt{ Jonathan Shewchuk\textquotesingle{}s}} open-\/source mesh generator \href{http://www.cs.cmu.edu/~quake/triangle.html}{\texttt{ {\ttfamily Triangle} }}, based on the output from the open-\/source drawing program \href{http://en.wikipedia.org/wiki/Xfig}{\texttt{ xfig.}}

\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_xfig_input}{}\doxysection{\texorpdfstring{Mesh generation with xfig, fig2poly and Triangle}{Mesh generation with xfig, fig2poly and Triangle}}\label{index_xfig_input}
Mesh generation with \href{http://en.wikipedia.org/wiki/Xfig}{\texttt{ xfig}}, {\ttfamily fig2poly} and \href{http://www.cs.cmu.edu/~quake/triangle.html}{\texttt{ {\ttfamily Triangle} }} is extremely straightforward.


\begin{DoxyEnumerate}
\item Draw the (piecewise linear) domain boundaries, using \href{http://en.wikipedia.org/wiki/Xfig}{\texttt{ xfig\textquotesingle{}s}} polyline drawing tool. Each polyline represents a distinct mesh boundary. The start and end points of the polyline should not coincide -- {\ttfamily fig2poly} will automatically "{}fill in"{} the missing line segment. ~\newline
~\newline

\item If the domain has any holes, place a single circle (drawn with \href{http://en.wikipedia.org/wiki/Xfig}{\texttt{ xfig\textquotesingle{}s}} circle/ellipse drawing tool) into each hole. Use the circle/ellipse drawing tool that requires the specification of the radius. The radius of the circle is irrelevant. ~\newline
~\newline

\item Save the figure as a {\ttfamily \texorpdfstring{$\ast$}{*}}. {\ttfamily fig} file. ~\newline
~\newline

\item Use {\ttfamily fig2poly} to convert the {\ttfamily \texorpdfstring{$\ast$}{*}}. {\ttfamily fig} file into a {\ttfamily \texorpdfstring{$\ast$}{*}}. {\ttfamily fig}. {\ttfamily poly} file. For instance, 
\begin{DoxyCode}{0}
\DoxyCodeLine{./fig2poly\ some\_figure.fig}

\end{DoxyCode}
 will generate a file {\ttfamily some\+\_\+figure}.{\ttfamily fig}. {\ttfamily poly}. ~\newline
~\newline

\item Process the {\ttfamily \texorpdfstring{$\ast$}{*}}. {\ttfamily fig}. {\ttfamily poly} file produced by {\ttfamily fig2poly} with \href{http://www.cs.cmu.edu/~quake/triangle.html}{\texttt{ Triangle}} and use the resulting {\ttfamily \texorpdfstring{$\ast$}{*}}.poly, {\ttfamily \texorpdfstring{$\ast$}{*}}.ele and {\ttfamily \texorpdfstring{$\ast$}{*}}.node files as input to {\ttfamily oomph-\/lib\textquotesingle{}s} {\ttfamily Triangle\+Mesh}, as described in \href{../../mesh_from_triangle/html/index.html}{\texttt{ another example.}} ~\newline
~\newline

\item Done!
\end{DoxyEnumerate}\hypertarget{index_xfig_comments}{}\doxysubsection{\texorpdfstring{Comments\+:}{Comments:}}\label{index_xfig_comments}

\begin{DoxyItemize}
\item {\ttfamily fig2poly} expects the \href{http://en.wikipedia.org/wiki/Xfig}{\texttt{ xfig}} output file to conform to "{}\+Fig format 3.\+2"{} and checks for the presence of the string "{}\#\+FIG 3.\+2"{} in the first line of the {\ttfamily \texorpdfstring{$\ast$}{*}}. {\ttfamily fig} file. below. ~\newline
~\newline

\item The figure must contain only polylines and circles. The presence of any other objects will spawn an error message and cause {\ttfamily fig2poly} to terminate. ~\newline
~\newline

\item The figure must not contain any "{}compound objects"{}. Compound objects may, of course, be used while drawing but you should break them up before saving the figure. ~\newline
~\newline

\end{DoxyItemize}

\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_hole_poisson}{}\doxysection{\texorpdfstring{Example 1\+: Solution of Poisson\textquotesingle{}s equation on a rectangular domain with a hole}{Example 1: Solution of Poisson's equation on a rectangular domain with a hole}}\label{index_hole_poisson}
Here is a screen shot from an xfig session. The figure defines a quadrilateral domain with a quadrilateral hole.

 
\begin{DoxyImage}
\includegraphics[width=0.75\textwidth]{hole_screen_shot}
\doxyfigcaption{Screen shot of xfig session. }
\end{DoxyImage}


Here is a plot of the resulting mesh. It was generated by converting the file {\ttfamily hole.\+fig} generated by xfig, to {\ttfamily hole.\+fig.\+poly}, using {\ttfamily fig2poly} and processing the resulting file with


\begin{DoxyCode}{0}
\DoxyCodeLine{triangle\ -\/pq\ -\/a0.02\ hole.fig.poly}

\end{DoxyCode}


 
\begin{DoxyImage}
\includegraphics[width=0.75\textwidth]{hole_mesh}
\doxyfigcaption{The mesh. }
\end{DoxyImage}


Finally, the figure below shows a plot of the computed solution of a Poisson equation with a unit source function, obtained with three-\/noded (red) and six-\/noded (green) triangular Poisson elements\+:

 
\begin{DoxyImage}
\includegraphics[width=0.75\textwidth]{hole_poisson}
\doxyfigcaption{Solution of Poisson\textquotesingle{}s equation on the mesh generated from the xfig output. }
\end{DoxyImage}


This solution was computed with the driver code \href{../../../../demo_drivers/meshing/mesh_from_xfig_triangle/mesh_from_xfig_poisson.cc}{\texttt{ mesh\+\_\+from\+\_\+xfig\+\_\+poisson.\+cc.}} \DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_oomph_nst}{}\doxysection{\texorpdfstring{Example 2\+: Finite-\/\+Reynolds-\/number flow past the oomph-\/lib logo}{Example 2: Finite-Reynolds-number flow past the oomph-lib logo}}\label{index_oomph_nst}
Here is a screen shot from another xfig session. The figure defines a quadrilateral domain containing the oomph-\/lib logo whose letters create holes in the domain.

 
\begin{DoxyImage}
\includegraphics[width=0.75\textwidth]{oomph_screen_shot}
\doxyfigcaption{Screen shot of xfig session }
\end{DoxyImage}


Here is a plot of the mesh generated with the same procedure discussed above.

 
\begin{DoxyImage}
\includegraphics[width=0.75\textwidth]{oomph_mesh}
\doxyfigcaption{The mesh. }
\end{DoxyImage}


Finally, the figure below shows a plot of the solution of the steady Navier-\/\+Stokes equations (velocity vectors and pressure contours) in this domain. No-\/slip conditions were applied on all boundaries. Zero velocities were imposed on all boundaries apart from the outer bounding box (boundary 1) where we set  \[
{\bf u} = 
\left(
\begin{array}{c}
-1 \\
-1
\end{array}
\right).
\] The plot may therefore be interpreted as showing the flow field that is generated when the rigid quadrilateral box that surrounds the oomph-\/lib logo moves in the north-\/westerly direction while the logo itself remains stationary. This was computed with the driver code \href{../../../../demo_drivers/meshing/mesh_from_xfig_triangle/mesh_from_xfig_navier_stokes.cc}{\texttt{ mesh\+\_\+from\+\_\+xfig\+\_\+navier\+\_\+stokes.\+cc}} which is very similar to that for the \href{../../../navier_stokes/driven_cavity/html/index.html}{\texttt{ driven cavity problem,}} so we shall not discuss in in detail.

 
\begin{DoxyImage}
\includegraphics[width=0.75\textwidth]{oomph_flow}
\doxyfigcaption{Flow past the oomph-\/lib logo. }
\end{DoxyImage}


\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_comments}{}\doxysection{\texorpdfstring{Comments and Exercises}{Comments and Exercises}}\label{index_comments}
\hypertarget{index_bound}{}\doxysubsection{\texorpdfstring{Numbering of the mesh boundaries}{Numbering of the mesh boundaries}}\label{index_bound}

\begin{DoxyEnumerate}
\item Each polyline in the \href{http://en.wikipedia.org/wiki/Xfig}{\texttt{ xfig}}-\/generated figure represents a distinct mesh boundary. {\ttfamily fig2poly} assigns boundary numbers to these, depending on the order in which the polylines are listed in the {\ttfamily \texorpdfstring{$\ast$}{*}}. {\ttfamily fig} file. Since this is not always obvious, it is usually necessary to examine the mesh boundaries by calling {\ttfamily Mesh\+::output\+\_\+boundaries(...)} before assigning boundary conditions. ~\newline
~\newline

\item Since boundaries are defined by closed polygons, all nodes that are located on a specific polygon have the same boundary number. In cases where a finer sub-\/division of the boundary is required (e.\+g. to identify inflow boundaries) some post-\/processing of the mesh may be required.
\end{DoxyEnumerate}\hypertarget{index_ex}{}\doxysubsection{\texorpdfstring{Exercises}{Exercises}}\label{index_ex}

\begin{DoxyEnumerate}
\item Download and install \href{http://en.wikipedia.org/wiki/Xfig}{\texttt{ xfig}} (if you work in a linux environment, \href{http://en.wikipedia.org/wiki/Xfig}{\texttt{ xfig}} is likely to be available already as it is part of many linux distributions) and create your own meshes. ~\newline
~\newline

\item Think of a way to modify the \href{http://en.wikipedia.org/wiki/Xfig}{\texttt{ xfig}}-\/based mesh generation procedure so that a closed boundary can contain several sub-\/boundaries so that in-\/ and outflow boundaries can be identified separately. \mbox{[}This is an "{}advanced"{} exercise and one to which no solution exists as yet -- please let us have your code if you find an easy way to do this!\mbox{]}.
\end{DoxyEnumerate}

\DoxyHorRuler{0}
 \DoxyHorRuler{0}
 \hypertarget{index_pdf}{}\doxysection{\texorpdfstring{PDF file}{PDF file}}\label{index_pdf}
A \href{../latex/refman.pdf}{\texttt{ pdf version}} of this document is available. \end{document}
