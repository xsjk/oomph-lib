\chapter{Example problem\+: Adaptive solution of the 2D advection diffusion equation}
\hypertarget{index}{}\label{index}\index{Example problem: Adaptive solution of the 2D advection diffusion equation@{Example problem: Adaptive solution of the 2D advection diffusion equation}}
In this example we discuss the adaptive solution of the 2D advection-\/diffusion problem

\begin{center} \tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{1}{|X[-1]}|}
\hline
\begin{center} {\bfseries{Two-\/dimensional advection-\/diffusion problem in a rectangular domain}} \end{center}  Solve  \[
\mbox{Pe}\ \sum_{i=1}^2 w_i \left(x_1,x_2\right) \frac{\partial u}{\partial
x_i} = \sum_{i=1}^2 \frac{\partial^2u}{\partial x_i^2} + f(x_1,x_2), 
 \ \ \ \ \ \ \ \ \ \ (1)
\] in the rectangular domain $D =\left\{ (x_1,x_2) \in 
[0,1] \times [0,2]\right\}$, with Dirichlet boundary conditions  \[
\left. u\right|_{\partial D}=u_0,
\ \ \ \ \ \ \ \ \ \ (2)
\]

where the {\itshape Peclet} {\itshape number}, $ \mbox{Pe} $ the boundary values, $ u_0$, the source function $ f(x_1,x_2),$ ~\newline
 and the components of the "{}wind"{} $ w_i(x_1,x_2) \ (i=1,2)$ are given.   \\\cline{1-1}
\end{longtabu}
~\newline
 \end{center}  ~\newline


We choose the forcing function and the boundary conditions such that  \[
u_0(x_1,x_2) = \tanh(1-\alpha(x_1 \tan\Phi - x_2)),
\ \ \ \ \ \ \ \ \  (3)
\] is the exact solution of the problem. For large values of $ \alpha, $ the exact solution approaches a step, oriented at an angle $\Phi$ against the $x_1-$axis.

In the computations we will impose the "{}wind"{}  \[
\mathbf{w}\left(x_1,x_2 \right) = 
\left(
\begin{array}{c}
\sin(6x_2) \\
 \cos(6x_1)
\end{array}
\right),
\ \ \ \ \ \ \ \ \  (4)
\] illustrated in this vector plot\+:

 
\begin{DoxyImage}
\includegraphics[width=0.75\textwidth]{wind}
\doxyfigcaption{Plot of the wind. }
\end{DoxyImage}


The graph below shows a plot of the solution, computed at various levels of mesh adaptation, for $\Phi=45^\circ, \ \alpha=50 $ and a Peclet number of $ Pe = 200.$

 
\begin{DoxyImage}
\includegraphics[width=0.75\textwidth]{step_soln}
\doxyfigcaption{Plot of the forced solution at different levels of mesh refinement. }
\end{DoxyImage}


More interesting is the following plot which shows the solution for the same parameter values and boundary conditions, but for a zero forcing function, $ f\equiv 0. $

 
\begin{DoxyImage}
\includegraphics[width=0.75\textwidth]{unforced_soln}
\doxyfigcaption{Plot of the unforced solution at different levels of mesh refinement. }
\end{DoxyImage}


The plot nicely illustrates the physical effects represented by the (unforced) advection diffusion equation. If $ u(x_1,x_2) $ represents the concentration of a chemical that is advected by the velocity field $ {\bf w}$, while being dispersed by molecular diffusion, the advection-\/diffusion equation describes the steady-\/state concentration of this chemical. In this context the Peclet number is a measure of the relative importance of advective and diffusive effects. For very small Peclet number, the concentration is determined predominantly by diffusive effects -- as $ \mbox{Pe} \to 0$, the advection diffusion equation approaches the Poisson equation. Conversely, at large values of the Peclet number, the concentration is determined predominantly by advective effects. The chemical is "{}swept along"{} by the flow and diffusive effects are only important in thin "{}boundary"{} or "{}shear"{} layers in which the concentration varies over short lengthscales. These can be seen clearly in the most finely resolved solution above.

\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_main}{}\doxysection{\texorpdfstring{The driver code}{The driver code}}\label{index_main}
Overall, the structure of the driver code is very similar to that in the \href{../../../poisson/two_d_poisson/html/index.html}{\texttt{ corresponding Poisson example}}. The only difference is that we have to specify function pointers to the source and the "{}wind"{} functions, which are passed to the problem constructor. We create the problem, perform a self-\/test, set the global parameters that affect the solution and solve the problem using {\ttfamily oomph-\/lib\textquotesingle{}s} "{}black-\/box"{} adaptive Newton solver.

 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//=====\ start\_of\_main=====================================================}}
\DoxyCodeLine{\textcolor{comment}{///\ Driver\ code\ for\ 2D\ AdvectionDiffusion\ problem}}
\DoxyCodeLine{\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\textcolor{keywordtype}{int}\ \mbox{\hyperlink{two__d__adv__diff__adapt_8cc_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}}()}
\DoxyCodeLine{\{}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//Set\ up\ the\ problem}}
\DoxyCodeLine{\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Create\ the\ problem\ with\ 2D\ nine-\/node\ refineable\ elements\ from\ the}}
\DoxyCodeLine{\ \textcolor{comment}{//\ RefineableQuadAdvectionDiffusionElement\ family.\ Pass\ pointer\ to\ }}
\DoxyCodeLine{\ \textcolor{comment}{//\ source\ and\ wind\ function.\ }}
\DoxyCodeLine{\ \mbox{\hyperlink{classRefineableAdvectionDiffusionProblem}{RefineableAdvectionDiffusionProblem}}<RefineableQAdvectionDiffusionElement<2,}
\DoxyCodeLine{\ \ 3>\ >\ problem(\&\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_aaa1aa95713b02b211812fdd18eeaa369}{TanhSolnForAdvectionDiffusion::source\_function}},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_ab40e93031d34986762c69616c3c8b065}{TanhSolnForAdvectionDiffusion::wind\_function}});}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Check\ if\ we're\ ready\ to\ go:}}
\DoxyCodeLine{\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\ cout\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n\(\backslash\)nProblem\ self-\/test\ "{}};}
\DoxyCodeLine{\ \textcolor{keywordflow}{if}\ (problem.self\_test()==0)\ }
\DoxyCodeLine{\ \ \{}
\DoxyCodeLine{\ \ \ cout\ <<\ \textcolor{stringliteral}{"{}passed:\ Problem\ can\ be\ solved."{}}\ <<\ std::endl;}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\ \textcolor{keywordflow}{else}\ }
\DoxyCodeLine{\ \ \{}
\DoxyCodeLine{\ \ \ \textcolor{keywordflow}{throw}\ OomphLibError(\textcolor{stringliteral}{"{}Self\ test\ failed"{}},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Set\ the\ orientation\ of\ the\ "{}step"{}\ to\ 45\ degrees}}
\DoxyCodeLine{\ \mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a236bf82c661189623706b7c9d9b0c52f}{TanhSolnForAdvectionDiffusion::TanPhi}}=1.0;}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Choose\ a\ large\ value\ for\ the\ steepness\ of\ the\ "{}step"{}}}
\DoxyCodeLine{\ \mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a4d202e8ac48cc75f760ef40681402ec7}{TanhSolnForAdvectionDiffusion::Alpha}}=50.0;\ }
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Solve\ the\ problem,\ performing\ up\ to\ 4\ adptive\ refinements}}
\DoxyCodeLine{\ problem.newton\_solve(4);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//Output\ the\ solution}}
\DoxyCodeLine{\ problem.doc\_solution();}
\DoxyCodeLine{\ }
\DoxyCodeLine{\}\ \textcolor{comment}{//\ end\ of\ main}}

\end{DoxyCodeInclude}


\DoxyHorRuler{0}
 ~\newline
 \DoxyHorRuler{0}
\hypertarget{index_global}{}\doxysection{\texorpdfstring{Global parameters and functions}{Global parameters and functions}}\label{index_global}
The specification of the source function and the exact solution in the namespace {\ttfamily \doxylink{namespaceTanhSolnForAdvectionDiffusion}{Tanh\+Soln\+For\+Advection\+Diffusion}} is similar to that for the \href{../../../poisson/two_d_poisson/html/index.html\#global}{\texttt{ Poisson examples.}} The only difference is the inclusion of the Peclet number and the "{}wind"{} function.

 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//======start\_of\_namespace============================================}}
\DoxyCodeLine{\textcolor{comment}{///\ Namespace\ for\ exact\ solution\ for\ AdvectionDiffusion\ equation\ }\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{///\ with\ "{}sharp"{}\ step\ }}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//====================================================================}}
\DoxyCodeLine{\textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion}{TanhSolnForAdvectionDiffusion}}}
\DoxyCodeLine{\{}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Peclet\ number}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_aeba486af70e92ab7eec1da3ce44d51ee}{Peclet}}=200.0;}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Parameter\ for\ steepness\ of\ step}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a4d202e8ac48cc75f760ef40681402ec7}{Alpha}};}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Parameter\ for\ angle\ of\ step}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a236bf82c661189623706b7c9d9b0c52f}{TanPhi}};}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Exact\ solution\ as\ a\ Vector}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_ae4c9ed0a4f123ec8e634f0cc45bfcebc}{get\_exact\_u}}(\textcolor{keyword}{const}\ Vector<double>\&\ x,\ Vector<double>\&\ u)}
\DoxyCodeLine{\ \{}
\DoxyCodeLine{\ \ u[0]=tanh(1.0-\/\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a4d202e8ac48cc75f760ef40681402ec7}{Alpha}}*(\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a236bf82c661189623706b7c9d9b0c52f}{TanPhi}}*x[0]-\/x[1]));}
\DoxyCodeLine{\ \}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Exact\ solution\ as\ a\ scalar}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_ae4c9ed0a4f123ec8e634f0cc45bfcebc}{get\_exact\_u}}(\textcolor{keyword}{const}\ Vector<double>\&\ x,\ \textcolor{keywordtype}{double}\&\ u)}
\DoxyCodeLine{\ \{}
\DoxyCodeLine{\ \ u=tanh(1.0-\/\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a4d202e8ac48cc75f760ef40681402ec7}{Alpha}}*(\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a236bf82c661189623706b7c9d9b0c52f}{TanPhi}}*x[0]-\/x[1]));}
\DoxyCodeLine{\ \}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Source\ function\ required\ to\ make\ the\ solution\ above\ an\ exact\ solution\ }}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_aaa1aa95713b02b211812fdd18eeaa369}{source\_function}}(\textcolor{keyword}{const}\ Vector<double>\&\ x\_vect,\ \textcolor{keywordtype}{double}\&\ source)}
\DoxyCodeLine{\ \{}
\DoxyCodeLine{\ \ \textcolor{keywordtype}{double}\ x=x\_vect[0];}
\DoxyCodeLine{\ \ \textcolor{keywordtype}{double}\ y=x\_vect[1];}
\DoxyCodeLine{\ \ source\ =\ }
\DoxyCodeLine{2.0*tanh(-\/0.1E1+\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a4d202e8ac48cc75f760ef40681402ec7}{Alpha}}*(\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a236bf82c661189623706b7c9d9b0c52f}{TanPhi}}*x-\/y))*(1.0-\/pow(tanh(-\/0.1E1+\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a4d202e8ac48cc75f760ef40681402ec7}{Alpha}}*(}
\DoxyCodeLine{\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a236bf82c661189623706b7c9d9b0c52f}{TanPhi}}*x-\/y)),2.0))*\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a4d202e8ac48cc75f760ef40681402ec7}{Alpha}}*\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a4d202e8ac48cc75f760ef40681402ec7}{Alpha}}*\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a236bf82c661189623706b7c9d9b0c52f}{TanPhi}}*\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a236bf82c661189623706b7c9d9b0c52f}{TanPhi}}+2.0*tanh(-\/0.1E1+\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a4d202e8ac48cc75f760ef40681402ec7}{Alpha}}*(\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a236bf82c661189623706b7c9d9b0c52f}{TanPhi}}*x-\/y)}
\DoxyCodeLine{)*(1.0-\/pow(tanh(-\/0.1E1+\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a4d202e8ac48cc75f760ef40681402ec7}{Alpha}}*(\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a236bf82c661189623706b7c9d9b0c52f}{TanPhi}}*x-\/y)),2.0))*\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a4d202e8ac48cc75f760ef40681402ec7}{Alpha}}*\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a4d202e8ac48cc75f760ef40681402ec7}{Alpha}}-\/\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_aeba486af70e92ab7eec1da3ce44d51ee}{Peclet}}*(-\/sin(6.0*y}
\DoxyCodeLine{)*(1.0-\/pow(tanh(-\/0.1E1+\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a4d202e8ac48cc75f760ef40681402ec7}{Alpha}}*(\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a236bf82c661189623706b7c9d9b0c52f}{TanPhi}}*x-\/y)),2.0))*\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a4d202e8ac48cc75f760ef40681402ec7}{Alpha}}*\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a236bf82c661189623706b7c9d9b0c52f}{TanPhi}}+cos(6.0*x)*(1.0-\/}
\DoxyCodeLine{pow(tanh(-\/0.1E1+\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a4d202e8ac48cc75f760ef40681402ec7}{Alpha}}*(\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a236bf82c661189623706b7c9d9b0c52f}{TanPhi}}*x-\/y)),2.0))*\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_a4d202e8ac48cc75f760ef40681402ec7}{Alpha}});}
\DoxyCodeLine{\ \}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Wind}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_ab40e93031d34986762c69616c3c8b065}{wind\_function}}(\textcolor{keyword}{const}\ Vector<double>\&\ x,\ Vector<double>\&\ wind)}
\DoxyCodeLine{\ \{}
\DoxyCodeLine{\ \ wind[0]=sin(6.0*x[1]);}
\DoxyCodeLine{\ \ wind[1]=cos(6.0*x[0]);}
\DoxyCodeLine{\ \}}
\DoxyCodeLine{\ }
\DoxyCodeLine{\}\ \textcolor{comment}{//\ end\ of\ namespace}}

\end{DoxyCodeInclude}
 \DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_problem}{}\doxysection{\texorpdfstring{The problem class}{The problem class}}\label{index_problem}
The problem class is very similar to those used in the corresponding \href{../../../poisson/two_d_poisson/html/index.html\#problem}{\texttt{ Poisson examples.}} The only change is that we use the function {\ttfamily Problem\+::actions\+\_\+before\+\_\+adapt()} to document the progress of the automatic spatial adaptation. For this purpose, we store a {\ttfamily Doc\+Info} as private member data in the {\ttfamily Problem}. This allows us to increment the counter that labels the output files, accessible from {\ttfamily Doc\+Info\+::number()}, whenever a new solution has been documented.

 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//======\ start\_of\_problem\_class=======================================}}
\DoxyCodeLine{\textcolor{comment}{///\ 2D\ AdvectionDiffusion\ problem\ on\ rectangular\ domain,\ discretised\ }\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{///\ with\ refineable\ 2D\ QAdvectionDiffusion\ elements.\ The\ specific\ type}}
\DoxyCodeLine{\textcolor{comment}{///\ of\ element\ is\ specified\ via\ the\ template\ parameter.}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//====================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class}\ ELEMENT>\ }
\DoxyCodeLine{\textcolor{keyword}{class\ }\mbox{\hyperlink{classRefineableAdvectionDiffusionProblem}{RefineableAdvectionDiffusionProblem}}\ :\ \textcolor{keyword}{public}\ Problem}
\DoxyCodeLine{\{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{public}:}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Constructor:\ Pass\ pointer\ to\ source\ and\ wind\ functions}}
\DoxyCodeLine{\textcolor{comment}{}\ \mbox{\hyperlink{classRefineableAdvectionDiffusionProblem}{RefineableAdvectionDiffusionProblem}}(}
\DoxyCodeLine{\ \ AdvectionDiffusionEquations<2>::AdvectionDiffusionSourceFctPt\ source\_fct\_pt,}
\DoxyCodeLine{\ \ AdvectionDiffusionEquations<2>::AdvectionDiffusionWindFctPt\ wind\_fct\_pt);}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Destructor.\ Empty}}
\DoxyCodeLine{\textcolor{comment}{}\ \mbox{\hyperlink{classRefineableAdvectionDiffusionProblem_ae746646f6c255dca13e5abe9fcf85fe3}{\string~RefineableAdvectionDiffusionProblem}}()\{\}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Update\ the\ problem\ specs\ before\ solve:\ Reset\ boundary\ conditions}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ to\ the\ values\ from\ the\ tanh\ solution.}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classRefineableAdvectionDiffusionProblem_a7cbcaa45fd7e932f335cc07a83b4d3e2}{actions\_before\_newton\_solve}}();}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Update\ the\ problem\ after\ solve\ (empty)}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classRefineableAdvectionDiffusionProblem_a949296e60bc661fbd523974055a93f8b}{actions\_after\_newton\_solve}}()\{\}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Actions\ before\ adapt:\ Document\ the\ solution}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classRefineableAdvectionDiffusionProblem_a3470a408c458e5500ac614b8f0e65634}{actions\_before\_adapt}}()}
\DoxyCodeLine{\ \ \{}
\DoxyCodeLine{\ \ \ \textcolor{comment}{//\ Doc\ the\ solution}}
\DoxyCodeLine{\ \ \ \mbox{\hyperlink{classRefineableAdvectionDiffusionProblem_a735d7fdd587d4730ffe1113b11ca3b56}{doc\_solution}}();}
\DoxyCodeLine{\ \ \ }
\DoxyCodeLine{\ \ \ \textcolor{comment}{//\ Increment\ label\ for\ output\ files}}
\DoxyCodeLine{\ \ \ \mbox{\hyperlink{classRefineableAdvectionDiffusionProblem_a42bd65f40095a70a103ee900e7614b19}{Doc\_info}}.number()++;}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Doc\ the\ solution.}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classRefineableAdvectionDiffusionProblem_a735d7fdd587d4730ffe1113b11ca3b56}{doc\_solution}}();}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Overloaded\ version\ of\ the\ problem's\ access\ function\ to\ }}
\DoxyCodeLine{\textcolor{comment}{\ ///\ the\ mesh.\ Recasts\ the\ pointer\ to\ the\ base\ Mesh\ object\ to\ }}
\DoxyCodeLine{\textcolor{comment}{\ ///\ the\ actual\ mesh\ type.}}
\DoxyCodeLine{\textcolor{comment}{}\ RefineableRectangularQuadMesh<ELEMENT>*\ \mbox{\hyperlink{classRefineableAdvectionDiffusionProblem_a9f5a735394a1359c63cb4eaf98dd9e87}{mesh\_pt}}()\ }
\DoxyCodeLine{\ \ \{}
\DoxyCodeLine{\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{dynamic\_cast<}RefineableRectangularQuadMesh<ELEMENT>*\textcolor{keyword}{>}(}
\DoxyCodeLine{\ \ \ \ Problem::mesh\_pt());}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{private}:}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ DocInfo\ object}}
\DoxyCodeLine{\textcolor{comment}{}\ DocInfo\ \mbox{\hyperlink{classRefineableAdvectionDiffusionProblem_a42bd65f40095a70a103ee900e7614b19}{Doc\_info}};}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Pointer\ to\ source\ function}}
\DoxyCodeLine{\textcolor{comment}{}\ AdvectionDiffusionEquations<2>::AdvectionDiffusionSourceFctPt\ \mbox{\hyperlink{classRefineableAdvectionDiffusionProblem_a8fa313562d365965e24282c2e11a8ec6}{Source\_fct\_pt}};}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Pointer\ to\ wind\ function}}
\DoxyCodeLine{\textcolor{comment}{}\ AdvectionDiffusionEquations<2>::AdvectionDiffusionWindFctPt\ \mbox{\hyperlink{classRefineableAdvectionDiffusionProblem_ab52483c93bacbb9521aaaf52680be996}{Wind\_fct\_pt}};}
\DoxyCodeLine{}
\DoxyCodeLine{\};\ \textcolor{comment}{//\ end\ of\ problem\ class}}

\end{DoxyCodeInclude}


\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_constructor}{}\doxysection{\texorpdfstring{The Problem constructor}{The Problem constructor}}\label{index_constructor}
The constructor is practically identical to the constructors used in the various \href{../../../poisson/two_d_poisson/html/index.html\#constructor}{\texttt{ Poisson examples.}} We specify the output directory in the {\ttfamily Problem\textquotesingle{}s} {\ttfamily Doc\+Info} object, create the mesh and an error estimator, and apply the boundary conditions by pinning the nodal values on the Dirichlet boundaries.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//=====start\_of\_constructor===============================================}}
\DoxyCodeLine{\textcolor{comment}{///\ Constructor\ for\ AdvectionDiffusion\ problem:\ Pass\ pointer\ to\ }\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{///\ source\ function.}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class}\ ELEMENT>}
\DoxyCodeLine{\mbox{\hyperlink{classRefineableAdvectionDiffusionProblem_a515147bf0907ad339811955edb89817c}{RefineableAdvectionDiffusionProblem<ELEMENT>::RefineableAdvectionDiffusionProblem}}(}
\DoxyCodeLine{\ AdvectionDiffusionEquations<2>::AdvectionDiffusionSourceFctPt\ source\_fct\_pt,}
\DoxyCodeLine{\ AdvectionDiffusionEquations<2>::AdvectionDiffusionWindFctPt\ wind\_fct\_pt)}
\DoxyCodeLine{\ \ \ \ \ \ \ :\ \ Source\_fct\_pt(source\_fct\_pt),\ Wind\_fct\_pt(wind\_fct\_pt)}
\DoxyCodeLine{\{\ }
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Set\ output\ directory}}
\DoxyCodeLine{\ Doc\_info.set\_directory(\textcolor{stringliteral}{"{}RESLT"{}});}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Setup\ mesh}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ \#\ of\ elements\ in\ x-\/direction}}
\DoxyCodeLine{\ \textcolor{keywordtype}{unsigned}\ n\_x=4;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ \#\ of\ elements\ in\ y-\/direction}}
\DoxyCodeLine{\ \textcolor{keywordtype}{unsigned}\ n\_y=4;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Domain\ length\ in\ x-\/direction}}
\DoxyCodeLine{\ \textcolor{keywordtype}{double}\ l\_x=1.0;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Domain\ length\ in\ y-\/direction}}
\DoxyCodeLine{\ \textcolor{keywordtype}{double}\ l\_y=2.0;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Build\ and\ assign\ mesh}}
\DoxyCodeLine{\ Problem::mesh\_pt()\ =\ }
\DoxyCodeLine{\ \ \textcolor{keyword}{new}\ RefineableRectangularQuadMesh<ELEMENT>(n\_x,n\_y,l\_x,l\_y);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Create/set\ error\ estimator}}
\DoxyCodeLine{\ mesh\_pt()-\/>spatial\_error\_estimator\_pt()=\textcolor{keyword}{new}\ Z2ErrorEstimator;}
\DoxyCodeLine{\ \ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Set\ the\ boundary\ conditions\ for\ this\ problem:\ All\ nodes\ are}}
\DoxyCodeLine{\ \textcolor{comment}{//\ free\ by\ default\ -\/-\/\ only\ need\ to\ pin\ the\ ones\ that\ have\ Dirichlet\ }}
\DoxyCodeLine{\ \textcolor{comment}{//\ conditions\ here}}
\DoxyCodeLine{\ \textcolor{keywordtype}{unsigned}\ num\_bound\ =\ mesh\_pt()-\/>nboundary();}
\DoxyCodeLine{\ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ ibound=0;ibound<num\_bound;ibound++)}
\DoxyCodeLine{\ \ \{}
\DoxyCodeLine{\ \ \ \textcolor{keywordtype}{unsigned}\ num\_nod=\ mesh\_pt()-\/>nboundary\_node(ibound);}
\DoxyCodeLine{\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ inod=0;inod<num\_nod;inod++)}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ mesh\_pt()-\/>boundary\_node\_pt(ibound,inod)-\/>pin(0);\ }
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \}\ \textcolor{comment}{//\ end\ loop\ over\ boundaries}}

\end{DoxyCodeInclude}
 We complete the problem setup by passing the function pointers to the source and wind functions, and the pointer to the Peclet number to the elements. Finally, we set up the equation numbering scheme.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\ \textcolor{comment}{//\ Complete\ the\ build\ of\ all\ elements\ so\ they\ are\ fully\ functional\ }}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Loop\ over\ the\ elements\ to\ set\ up\ element-\/specific\ }}
\DoxyCodeLine{\ \textcolor{comment}{//\ things\ that\ cannot\ be\ handled\ by\ the\ (argument-\/free!)\ ELEMENT\ }}
\DoxyCodeLine{\ \textcolor{comment}{//\ constructor:\ Pass\ pointer\ to\ source\ function}}
\DoxyCodeLine{\ \textcolor{keywordtype}{unsigned}\ n\_element\ =\ mesh\_pt()-\/>nelement();}
\DoxyCodeLine{\ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ i=0;i<n\_element;i++)}
\DoxyCodeLine{\ \ \{}
\DoxyCodeLine{\ \ \ \textcolor{comment}{//\ Upcast\ from\ GeneralsedElement\ to\ the\ present\ element}}
\DoxyCodeLine{\ \ \ ELEMENT\ *el\_pt\ =\ \textcolor{keyword}{dynamic\_cast<}ELEMENT*\textcolor{keyword}{>}(mesh\_pt()-\/>element\_pt(i));}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \textcolor{comment}{//Set\ the\ source\ function\ pointer}}
\DoxyCodeLine{\ \ \ el\_pt-\/>source\_fct\_pt()\ =\ Source\_fct\_pt;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \textcolor{comment}{//Set\ the\ wind\ function\ pointer}}
\DoxyCodeLine{\ \ \ el\_pt-\/>wind\_fct\_pt()\ =\ Wind\_fct\_pt;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \textcolor{comment}{//\ Set\ the\ Peclet\ number}}
\DoxyCodeLine{\ \ \ el\_pt-\/>pe\_pt()\ =\ \&\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_aeba486af70e92ab7eec1da3ce44d51ee}{TanhSolnForAdvectionDiffusion::Peclet}};}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Setup\ equation\ numbering\ scheme}}
\DoxyCodeLine{\ cout\ <<\textcolor{stringliteral}{"{}Number\ of\ equations:\ "{}}\ <<\ assign\_eqn\_numbers()\ <<\ std::endl;\ }
\DoxyCodeLine{}
\DoxyCodeLine{\}\ \textcolor{comment}{//\ end\ of\ constructor}}

\end{DoxyCodeInclude}
 \DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_actions_before}{}\doxysection{\texorpdfstring{Actions before solve}{Actions before solve}}\label{index_actions_before}
As before, we use the {\ttfamily Problem\+::actions\+\_\+before\+\_\+newton\+\_\+solve()} function to set/update the boundary conditions.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//========================================start\_of\_actions\_before\_newton\_solve===}}
\DoxyCodeLine{\textcolor{comment}{///\ Update\ the\ problem\ specs\ before\ solve:\ (Re-\/)set\ boundary\ conditions}\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{///\ to\ the\ values\ from\ the\ tanh\ solution.}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class}\ ELEMENT>}
\DoxyCodeLine{\textcolor{keywordtype}{void}\ \mbox{\hyperlink{classRefineableAdvectionDiffusionProblem_a7cbcaa45fd7e932f335cc07a83b4d3e2}{RefineableAdvectionDiffusionProblem<ELEMENT>::actions\_before\_newton\_solve}}()}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \textcolor{comment}{//\ How\ many\ boundaries\ are\ there?}}
\DoxyCodeLine{\ \textcolor{keywordtype}{unsigned}\ num\_bound\ =\ mesh\_pt()-\/>nboundary();}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//Loop\ over\ the\ boundaries}}
\DoxyCodeLine{\ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ ibound=0;ibound<num\_bound;ibound++)}
\DoxyCodeLine{\ \ \{}
\DoxyCodeLine{\ \ \ \textcolor{comment}{//\ How\ many\ nodes\ are\ there\ on\ this\ boundary?}}
\DoxyCodeLine{\ \ \ \textcolor{keywordtype}{unsigned}\ num\_nod=mesh\_pt()-\/>nboundary\_node(ibound);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ nodes\ on\ boundary}}
\DoxyCodeLine{\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ inod=0;inod<num\_nod;inod++)}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \textcolor{comment}{//\ Get\ pointer\ to\ node}}
\DoxyCodeLine{\ \ \ \ \ Node*\ nod\_pt=mesh\_pt()-\/>boundary\_node\_pt(ibound,inod);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \textcolor{comment}{//\ Extract\ nodal\ coordinates\ from\ node:}}
\DoxyCodeLine{\ \ \ \ \ Vector<double>\ x(2);}
\DoxyCodeLine{\ \ \ \ \ x[0]=nod\_pt-\/>x(0);}
\DoxyCodeLine{\ \ \ \ \ x[1]=nod\_pt-\/>x(1);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \textcolor{comment}{//\ Compute\ the\ value\ of\ the\ exact\ solution\ at\ the\ nodal\ point}}
\DoxyCodeLine{\ \ \ \ \ Vector<double>\ u(1);}
\DoxyCodeLine{\ \ \ \ \ \mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_ae4c9ed0a4f123ec8e634f0cc45bfcebc}{TanhSolnForAdvectionDiffusion::get\_exact\_u}}(x,u);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \textcolor{comment}{//\ Assign\ the\ value\ to\ the\ one\ (and\ only)\ nodal\ value\ at\ this\ node}}
\DoxyCodeLine{\ \ \ \ \ nod\_pt-\/>set\_value(0,u[0]);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \}\ }
\DoxyCodeLine{\}\ \ \textcolor{comment}{//\ end\ of\ actions\ before\ solve}}

\end{DoxyCodeInclude}
 \DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_doc}{}\doxysection{\texorpdfstring{Post-\/processing}{Post-processing}}\label{index_doc}
The function {\ttfamily doc\+\_\+solution(...)} is identical to that in the \href{../../../poisson/two_d_poisson/html/index.html\#doc}{\texttt{ Poisson example.}} We output the solution, the exact solution and the error.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//===============start\_of\_doc=============================================}}
\DoxyCodeLine{\textcolor{comment}{///\ Doc\ the\ solution}}
\DoxyCodeLine{\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class}\ ELEMENT>}
\DoxyCodeLine{\textcolor{keywordtype}{void}\ \mbox{\hyperlink{classRefineableAdvectionDiffusionProblem_a735d7fdd587d4730ffe1113b11ca3b56}{RefineableAdvectionDiffusionProblem<ELEMENT>::doc\_solution}}()}
\DoxyCodeLine{\{\ }
\DoxyCodeLine{}
\DoxyCodeLine{\ ofstream\ some\_file;}
\DoxyCodeLine{\ \textcolor{keywordtype}{char}\ filename[100];}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Number\ of\ plot\ points:\ npts\ x\ npts}}
\DoxyCodeLine{\ \textcolor{keywordtype}{unsigned}\ npts=5;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Output\ solution\ }}
\DoxyCodeLine{\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\ sprintf(filename,\textcolor{stringliteral}{"{}\%s/soln\%i.dat"{}},Doc\_info.directory().c\_str(),}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ Doc\_info.number());}
\DoxyCodeLine{\ some\_file.open(filename);}
\DoxyCodeLine{\ mesh\_pt()-\/>output(some\_file,npts);}
\DoxyCodeLine{\ some\_file.close();}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Output\ exact\ solution\ }}
\DoxyCodeLine{\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\ sprintf(filename,\textcolor{stringliteral}{"{}\%s/exact\_soln\%i.dat"{}},Doc\_info.directory().c\_str(),}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ Doc\_info.number());}
\DoxyCodeLine{\ some\_file.open(filename);}
\DoxyCodeLine{\ mesh\_pt()-\/>output\_fct(some\_file,npts,\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_ae4c9ed0a4f123ec8e634f0cc45bfcebc}{TanhSolnForAdvectionDiffusion::get\_exact\_u}});\ }
\DoxyCodeLine{\ some\_file.close();}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Doc\ error\ and\ return\ of\ the\ square\ of\ the\ L2\ error}}
\DoxyCodeLine{\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\ \textcolor{keywordtype}{double}\ error,norm;}
\DoxyCodeLine{\ sprintf(filename,\textcolor{stringliteral}{"{}\%s/error\%i.dat"{}},Doc\_info.directory().c\_str(),}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ Doc\_info.number());}
\DoxyCodeLine{\ some\_file.open(filename);}
\DoxyCodeLine{\ mesh\_pt()-\/>compute\_error(some\_file,\mbox{\hyperlink{namespaceTanhSolnForAdvectionDiffusion_ae4c9ed0a4f123ec8e634f0cc45bfcebc}{TanhSolnForAdvectionDiffusion::get\_exact\_u}},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ error,norm);\ }
\DoxyCodeLine{\ some\_file.close();}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Doc\ L2\ error\ and\ norm\ of\ solution}}
\DoxyCodeLine{\ cout\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)nNorm\ of\ error\ \ \ :\ "{}}\ <<\ sqrt(error)\ <<\ std::endl;\ }
\DoxyCodeLine{\ cout\ <<\ \textcolor{stringliteral}{"{}Norm\ of\ solution:\ "{}}\ <<\ sqrt(norm)\ <<\ std::endl\ <<\ std::endl;}
\DoxyCodeLine{}
\DoxyCodeLine{\}\ \textcolor{comment}{//\ end\ of\ doc}}

\end{DoxyCodeInclude}
 \DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_com}{}\doxysection{\texorpdfstring{Comments and Exercises}{Comments and Exercises}}\label{index_com}

\begin{DoxyEnumerate}
\item Explore the change in the character of the solution of the unforced problem when the Peclet number is slowly increased from 0 to 200, say. Note how at small Peclet number, strong diffusive effects smooth out the rapid spatial variations imposed by the boundary conditions. Conversely, at large values of the Peclet number, the behaviour is dominated by advective effects. As a result, in regions where the "{}wind"{} is directed into the domain, the value of $ u $ set by the Dirichlet boundary conditions is "{}swept"{} into the domain. In regions where the "{}wind"{} is directed out of the domain, the value of $ u $ "{}swept along"{} by the flow in the interior "{}clashes"{} with the value prescribed by the boundary conditions and the solution adjusts itself over a very short length scale, leading to the development of thin "{}boundary layers"{}.
\item Explore the character of the solution on coarse meshes at large and small Peclet numbers. Note how at large Peclet numbers the solution on the coarse meshes displays strong "{}wiggles"{} throughout the domain. These only disappear once the mesh adaptation fully resolves the regions of rapid variation. We will explore this issue further in \href{../../two_d_adv_diff_SUPG/html/index.html}{\texttt{ another example.}}
\end{DoxyEnumerate}

\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_sources}{}\doxysection{\texorpdfstring{Source files for this tutorial}{Source files for this tutorial}}\label{index_sources}

\begin{DoxyItemize}
\item The source files for this tutorial are located in the directory\+: \begin{center} \href{../../../../demo_drivers/advection_diffusion/two_d_adv_diff_adapt/}{\texttt{ demo\+\_\+drivers/advection\+\_\+diffusion/two\+\_\+d\+\_\+adv\+\_\+diff\+\_\+adapt/ }} \end{center} 
\item The driver code is\+: \begin{center} \href{../../../../demo_drivers/advection_diffusion/two_d_adv_diff_adapt/two_d_adv_diff_adapt.cc}{\texttt{ demo\+\_\+drivers/advection\+\_\+diffusion/two\+\_\+d\+\_\+adv\+\_\+diff\+\_\+adapt/two\+\_\+d\+\_\+adv\+\_\+diff\+\_\+adapt.\+cc }} \end{center} 
\end{DoxyItemize}\DoxyHorRuler{0}
 \DoxyHorRuler{0}
 \hypertarget{index_pdf}{}\doxysection{\texorpdfstring{PDF file}{PDF file}}\label{index_pdf}
A \href{../latex/refman.pdf}{\texttt{ pdf version}} of this document is available. \end{document}
