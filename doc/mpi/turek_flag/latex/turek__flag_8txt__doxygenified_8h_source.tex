\doxysection{turek\+\_\+flag.\+txt\+\_\+doxygenified.\+h}
\hypertarget{turek__flag_8txt__doxygenified_8h_source}{}\label{turek__flag_8txt__doxygenified_8h_source}\mbox{\hyperlink{turek__flag_8txt__doxygenified_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00001}00001\ \textcolor{comment}{/**}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00002}00002\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00003}00003\ \textcolor{comment}{\(\backslash\)mainpage\ Parallel\ solution\ of\ Turek\ \&\ Hron's\ FSI\ benchmark\ problem\ with\ spatial\ adaptivity\ for\ the\ fluid\ and\ solid\ meshes}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00004}00004\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00005}00005\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00006}00006\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00007}00007\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00008}00008\ \textcolor{comment}{This\ document\ provides\ an\ overview\ of\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00009}00009\ \textcolor{comment}{-\/\ how\ to\ change\ the\ serial\ driver\ code\ for\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00010}00010\ \textcolor{comment}{\ \ <a\ href="{}../../../interaction/turek\_flag/html/index.html"{}>Turek\ \&}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00011}00011\ \textcolor{comment}{\ \ Hron's\ FSI\ benchmark\ problem</a>\ so\ that\ both\ the\ fluid\ and\ solid\ meshes}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00012}00012\ \textcolor{comment}{\ \ can\ be\ adapted,\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00013}00013\ \textcolor{comment}{.\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00014}00014\ \textcolor{comment}{-\/\ how\ to\ distribute\ the\ problem\ across\ multiple\ processors,}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00015}00015\ \textcolor{comment}{.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00016}00016\ \textcolor{comment}{and}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00017}00017\ \textcolor{comment}{-\/\ how\ to\ enable\ load\ balancing\ of\ the\ problem\ once\ it\ is\ distributed.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00018}00018\ \textcolor{comment}{.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00019}00019\ \textcolor{comment}{The\ document\ is\ part\ of\ a}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00020}00020\ \textcolor{comment}{<a\ href="{}../../../example\_code\_list/html/index.html\#distributed"{}>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00021}00021\ \textcolor{comment}{series\ of\ tutorials</a>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00022}00022\ \textcolor{comment}{that\ discuss\ how\ to\ modify\ existing\ serial\ driver\ codes\ so\ that\ the}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00023}00023\ \textcolor{comment}{\(\backslash\)c\ Problem\ object\ can\ be\ distributed\ across\ multiple\ processors.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00024}00024\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00025}00025\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00026}00026\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00027}00027\ \textcolor{comment}{<HR>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00028}00028\ \textcolor{comment}{<HR>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00029}00029\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00030}00030\ \textcolor{comment}{\(\backslash\)section\ double\_adapt\ Enabling\ spatial\ adaptivity\ for\ the\ fluid\ and\ solid\ meshes}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00031}00031\ \textcolor{comment}{In\ the\ original\ (serial)\ driver\ code\ for\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00032}00032\ \textcolor{comment}{<a\ href="{}../../../interaction/turek\_flag/html/index.html"{}>Turek\ \&}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00033}00033\ \textcolor{comment}{Hron's\ FSI\ benchmark\ problem</a>\ we\ only\ adapted\ the\ fluid\ mesh.\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00034}00034\ \textcolor{comment}{Before\ discussing\ how\ to\ modify\ the\ code\ to\ refine\ the\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00035}00035\ \textcolor{comment}{fluid\ and\ solid\ meshes\ simultaneously,\ we\ provide\ a}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00036}00036\ \textcolor{comment}{brief\ reminder\ of\ the\ procedure\ used\ to\ discretise\ fluid-\/structure}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00037}00037\ \textcolor{comment}{interaction\ problems\ that\ involve\ fluid\ and\ solid\ domains\ of\ equal\ spatial}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00038}00038\ \textcolor{comment}{dimension\ (e.g.\ a\ 2D\ fluid\ domain\ interacting\ with\ a\ 2D\ solid\ domain)}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00039}00039\ \textcolor{comment}{when\ using\ algebraic\ node\ update\ methods\ to\ adjust\ the\ position\ of}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00040}00040\ \textcolor{comment}{the\ nodes\ in\ the\ fluid\ mesh.\ \ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00041}00041\ \textcolor{comment}{We\ refer\ to\ <a\ href="{}../../fsi\_channel\_with\_leaflet/html/index.html"{}>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00042}00042\ \textcolor{comment}{another\ tutorial</a>\ for\ a\ discussion\ of\ FSI}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00043}00043\ \textcolor{comment}{problems\ involving\ the\ interaction\ of\ fluids\ with\ (lower-\/dimensional)}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00044}00044\ \textcolor{comment}{shell\ and\ beam\ structures.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00045}00045\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00046}00046\ \textcolor{comment}{\(\backslash\)subsection\ orig\ General\ methodology}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00047}00047\ \textcolor{comment}{\ \ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00048}00048\ \textcolor{comment}{The\ figure\ below\ shows\ a\ sketch\ of\ \ a\ simple(r)}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00049}00049\ \textcolor{comment}{fluid-\/structure\ interaction\ problem\ involving\ fluid\ and\ solid\ domains\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00050}00050\ \textcolor{comment}{that\ meet\ along\ a\ single\ mesh\ boundary.\ We\ assume\ that\ the\ fluid\ mesh\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00051}00051\ \textcolor{comment}{uses\ an\ algebraic\ node\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00052}00052\ \textcolor{comment}{update\ function\ to\ adjust\ the\ position\ of\ its\ nodes\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00053}00053\ \textcolor{comment}{in\ response\ to\ changes\ in\ the\ domain\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00054}00054\ \textcolor{comment}{boundary,\ represented\ by\ the\ \(\backslash\)c\ GeomObject\ shown\ in\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00055}00055\ \textcolor{comment}{magenta.\ (You\ may\ wish\ to\ consult}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00056}00056\ \textcolor{comment}{<a\ href="{}../../../interaction/fsi\_collapsible\_channel\_algebraic/html/index.html"{}>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00057}00057\ \textcolor{comment}{another\ tutorial</a>\ for\ a\ reminder\ of\ how\ \(\backslash\)c\ oomph-\/lib's\ algebraic}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00058}00058\ \textcolor{comment}{node\ update\ methods\ work).\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00059}00059\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00060}00060\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00061}00061\ \textcolor{comment}{\(\backslash\)image\ html\ fsi\_with\_adaptive\_wall\_basic.gif\ "{}Basic\ setup\ for\ FSI\ problems\ involving\ algebraic\ node\ updates\ for\ the\ fluid\ mesh.\ "{}\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00062}00062\ \textcolor{comment}{\(\backslash\)image\ latex\ fsi\_with\_adaptive\_wall\_basic.eps\ "{}Basic\ setup\ for\ FSI\ problems\ involving\ algebraic\ node\ updates\ for\ the\ fluid\ mesh.\ "{}\ width=0.75\(\backslash\)textwidth}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00063}00063\ \textcolor{comment}{\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00064}00064\ \textcolor{comment}{In\ an\ FSI\ problem,\ the\ fluid\ mesh's\ free}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00065}00065\ \textcolor{comment}{boundary\ is\ a\ boundary\ of\ the\ solid\ mesh,\ <em>\ i.e.\ </em>\ the}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00066}00066\ \textcolor{comment}{boundary\ along\ which\ the\ fluid\ exerts\ a\ traction\ onto\ the\ solid.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00067}00067\ \textcolor{comment}{Within\ \(\backslash\)c\ oomph-\/lib,\ the\ fluid\ traction\ is\ applied\ to\ the\ solid\ domain}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00068}00068\ \textcolor{comment}{by\ attaching\ \(\backslash\)c\ FSISolidTractionElements\ to\ the\ faces\ of\ the\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00069}00069\ \textcolor{comment}{"{}bulk"{}\ solid\ elements\ adjacent\ to\ the\ FSI\ boundary.\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00070}00070\ \textcolor{comment}{(In\ the\ above\ sketch\ the\ \(\backslash\)c\ FSISolidTractionElements\ are\ shown}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00071}00071\ \textcolor{comment}{in\ blue.)}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00072}00072\ \textcolor{comment}{The\ deformation\ of\ the\ fluid\ and\ solid\ meshes\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00073}00073\ \textcolor{comment}{is\ coupled\ by\ using\ the\ \(\backslash\)c\ MeshAsGeomObject\ formed\ from\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00074}00074\ \textcolor{comment}{the\ \(\backslash\)c\ FSISolidTractionElements\ as\ the\ \(\backslash\)c\ GeomObject\ that\ defines}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00075}00075\ \textcolor{comment}{the\ moving\ boundary\ of\ the\ fluid\ mesh.\ (In\ sketch\ above,\ this\ is\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00076}00076\ \textcolor{comment}{indicated\ by\ the\ magenta\ arrow.)}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00077}00077\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00078}00078\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00079}00079\ \textcolor{comment}{\(\backslash\)subsection\ modification1\ Modifications\ to\ allow\ adaptivity\ of\ the\ fluid\ and\ solid\ meshes}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00080}00080\ \textcolor{comment}{\ \ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00081}00081\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00082}00082\ \textcolor{comment}{If\ the\ solid\ mesh\ is\ not\ adapted,\ the\ adaptation\ for\ the\ fluid}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00083}00083\ \textcolor{comment}{mesh\ \ is\ straightforward\ and\ proceeds\ fully\ automatically}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00084}00084\ \textcolor{comment}{as\ described\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00085}00085\ \textcolor{comment}{<a\ href="{}../../../interaction/fsi\_collapsible\_channel\_algebraic/html/index.html"{}>elsewhere</a>.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00086}00086\ \textcolor{comment}{In\ particular,\ the\ node\ update\ data\ for}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00087}00087\ \textcolor{comment}{newly-\/created\ fluid\ nodes\ is\ created\ automatically\ by\ a\ call\ to\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00088}00088\ \textcolor{comment}{the\ \(\backslash\)c\ AlgebraicMesh::update\_node\_update(...)\ function\ during\ the\ adaptation.\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00089}00089\ \textcolor{comment}{This\ function\ obtains\ the\ required}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00090}00090\ \textcolor{comment}{information\ about\ the\ boundary\ by\ using\ the\ \(\backslash\)c\ MeshAsGeomObject\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00091}00091\ \textcolor{comment}{built\ from\ the\ \(\backslash\)c\ FSISolidTractionElements.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00092}00092\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00093}00093\ \textcolor{comment}{If\ the\ solid\ mesh\ is\ also\ adapted,\ then\ the\ existing\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00094}00094\ \textcolor{comment}{\(\backslash\)c\ FSISolidTractionElements\ must\ (at\ some\ point)\ be\ deleted\ and\ new\ ones}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00095}00095\ \textcolor{comment}{must\ be\ attached\ to\ the\ adapted\ "{}bulk"{}\ solid\ mesh.\ In\ all\ other\ problems,\ this}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00096}00096\ \textcolor{comment}{is\ done\ by}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00097}00097\ \textcolor{comment}{deleting\ the\ \(\backslash\)c\ FSISolidTractionElements\ in\ \(\backslash\)c}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00098}00098\ \textcolor{comment}{Problem::actions\_before\_adapt()\ and\ attaching\ new\ ones\ in\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00099}00099\ \textcolor{comment}{\(\backslash\)c\ Problem::actions\_after\_adapt();\ see,\ e.g.\ the\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00100}00100\ \textcolor{comment}{<a\ href="{}../../../poisson/two\_d\_poisson\_flux\_bc/html/index.html"{}>tutorial}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00101}00101\ \textcolor{comment}{on\ the\ solution\ of\ a\ Poisson\ problem\ with\ flux\ boundary\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00102}00102\ \textcolor{comment}{conditions.</a>\ However,\ in\ the\ present\ problem}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00103}00103\ \textcolor{comment}{this\ is\ not\ possible\ because,\ once\ the\ \(\backslash\)c\ FSISolidTractionElements\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00104}00104\ \textcolor{comment}{have\ been\ deleted,\ the\ \(\backslash\)c\ MeshAsGeomObject\ can\ no\ longer\ be\ used\ to\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00105}00105\ \textcolor{comment}{represent\ the\ shape\ and\ position\ of\ the\ FSI\ boundary,\ which\ would\ cause}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00106}00106\ \textcolor{comment}{the\ adaptation\ of\ the\ fluid\ mesh\ to\ fail.\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00107}00107\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00108}00108\ \textcolor{comment}{To\ avoid\ this\ problem,\ we\ adopt\ the\ following\ strategy:}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00109}00109\ \textcolor{comment}{-\/\#\ When\ adding\ the\ various\ meshes\ to\ the\ \(\backslash\)c\ Problem's}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00110}00110\ \textcolor{comment}{\ \ \ collection\ of\ sub-\/meshes,\ we\ add\ the\ fluid\ mesh}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00111}00111\ \textcolor{comment}{\ \ \ \(\backslash\)b\ before\ the\ solid\ mesh.\ (This\ happens\ to\ be\ what\ was\ done}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00112}00112\ \textcolor{comment}{\ \ \ already\ in\ the\ original\ driver\ code.)\ Usually,\ the\ order\ in\ which\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00113}00113\ \textcolor{comment}{\ \ \ sub-\/meshes\ are\ added\ to\ the\ \(\backslash\)c\ Problem\ is\ irrelevant.\ Here\ the\ order}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00114}00114\ \textcolor{comment}{\ \ \ \(\backslash\)b\ does\ matter\ because\ we\ will\ exploit\ the\ fact\ that}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00115}00115\ \textcolor{comment}{\ \ \ the\ sub-\/meshes\ are\ adapted\ individually,\ in\ the\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00116}00116\ \textcolor{comment}{\ \ \ order\ in\ which\ they\ were\ added\ to\ the\ \(\backslash\)c\ Problem.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00117}00117\ \textcolor{comment}{\ \ \ \(\backslash\)n\(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00118}00118\ \textcolor{comment}{-\/\#\ The\ \(\backslash\)c\ FSISolidTractionElements\ are\ not\ deleted\ in\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00119}00119\ \textcolor{comment}{\ \ \ \(\backslash\)c\ Problem::actions\_before\_adapt()\ and\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00120}00120\ \textcolor{comment}{\ \ \ remain\ attached\ to\ the\ "{}bulk"{}\ solid\ elements\ throughout\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00121}00121\ \textcolor{comment}{\ \ \ the\ "{}bulk"{}\ mesh\ adaptation\ procedure.\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00122}00122\ \textcolor{comment}{\ \ \ When\ the\ fluid\ mesh\ is\ adapted,\ the\ appropriate\ \(\backslash\)c\ MeshAsGeomObject}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00123}00123\ \textcolor{comment}{\ \ \ is,\ therefore,\ still\ fully-\/functional}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00124}00124\ \textcolor{comment}{\ \ \ (and\ refers\ to\ the\ boundary\ as\ represented\ by\ the\ solid\ domain}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00125}00125\ \textcolor{comment}{\ \ \ \(\backslash\)b\ before\ the\ "{}bulk"{}\ solid\ mesh\ is\ adapted).\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00126}00126\ \textcolor{comment}{\ \ \ \(\backslash\)n\(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00127}00127\ \textcolor{comment}{\ \ \ Here\ is\ a\ sketch\ of\ problem\ after\ adaptation\ of\ the\ fluid\ mesh:}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00128}00128\ \textcolor{comment}{\ \ \ \(\backslash\)n\(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00129}00129\ \textcolor{comment}{\(\backslash\)image\ html\ fsi\_with\_adaptive\_wall\_adapted\_fluid.gif\ "{}Sketch\ of\ the\ problem\ following\ the\ adaptation\ of\ the\ fluid\ mesh.\ The\ solid\ mesh\ has\ not\ yet\ been\ refined.\ "{}\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00130}00130\ \textcolor{comment}{\(\backslash\)image\ latex\ fsi\_with\_adaptive\_wall\_adapted\_fluid.eps\ "{}Sketch\ of\ the\ problem\ following\ the\ adaptation\ of\ the\ fluid\ mesh.\ The\ solid\ mesh\ has\ not\ yet\ been\ refined.\ "{}\ width=0.75\(\backslash\)textwidth}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00131}00131\ \textcolor{comment}{\ \ \ \(\backslash\)n\(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00132}00132\ \textcolor{comment}{-\/\#\ The\ subsequent\ adaptation\ of\ the\ "{}bulk"{}\ solid\ mesh\ is\ likely\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00133}00133\ \textcolor{comment}{\ \ \ to\ turn\ some\ of\ the\ \(\backslash\)c\ FSISolidTractionElements\ into\ "{}dangling"{}}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00134}00134\ \textcolor{comment}{\ \ \ elements.\ (This\ occurs\ whenever\ a\ \(\backslash\)c\ FSISolidTractionElements}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00135}00135\ \textcolor{comment}{\ \ \ is\ attached\ to\ a\ "{}bulk"{}\ solid\ elements\ that\ disappears\ during\ the}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00136}00136\ \textcolor{comment}{\ \ \ adaptation,\ <em>\ e.g.\ </em>\ by\ being\ refined.)\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00137}00137\ \textcolor{comment}{\ \ \ \(\backslash\)n\(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00138}00138\ \textcolor{comment}{\ \ \ Here\ is\ a\ plot\ of\ the\ problem\ following\ the\ adaptation\ of\ the}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00139}00139\ \textcolor{comment}{\ \ \ solid\ mesh\ :}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00140}00140\ \textcolor{comment}{\ \ \ \(\backslash\)n\(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00141}00141\ \textcolor{comment}{\(\backslash\)image\ html\ fsi\_with\_adaptive\_wall\_adapted\_solid.gif\ "{}Sketch\ of\ the\ problem\ following\ the\ adaptation\ of\ the\ solid\ mesh\ -\/-\/\ the\ \`{}dangling'\ FSISolidTractionElements\ are\ represented\ by\ dotted\ lines.\ "{}\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00142}00142\ \textcolor{comment}{\(\backslash\)image\ latex\ fsi\_with\_adaptive\_wall\_adapted\_solid.eps\ "{}Sketch\ of\ the\ problem\ following\ the\ adaptation\ of\ the\ solid\ mesh\ -\/-\/\ the\ \`{}dangling'\ FSISolidTractionElements\ are\ represented\ by\ dotted\ lines.\ "{}\ width=0.75\(\backslash\)textwidth}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00143}00143\ \textcolor{comment}{\ \ \ \(\backslash\)n\(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00144}00144\ \textcolor{comment}{-\/\#\ Hence,\ in\ \(\backslash\)c\ Problem::actions\_after\_adapt()\ we\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00145}00145\ \textcolor{comment}{\ \ \ delete\ the\ existing\ \ \(\backslash\)c\ FSISolidTractionElements\ and\ immediately\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00146}00146\ \textcolor{comment}{\ \ \ (re-\/)attach\ new\ ones.\ Now,\ the\ \(\backslash\)c\ MeshAsGeomObject\ that\ represents\ the}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00147}00147\ \textcolor{comment}{\ \ \ FSI\ boundary\ is\ broken\ because\ it\ still\ refers\ to\ the\ just\ deleted\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00148}00148\ \textcolor{comment}{\ \ \ \(\backslash\)c\ FSISolidTractionElements.\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00149}00149\ \textcolor{comment}{\ \ \ \(\backslash\)n\(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00150}00150\ \textcolor{comment}{\(\backslash\)image\ html\ fsi\_with\_adaptive\_wall\_new\_face\_elements.gif\ "{}Sketch\ of\ the\ problem\ following\ the\ creation\ of\ new\ FSISolidTractionElements.\ The\ fact\ that\ the\ MeshAsGeomObject\ is\ broken\ is\ indicated\ by\ the\ dashed\ lines.\ "{}\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00151}00151\ \textcolor{comment}{\(\backslash\)image\ latex\ fsi\_with\_adaptive\_wall\_new\_face\_elements.eps\ "{}Sketch\ of\ the\ problem\ following\ the\ creation\ of\ new\ FSISolidTractionElements.\ The\ fact\ that\ the\ MeshAsGeomObject\ is\ broken\ is\ indicated\ by\ the\ dashed\ lines.\ "{}\ width=0.75\(\backslash\)textwidth}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00152}00152\ \textcolor{comment}{\ \ \ \(\backslash\)n\(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00153}00153\ \textcolor{comment}{-\/\#\ Thus,\ we\ rebuild\ the\ \(\backslash\)c\ MeshAsGeomObject\ from\ the\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00154}00154\ \textcolor{comment}{\ \ \ newly-\/created\ \(\backslash\)c\ FSISolidTractionElements,\ and\ update\ the}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00155}00155\ \textcolor{comment}{\ \ \ fluid\ mesh's\ pointer\ to\ this\ new\ \(\backslash\)c\ GeomObject\ that\ describes\ the}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00156}00156\ \textcolor{comment}{\ \ \ boundary\ shape.\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00157}00157\ \textcolor{comment}{\ \ \ \(\backslash\)n\(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00158}00158\ \textcolor{comment}{\(\backslash\)image\ html\ fsi\_with\_adaptive\_wall\_done.gif\ "{}Sketch\ of\ the\ problem\ with\ re-\/built\ MeshAsGeomObject.\ "{}\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00159}00159\ \textcolor{comment}{\(\backslash\)image\ latex\ fsi\_with\_adaptive\_wall\_done.eps\ "{}Sketch\ of\ the\ problem\ with\ re-\/built\ MeshAsGeomObject.\ "{}\ width=0.75\(\backslash\)textwidth}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00160}00160\ \textcolor{comment}{\ \ \ \(\backslash\)n\(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00161}00161\ \textcolor{comment}{-\/\#\ Finally,\ we\ execute\ the\ \(\backslash\)c\ AlgebraicMesh::update\_node\_update(...)}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00162}00162\ \textcolor{comment}{\ \ \ function\ for\ all\ nodes\ in\ the\ fluid\ mesh\ to\ ensure\ that\ their}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00163}00163\ \textcolor{comment}{\ \ \ node\ update\ data\ refers\ to\ the\ new\ \(\backslash\)c\ FSISolidTractionElements.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00164}00164\ \textcolor{comment}{\ \ \ \(\backslash\)n\(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00165}00165\ \textcolor{comment}{-\/\#\ The\ remaining\ tasks\ (such\ as\ the\ renewed\ setup\ of\ the\ fluid\ load\ on\ the}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00166}00166\ \textcolor{comment}{\ \ \ \(\backslash\)c\ FSISolidTractionElements\ via\ a\ call\ to\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00167}00167\ \textcolor{comment}{\ \ \ \(\backslash\)c\ FSI\_functions::setup\_fluid\_load\_info\_for\_solid\_elements(...),\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00168}00168\ \textcolor{comment}{\ \ \ etc.)\ remain\ the\ same\ as\ in\ the\ previous\ version\ of\ the\ code.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00169}00169\ \textcolor{comment}{.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00170}00170\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00171}00171\ \textcolor{comment}{<HR>\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00172}00172\ \textcolor{comment}{<HR>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00173}00173\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00174}00174\ \textcolor{comment}{\(\backslash\)section\ distr\ Distributing\ the\ Problem}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00175}00175\ \textcolor{comment}{In\ the\ present\ example,\ there\ are\ two\ "{}bulk"{}}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00176}00176\ \textcolor{comment}{meshes\ corresponding\ to\ the\ fluid\ and\ solid\ domains}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00177}00177\ \textcolor{comment}{\ and\ three\ "{}surface"{}\ meshes\ of\ traction}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00178}00178\ \textcolor{comment}{elements.\ The\ traction\ elements\ are\ \(\backslash\)c\ FaceElements\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00179}00179\ \textcolor{comment}{created\ from\ the\ "{}bulk"{}\ fluid\ elements\ and\ should\ be\ deleted\ before\ the}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00180}00180\ \textcolor{comment}{problem\ is\ distributed,\ see\ the\ tutorial\ on\ applying\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00181}00181\ \textcolor{comment}{<a\ href="{}../../two\_d\_poisson\_flux\_bc\_adapt/html/index.html"{}>\ flux}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00182}00182\ \textcolor{comment}{boundary\ conditions\ in\ a\ Poisson\ problem\ </a>\ for\ more\ details.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00183}00183\ \textcolor{comment}{In\ the\ \ <a\ href="{}../../fsi\_channel\_with\_leaflet/html/index.html"{}>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00184}00184\ \textcolor{comment}{previous\ example</a>\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00185}00185\ \textcolor{comment}{involving\ the\ interaction\ of\ a\ 2D\ fluid\ domain\ with\ a\ 1D\ beam}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00186}00186\ \textcolor{comment}{structure\ there\ were\ only\ two\ meshes:\ a\ "{}bulk"{}\ fluid\ mesh}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00187}00187\ \textcolor{comment}{and\ a\ "{}surface"{}\ solid\ mesh.\ In\ that\ problem}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00188}00188\ \textcolor{comment}{\(\backslash\)b\ all\ elements\ in\ the}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00189}00189\ \textcolor{comment}{1D\ mesh\ of\ \(\backslash\)c\ FSIHermiteBeamElements\ were\ retained\ on\ all\ processors\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00190}00190\ \textcolor{comment}{as\ halo\ elements\ by\ using\ the\ function\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00191}00191\ \textcolor{comment}{\(\backslash\)c\ Mesh::keep\_all\_elements\_as\_halos().\ The\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00192}00192\ \textcolor{comment}{same\ methodology\ could\ be\ used\ here,\ but\ it\ would\ be\ extremely\ wasteful}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00193}00193\ \textcolor{comment}{to\ retain\ all\ the\ solid\ elements\ in\ the\ "{}bulk"{}\ solid\ mesh\ because\ only}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00194}00194\ \textcolor{comment}{the\ elements\ next\ to\ the\ FSI\ boundary\ are\ required.\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00195}00195\ \textcolor{comment}{Instead,\ we\ use\ a\ more\ fine-\/grained}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00196}00196\ \textcolor{comment}{method\ of\ retaining\ elements\ via\ the\ function\ \(\backslash\)c}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00197}00197\ \textcolor{comment}{GeneralisedElement::must\_be\_kept\_as\_halo().\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00198}00198\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00199}00199\ \textcolor{comment}{<HR>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00200}00200\ \textcolor{comment}{<HR>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00201}00201\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00202}00202\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00203}00203\ \textcolor{comment}{\(\backslash\)section\ impl\ Implementation}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00204}00204\ \textcolor{comment}{Most\ of\ the\ driver\ code\ is\ identical\ to\ the\ original\ serial\ version\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00205}00205\ \textcolor{comment}{discussed\ in\ <a\ href="{}../../fsi\_channel\_with\_leaflet/html/index.html"{}>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00206}00206\ \textcolor{comment}{another\ tutorial</a>.\ We\ therefore\ only\ discuss\ those\ parts\ of\ the}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00207}00207\ \textcolor{comment}{code\ that\ have\ to\ be\ changed\ to\ allow\ (i)\ the\ simultaneous\ adaptation\ of}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00208}00208\ \textcolor{comment}{the\ fluid\ and\ solid\ meshes,\ and\ (ii)\ the\ problem\ distribution.\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00209}00209\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00210}00210\ \textcolor{comment}{<HR>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00211}00211\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00212}00212\ \textcolor{comment}{\(\backslash\)subsection\ main\_body\ The\ main\ function}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00213}00213\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00214}00214\ \textcolor{comment}{As\ usual\ in\ a\ parallel\ driver\ code,\ the\ only\ addition\ to\ the\ \(\backslash\)c\ main()}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00215}00215\ \textcolor{comment}{function\ is\ the\ inclusion\ of\ calls\ to\ \(\backslash\)c\ MPI\_Helpers::init(),\ \(\backslash\)c}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00216}00216\ \textcolor{comment}{MPI\_Helpers::finalize(),\ and\ the\ \(\backslash\)c\ Problem::distribute()}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00217}00217\ \textcolor{comment}{functions.\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00218}00218\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00219}00219\ \textcolor{comment}{<HR>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00220}00220\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00221}00221\ \textcolor{comment}{\(\backslash\)subsection\ problem\_class\ The\ problem\ class}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00222}00222\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00223}00223\ \textcolor{comment}{The\ only\ additions\ to\ the\ serial\ version\ of\ the\ problem\ class\ are\ the}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00224}00224\ \textcolor{comment}{functions\ \(\backslash\)c\ actions\_before\_distribute()\ and\ \(\backslash\)c}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00225}00225\ \textcolor{comment}{actions\_after\_distribute(),\ and\ the\ helper\ function\ \(\backslash\)c}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00226}00226\ \textcolor{comment}{delete\_fsi\_traction\_elements(),\ discussed\ below.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00227}00227\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00228}00228\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00229}00229\ \textcolor{comment}{<HR>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00230}00230\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00231}00231\ \textcolor{comment}{\(\backslash\)subsection\ delete\_fsi\ Deleting\ the\ FSISolidTractionElements}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00232}00232\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00233}00233\ \textcolor{comment}{To\ facilitate\ the\ deletion\ and\ re-\/creation\ of\ the\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00234}00234\ \textcolor{comment}{\(\backslash\)c\ FSISolidTractionElements\ before\ and\ after\ the\ adaptation}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00235}00235\ \textcolor{comment}{(and\ distribution)\ we\ provide\ a\ new\ helper\ function\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00236}00236\ \textcolor{comment}{\(\backslash\)c\ delete\_fsi\_traction\_elements()\ which\ complements\ the\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00237}00237\ \textcolor{comment}{already-\/existing\ \(\backslash\)c\ create\_fsi\_traction\_elements()\ function:}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00238}00238\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00239}00239\ \textcolor{comment}{\(\backslash\)dontinclude\ turek\_flag.cc}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00240}00240\ \textcolor{comment}{\(\backslash\)skipline\ start\_of\_delete\_traction\_elements}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00241}00241\ \textcolor{comment}{\(\backslash\)until\ end\ of\ delete\ traction\ elements}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00242}00242\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00243}00243\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00244}00244\ \textcolor{comment}{<HR>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00245}00245\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00246}00246\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00247}00247\ \textcolor{comment}{\(\backslash\)subsection\ actions\_before\_distribute\ Actions\ before\ distribute}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00248}00248\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00249}00249\ \textcolor{comment}{\ As\ discussed\ above,\ we\ must\ ensure\ that\ the\ "{}bulk"{}\ solid}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00250}00250\ \textcolor{comment}{elements\ adjacent\ to\ the\ FSI\ boundary\ are\ retained\ on\ all\ processors.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00251}00251\ \textcolor{comment}{Hence,\ the\ \(\backslash\)c\ actions\_before\_distribute()}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00252}00252\ \textcolor{comment}{function\ starts\ with\ a\ loop\ over\ the\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00253}00253\ \textcolor{comment}{\(\backslash\)c\ FSISolidTractionElements\ within\ which\ we\ use\ the\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00254}00254\ \textcolor{comment}{function\ \(\backslash\)c\ GeneralisedElement::must\_be\_kept\_as\_halo()\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00255}00255\ \textcolor{comment}{to\ indicate\ that\ the\ associated\ bulk\ elements\ must\ be\ retained.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00256}00256\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00257}00257\ \textcolor{comment}{\(\backslash\)dontinclude\ turek\_flag.cc}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00258}00258\ \textcolor{comment}{\(\backslash\)skipline\ start\_of\_actions\_before\_distribute}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00259}00259\ \textcolor{comment}{\(\backslash\)until\ end\ of\ loop\ over\ meshes\ of\ fsi\ traction\ elements}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00260}00260\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00261}00261\ \textcolor{comment}{Next,\ we\ flush\ all\ the\ meshes\ from\ the\ problem's}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00262}00262\ \textcolor{comment}{collection\ of\ sub-\/meshes\ and\ add\ only\ the\ "{}bulk"{}\ fluid\ and\ solid}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00263}00263\ \textcolor{comment}{meshes\ (in\ that\ order!).\ The\ \(\backslash\)c\ FaceElements\ do\ not\ need\ to\ be}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00264}00264\ \textcolor{comment}{distributed,\ because\ they\ will\ be\ re-\/created\ in\ \(\backslash\)c\ actions\_after\_distribute().}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00265}00265\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00266}00266\ \textcolor{comment}{\(\backslash\)until\ end\ of\ actions\ before\ distribute}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00267}00267\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00268}00268\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00269}00269\ \textcolor{comment}{<HR>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00270}00270\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00271}00271\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00272}00272\ \textcolor{comment}{\(\backslash\)subsection\ actions\_after\_distribute\ Actions\ after\ distribute}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00273}00273\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00274}00274\ \textcolor{comment}{Following\ the\ problem\ distribution,\ we\ delete\ the\ old\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00275}00275\ \textcolor{comment}{\(\backslash\)c\ FSISolidTractionElements\ and\ then\ (re-\/)attach\ new\ ones,\ which\ will}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00276}00276\ \textcolor{comment}{be\ created\ as\ halo\ elements\ where\ necessary.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00277}00277\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00278}00278\ \textcolor{comment}{\(\backslash\)dontinclude\ turek\_flag.cc}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00279}00279\ \textcolor{comment}{\(\backslash\)skipline\ start\_of\_actions\_after\_distribute}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00280}00280\ \textcolor{comment}{\(\backslash\)until\ create\_fsi\_traction\_elements()}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00281}00281\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00282}00282\ \textcolor{comment}{We\ complete\ the\ build\ of\ the\ \(\backslash\)c}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00283}00283\ \textcolor{comment}{FSISolidTractionElements\ by\ passing\ the\ FSI\ parameter\ and\ the}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00284}00284\ \textcolor{comment}{boundary\ number\ in\ the\ bulk\ mesh.\ The\ relevant\ code\ is\ identical\ to\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00285}00285\ \textcolor{comment}{the\ serial\ version\ and\ we\ omit\ its\ listing\ here.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00286}00286\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00287}00287\ \textcolor{comment}{Next,\ we\ create\ new\ \(\backslash\)c\ MeshAsGeomObjects\ from\ the\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00288}00288\ \textcolor{comment}{newly-\/created\ \(\backslash\)c\ FSISolidTractionElements\ and\ pass\ them\ to\ the\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00289}00289\ \textcolor{comment}{(algebraic)\ fluid\ mesh:}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00290}00290\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00291}00291\ \textcolor{comment}{\(\backslash\)skipline\ Turn\ the\ three\ meshes\ of\ FSI\ traction\ elements}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00292}00292\ \textcolor{comment}{\(\backslash\)until\ set\_tip\_flag\_pt}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00293}00293\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00294}00294\ \textcolor{comment}{The\ \(\backslash\)c\ MeshAsGeomObjects\ have\ changed,\ so\ we}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00295}00295\ \textcolor{comment}{must\ call\ the\ \(\backslash\)c\ update\_node\_update()\ function\ again\ for\ each}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00296}00296\ \textcolor{comment}{node\ in\ the\ fluid\ mesh:}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00297}00297\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00298}00298\ \textcolor{comment}{\(\backslash\)until\ \}}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00299}00299\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00300}00300\ \textcolor{comment}{Now\ we\ add\ the\ FSI\ traction\ meshes\ back\ to\ the\ problem\ and\ rebuild\ the}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00301}00301\ \textcolor{comment}{global\ mesh.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00302}00302\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00303}00303\ \textcolor{comment}{\(\backslash\)until\ rebuild\_global\_mesh}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00304}00304\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00305}00305\ \textcolor{comment}{Finally,\ we\ re-\/set\ the\ fluid\ load\ on\ the\ solid\ elements\ by}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00306}00306\ \textcolor{comment}{calling\ \(\backslash\)c\ FSI\_functions::setup\_fluid\_load\_info\_for\_solid\_elements(...)}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00307}00307\ \textcolor{comment}{before\ re-\/assigning\ the\ auxiliary\ node\ update\ function\ that\ imposes\ the\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00308}00308\ \textcolor{comment}{no-\/slip\ condition\ for\ all\ fluid\ nodes\ on\ the\ FSI\ boundaries.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00309}00309\ \textcolor{comment}{[<a\ href="{}../../fsi\_channel\_with\_leaflet/html/index.html\#action\_after\_adapt"{}>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00310}00310\ \textcolor{comment}{Recall</a>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00311}00311\ \textcolor{comment}{that\ the\ (re-\/)assignment\ of\ the\ auxiliary\ node-\/update\ function}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00312}00312\ \textcolor{comment}{must\ be\ performed\ \(\backslash\)b\ after\ the\ call\ to\ \ \(\backslash\)c}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00313}00313\ \textcolor{comment}{FSI\_functions::setup\_fluid\_load\_info\_for\_solid\_elements(...).]}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00314}00314\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00315}00315\ \textcolor{comment}{\(\backslash\)until\ end\ of\ (re-\/)assignment\ of\ the\ auxiliary\ node\ update\ fct}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00316}00316\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00317}00317\ \textcolor{comment}{The\ remainder\ of\ the\ function\ identifies\ which\ processors}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00318}00318\ \textcolor{comment}{contain\ the\ fluid\ control\ node\ whose\ velocities\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00319}00319\ \textcolor{comment}{we\ document\ in\ the\ trace\ file.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00320}00320\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00321}00321\ \textcolor{comment}{<HR>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00322}00322\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00323}00323\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00324}00324\ \textcolor{comment}{\(\backslash\)subsection\ actions\_after\_adapt\ Actions\ after\ adapt}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00325}00325\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00326}00326\ \textcolor{comment}{The\ \(\backslash\)c\ actions\_after\_adapt()\ function\ is\ very\ similar\ to\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00327}00327\ \textcolor{comment}{\(\backslash\)c\ actions\_after\_distribute()\ function,\ so\ we\ omit\ is\ listing\ here.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00328}00328\ \textcolor{comment}{\ The\ only\ significant\ differences\ are\ that\ (i)\ the\ redundant\ fluid\ and}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00329}00329\ \textcolor{comment}{\ solid\ pressures\ are\ (re)-\/pinned;\ (ii)\ the\ identification\ of\ the\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00330}00330\ \textcolor{comment}{fluid\ control\ node\ does\ not\ need\ to}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00331}00331\ \textcolor{comment}{\ be\ setup;\ \ and\ (iii)\ the\ traction\ meshes\ were\ never\ removed\ from\ the}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00332}00332\ \textcolor{comment}{\ problem,\ so\ do\ not\ need\ to\ be\ added\ back\ in.\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00333}00333\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00334}00334\ \textcolor{comment}{<HR>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00335}00335\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00336}00336\ \textcolor{comment}{\(\backslash\)subsection\ doc\_solution\ The\ doc\_solution()\ function}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00337}00337\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00338}00338\ \textcolor{comment}{As\ with\ the\ other\ parallel\ driver\ codes,\ the\ main\ modification\ to\ the}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00339}00339\ \textcolor{comment}{post-\/processing\ function\ is\ the}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00340}00340\ \textcolor{comment}{addition\ of\ the\ processor\ number\ to\ all\ output\ files.\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00341}00341\ \textcolor{comment}{Furthermore,\ we\ only\ write\ the\ trace\ file\ on\ the\ processors\ that}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00342}00342\ \textcolor{comment}{contain\ the\ fluid\ control\ node.\ In\ the\ interest\ of\ brevity\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00343}00343\ \textcolor{comment}{we\ omit\ the\ listing\ of\ the\ modified\ function.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00344}00344\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00345}00345\ \textcolor{comment}{<HR>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00346}00346\ \textcolor{comment}{<HR>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00347}00347\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00348}00348\ \textcolor{comment}{\(\backslash\)section\ result\ Results}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00349}00349\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00350}00350\ \textcolor{comment}{The\ figure\ below\ illustrates\ the\ distribution\ of\ the\ problem\ across\ four}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00351}00351\ \textcolor{comment}{processors,\ represented\ by\ the\ four\ colours,\ with\ the\ fluid\ elements}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00352}00352\ \textcolor{comment}{outlined\ in\ black\ and\ the\ solid\ elements\ outlined\ in\ white.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00353}00353\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00354}00354\ \textcolor{comment}{\(\backslash\)image\ html\ turek\_partition.gif\ "{}Distribution\ of\ the\ Turek\ \(\backslash\)\&\ Hron\ benchmark\ problem\ over\ four\ processors.\ "{}\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00355}00355\ \textcolor{comment}{\(\backslash\)image\ latex\ turek\_partition.eps\ "{}Distribution\ of\ the\ Turek\ \(\backslash\)\&\ Hron\ benchmark\ problem\ over\ four\ processors.\ "{}\ width=0.75\(\backslash\)textwidth}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00356}00356\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00357}00357\ \textcolor{comment}{Zooming\ in\ near\ the\ "{}flag"{}\ shows\ how\ both\ fluid\ and\ solid\ meshes}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00358}00358\ \textcolor{comment}{are\ refined\ and\ distributed\ independently:}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00359}00359\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00360}00360\ \textcolor{comment}{\(\backslash\)image\ html\ turek\_partition\_zoom.gif\ "{}Distribution\ of\ the\ Turek\ \(\backslash\)\&\ Hron\ benchmark\ problem\ over\ four\ processors;\ zoomed\ in\ view\ near\ the\ \`{}flag'.\ "{}\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00361}00361\ \textcolor{comment}{\(\backslash\)image\ latex\ turek\_partition\_zoom.eps\ "{}Distribution\ of\ the\ Turek\ \(\backslash\)\&\ Hron\ benchmark\ problem\ over\ four\ processors;\ zoomed\ in\ view\ near\ the\ \`{}flag'.\ "{}\ width=0.75\(\backslash\)textwidth}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00362}00362\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00363}00363\ \textcolor{comment}{<HR>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00364}00364\ \textcolor{comment}{<HR>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00365}00365\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00366}00366\ \textcolor{comment}{\(\backslash\)section\ load\_balance\ Load\ balancing}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00367}00367\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00368}00368\ \textcolor{comment}{When\ employing\ load\ balancing\ in\ this\ problem,}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00369}00369\ \textcolor{comment}{we\ modify\ the\ time-\/stepping\ loop\ to\ perform\ the\ procedure}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00370}00370\ \textcolor{comment}{after\ each\ timestep:}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00371}00371\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00372}00372\ \textcolor{comment}{\(\backslash\)dontinclude\ turek\_flag\_load\_balance.cc}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00373}00373\ \textcolor{comment}{\(\backslash\)skipline\ Start\ of\ timestepping\ loop}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00374}00374\ \textcolor{comment}{\(\backslash\)until\ end\ of\ timestepping\ loop}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00375}00375\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00376}00376\ \textcolor{comment}{\(\backslash\)subsection\ build\_mesh\ The\ build\_mesh()\ function}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00377}00377\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00378}00378\ \textcolor{comment}{The\ function\ \(\backslash\)c\ Problem::build\_mesh()\ must\ be\ supplied\ by\ the\ user\ if}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00379}00379\ \textcolor{comment}{they\ wish\ to\ use\ the\ load\ balancing\ capability.\ \ Thus,\ in\ this\ driver}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00380}00380\ \textcolor{comment}{code,\ we\ move\ all\ the\ required\ code\ to\ build\ the\ entire\ global\ mesh}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00381}00381\ \textcolor{comment}{into\ this\ function,\ and\ call\ it\ from\ within\ the\ problem\ constructor:}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00382}00382\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00383}00383\ \textcolor{comment}{\(\backslash\)dontinclude\ turek\_flag\_load\_balance.cc}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00384}00384\ \textcolor{comment}{\(\backslash\)skipline\ start\_of\_constructor}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00385}00385\ \textcolor{comment}{\(\backslash\)until\ end\_of\_constructor}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00386}00386\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00387}00387\ \textcolor{comment}{The\ \(\backslash\)c\ build\_mesh()\ function\ itself\ contains\ all\ the\ relevant\ code}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00388}00388\ \textcolor{comment}{from\ within\ the\ previous\ parallel\ driver\ code's\ problem\ constructor.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00389}00389\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00390}00390\ \textcolor{comment}{\(\backslash\)subsection\ actions\_functions\ Actions\ before\ and\ after\ load\ balancing\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00391}00391\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00392}00392\ \textcolor{comment}{In\ this\ example,\ all\ that\ is\ required\ for\ the\ \(\backslash\)c}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00393}00393\ \textcolor{comment}{actions\_after\_load\_balance()\ function\ is\ the}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00394}00394\ \textcolor{comment}{addition\ of\ the\ unpin-\/repin\ procedure\ from\ the\ \(\backslash\)c\ actions\_after\_adapt()}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00395}00395\ \textcolor{comment}{function\ to\ the\ appropriate\ part\ of\ the\ \(\backslash\)c\ actions\_after\_distribute()}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00396}00396\ \textcolor{comment}{function,\ since\ all\ the\ other\ functionality\ is\ already\ identical.\ \ The}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00397}00397\ \textcolor{comment}{\(\backslash\)c\ actions\_before\_load\_balance()\ function\ is\ identical\ to\ the\ \(\backslash\)c}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00398}00398\ \textcolor{comment}{actions\_before\_distribute()\ function.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00399}00399\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00400}00400\ \textcolor{comment}{<HR>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00401}00401\ \textcolor{comment}{<HR>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00402}00402\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00403}00403\ \textcolor{comment}{\(\backslash\)section\ sources\ Source\ files\ for\ this\ tutorial}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00404}00404\ \textcolor{comment}{-\/\ The\ source\ files\ for\ this\ tutorial\ are\ located\ in\ the\ directory:\(\backslash\)n\(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00405}00405\ \textcolor{comment}{<CENTER>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00406}00406\ \textcolor{comment}{<A\ HREF="{}../../../../demo\_drivers/mpi/multi\_domain/turek\_flag/"{}>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00407}00407\ \textcolor{comment}{demo\_drivers/mpi/multi\_domain/turek\_flag/}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00408}00408\ \textcolor{comment}{</A>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00409}00409\ \textcolor{comment}{</CENTER>\(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00410}00410\ \textcolor{comment}{-\/\ The\ main\ driver\ code\ is:\ \(\backslash\)n\(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00411}00411\ \textcolor{comment}{<CENTER>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00412}00412\ \textcolor{comment}{<A\ HREF="{}../../../../demo\_drivers/mpi/multi\_domain/turek\_flag/turek\_flag.cc"{}>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00413}00413\ \textcolor{comment}{demo\_drivers/mpi/multi\_domain/turek\_flag/turek\_flag.cc}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00414}00414\ \textcolor{comment}{</A>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00415}00415\ \textcolor{comment}{</CENTER>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00416}00416\ \textcolor{comment}{-\/\ The\ driver\ code\ for\ the\ load\ balancing\ example\ is:\ \(\backslash\)n\(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00417}00417\ \textcolor{comment}{<CENTER>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00418}00418\ \textcolor{comment}{<A\ HREF="{}../../../../demo\_drivers/mpi/multi\_domain/turek\_flag/turek\_flag\_load\_balance.cc"{}>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00419}00419\ \textcolor{comment}{demo\_drivers/mpi/multi\_domain/turek\_flag/turek\_flag\_load\_balance.cc}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00420}00420\ \textcolor{comment}{</A>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00421}00421\ \textcolor{comment}{</CENTER>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00422}00422\ \textcolor{comment}{.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00423}00423\ \textcolor{comment}{\ }}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00424}00424\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00425}00425\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00426}00426\ \textcolor{comment}{<hr>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00427}00427\ \textcolor{comment}{<hr>}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00428}00428\ \textcolor{comment}{\(\backslash\)section\ pdf\ PDF\ file}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00429}00429\ \textcolor{comment}{A\ <a\ href="{}../latex/refman.pdf"{}>pdf\ version</a>\ of\ this\ document\ is\ available.}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00430}00430\ \textcolor{comment}{**/}}
\DoxyCodeLine{\Hypertarget{turek__flag_8txt__doxygenified_8h_source_l00431}00431\ }

\end{DoxyCode}
