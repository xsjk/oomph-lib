\chapter{Demo problem\+: Solid Mechanics using unstructured meshes with adaptivity}
\hypertarget{index}{}\label{index}\index{Demo problem: Solid Mechanics using unstructured meshes with adaptivity@{Demo problem: Solid Mechanics using unstructured meshes with adaptivity}}
The purpose of this tutorial is to demonstrate the adaptive solution of solid mechanics problems using unstructured meshes generated by {\ttfamily oomph-\/lib\textquotesingle{}s} \href{../../../../doc/meshes/mesh_from_inline_triangle/html/index.html}{\texttt{ inline unstructured mesh generation }} procedures. The use of these methods for solid mechanics problems required no additional effort on the part of the user and the setup is essentially the same as that described for \href{../../unstructured_solid/html/index.html}{\texttt{ unstructured solid mechanics without mesh adaptation. }} Lagrangian coordinates are projected between meshes in the same way as all other field variables, Eulerian coordinates and history values, see the description in \href{../../../meshes/mesh_from_inline_triangle/html/index.html}{\texttt{ another tutorial. }}

The solid mechanics problem described here can be regarded as a sub-\/problem for the ~\newline
 \href{../../../../doc/interaction/unstructured_adaptive_fsi/html/index.html}{\texttt{ unstructured adaptive fluid--structure interaction tutorial.}} In addition, we can use the problem to assess the errors incurred when projecting the solution between different meshes.

\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_problem}{}\doxysection{\texorpdfstring{The problem}{The problem}}\label{index_problem}
An elastic bar is fixed at the base and loaded by a constant pressure on its left-\/hand side. The pressure load is increased and then decreased so that at the end of the simulation the bar should return to its undeformed position. The strain energy in the final configuration is a measure of the projection error because if there were no projection at all it would be exactly zero (or certainly zero to less than machine precision).

 
\begin{DoxyImage}
\includegraphics[width=0.75\textwidth]{solid_sketch}
\doxyfigcaption{Sketch of the problem. }
\end{DoxyImage}


\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_results}{}\doxysection{\texorpdfstring{Results}{Results}}\label{index_results}
The animation shown below illustrates the solid\textquotesingle{}s deformation and illustrates the adaptation of the mesh as the load changes.

 
\begin{DoxyImage}
\includegraphics[width=0.75\textwidth]{solid_res}
\doxyfigcaption{Plot of the deformation. }
\end{DoxyImage}


The initial strain energy is $ O(10^{-28}) $, and the strain energy in the final configuration after the external pressure has been reset to zero, but the mesh has been adapted, is $ O(10^{-8})
$. The strain energy at the maximum deflection is $ O(10^{-3}) $.

\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_namespace}{}\doxysection{\texorpdfstring{Global Physical Variables}{Global Physical Variables}}\label{index_namespace}
We define the various physical variables in a global namespace. We define Poisson\textquotesingle{}s ratio and prepare a pointer to a constitutive equation.

 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//=======start\_namespace==========================================}}
\DoxyCodeLine{\textcolor{comment}{///\ Global\ variables}}
\DoxyCodeLine{\textcolor{comment}{//================================================================}}
\DoxyCodeLine{\textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceGlobal__Physical__Variables}{Global\_Physical\_Variables}}}
\DoxyCodeLine{\{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Poisson's\ ratio}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a3962c36313826b19f216f6bbbdd6a477}{Nu}}=0.3;}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Pointer\ to\ constitutive\ law}}
\DoxyCodeLine{\textcolor{comment}{}\ ConstitutiveLaw*\ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a2a37fb040c832ee7a086bb13bb02a100}{Constitutive\_law\_pt}}=0;}

\end{DoxyCodeInclude}
 Next we define the pressure load to be applied at the left-\/hand boundary,


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\ \textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Uniform\ pressure}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a23c2ade6398f54040b869f7f3a2bcc4b}{P}}\ =\ 0.0;}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Constant\ pressure\ load.\ The\ arguments\ to\ this\ function\ are\ imposed}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ on\ us\ by\ the\ SolidTractionElements\ which\ allow\ the\ traction\ to\ }}
\DoxyCodeLine{\textcolor{comment}{\ ///\ depend\ on\ the\ Lagrangian\ and\ Eulerian\ coordinates\ x\ and\ xi,\ and\ on\ the\ }}
\DoxyCodeLine{\textcolor{comment}{\ ///\ outer\ unit\ normal\ to\ the\ surface.\ Here\ we\ only\ need\ the\ outer\ unit}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ normal.}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a19f4e20a92e7d216b4d2b00308f96917}{constant\_pressure}}(\textcolor{keyword}{const}\ Vector<double>\ \&xi,\ \textcolor{keyword}{const}\ Vector<double>\ \&x,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Vector<double>\ \&n,\ Vector<double>\ \&traction)}
\DoxyCodeLine{\ \{}
\DoxyCodeLine{\ \ \textcolor{keywordtype}{unsigned}\ dim\ =\ traction.size();}
\DoxyCodeLine{\ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ i=0;i<dim;i++)}
\DoxyCodeLine{\ \ \ \{}
\DoxyCodeLine{\ \ \ \ traction[i]\ =\ -\/\mbox{\hyperlink{namespaceGlobal__Physical__Variables_a23c2ade6398f54040b869f7f3a2bcc4b}{P}}*n[i];}
\DoxyCodeLine{\ \ \ \}}
\DoxyCodeLine{\ \}\ }
\DoxyCodeLine{}
\DoxyCodeLine{\}\ \textcolor{comment}{//end\ namespace}}

\end{DoxyCodeInclude}
 \DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_main}{}\doxysection{\texorpdfstring{The driver code}{The driver code}}\label{index_main}
The driver code consists of essentially the same code repeated for three different formulations of solid mechanics\+: (i) (compressible) displacement only; (ii) (compressible) displacement-\/pressure; and (iii) incompressible displacement-\/pressure. We shall describe the code only for the first formulation.

Initially, we specify an output directory and instantiate a constitutive equation. (Recall that the single-\/argument constructor to the {\ttfamily Generalised\+Hookean} constitutive law implies that all stresses are non-\/dimensionalised on Young\textquotesingle{}s modulus $ E $).

 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//===========start\_main===================================================}}
\DoxyCodeLine{\textcolor{comment}{///\ Demonstrate\ how\ to\ solve\ an\ unstructured\ solid\ problem}}
\DoxyCodeLine{\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\textcolor{keywordtype}{int}\ \mbox{\hyperlink{unstructured__adaptive__solid_8cc_a3c04138a5bfe5d72780bb7e82a18e627}{main}}(\textcolor{keywordtype}{int}\ argc,\ \textcolor{keywordtype}{char}\ **argv)}
\DoxyCodeLine{\{}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//Doc\ info\ object}}
\DoxyCodeLine{\ DocInfo\ doc\_info;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Output\ directory}}
\DoxyCodeLine{\ doc\_info.set\_directory(\textcolor{stringliteral}{"{}RESLT"{}});}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Create\ generalised\ Hookean\ constitutive\ equations}}
\DoxyCodeLine{\ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a2a37fb040c832ee7a086bb13bb02a100}{Global\_Physical\_Variables::Constitutive\_law\_pt}}\ =\ }
\DoxyCodeLine{\ \ \textcolor{keyword}{new}\ GeneralisedHookean(\&\mbox{\hyperlink{namespaceGlobal__Physical__Variables_a3962c36313826b19f216f6bbbdd6a477}{Global\_Physical\_Variables::Nu}});}

\end{DoxyCodeInclude}
 We then open an output file for the strain energy, create the {\ttfamily Problem} object using a displacement formulation of the equations and output the initial configuration.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \{}
\DoxyCodeLine{\ \ std::ofstream\ strain(\textcolor{stringliteral}{"{}RESLT/s\_energy.dat"{}});}
\DoxyCodeLine{\ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Running\ with\ pure\ displacement\ formulation\(\backslash\)n"{}};}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \textcolor{comment}{//Set\ up\ the\ problem}}
\DoxyCodeLine{\ \ \mbox{\hyperlink{classUnstructuredSolidProblem}{UnstructuredSolidProblem<ProjectablePVDElement<TPVDElement<2,3>}}\ >\ >\ problem;}
\DoxyCodeLine{\ \ }
\DoxyCodeLine{\ \ \textcolor{comment}{//Output\ initial\ configuration}}
\DoxyCodeLine{\ \ problem.\mbox{\hyperlink{classUnstructuredSolidProblem_ab3d66fd61b69d12b4f159d763fc44f15}{doc\_solution}}(doc\_info);}
\DoxyCodeLine{\ \ doc\_info.number()++;}

\end{DoxyCodeInclude}
 Finally, we perform the parameter study by slowly increasing and then reducing the pressure on the left-\/hand boundary. Note that one round of mesh adaptation is specified for every Newton solve.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\ \ }
\DoxyCodeLine{\ \ \textcolor{comment}{//\ Parameter\ study}}
\DoxyCodeLine{\ \ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a23c2ade6398f54040b869f7f3a2bcc4b}{Global\_Physical\_Variables::P}}=0.0;}
\DoxyCodeLine{\ \ \textcolor{keywordtype}{double}\ pressure\_increment=0.1e-\/2;}
\DoxyCodeLine{\ \ }
\DoxyCodeLine{\ \ \textcolor{keywordtype}{unsigned}\ nstep=5;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ istep=0;istep<nstep;istep++)}
\DoxyCodeLine{\ \ \ \{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Solve\ the\ problem\ with\ one\ round\ of\ adaptivity}}
\DoxyCodeLine{\ \ \ \ problem.newton\_solve(1);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{double}\ strain\_energy\ =\ problem.\mbox{\hyperlink{classUnstructuredSolidProblem_a4da918a1f0cf94ebccc5112b58c28ece}{get\_strain\_energy}}();}
\DoxyCodeLine{\ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Strain\ energy\ is\ "{}}\ <<\ strain\_energy\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//Output\ strain\ energy\ to\ file}}
\DoxyCodeLine{\ \ \ \ strain\ <<\ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a23c2ade6398f54040b869f7f3a2bcc4b}{Global\_Physical\_Variables::P}}\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ strain\_energy\ <<\ std::endl;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//Output\ solution}}
\DoxyCodeLine{\ \ \ \ problem.\mbox{\hyperlink{classUnstructuredSolidProblem_ab3d66fd61b69d12b4f159d763fc44f15}{doc\_solution}}(doc\_info);}
\DoxyCodeLine{\ \ \ \ doc\_info.number()++;}
\DoxyCodeLine{\ \ \ \ }
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//Reverse\ direction\ of\ increment\ }}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{if}(istep==2)\ \{pressure\_increment\ *=\ -\/1.0;\}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Increase\ (or\ decrease)\ load}}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a23c2ade6398f54040b869f7f3a2bcc4b}{Global\_Physical\_Variables::P}}+=pressure\_increment;}
\DoxyCodeLine{\ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ strain.close();}
\DoxyCodeLine{\ \}\ \textcolor{comment}{//end\_displacement\_formulation}}

\end{DoxyCodeInclude}
 \DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_class}{}\doxysection{\texorpdfstring{The Problem class}{The Problem class}}\label{index_class}
The {\ttfamily Problem} class has the obvious member functions as well as a function to set whether the material is incompressible and a function to compute the strain energy of the elastic body. The class provides storage for the two sub-\/meshes\+: the bulk mesh of 2D solid elements and the mesh of 1D traction elements that will be attached to the left-\/hand boundary. In addition, storage is provided for the polygon that represents the initial outer boundary of the solid body and a boolean flag that is used to specify whether the material is incompressible or not.

 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//==============start\_problem=========================================}}
\DoxyCodeLine{\textcolor{comment}{///\ Unstructured\ solid\ problem}}
\DoxyCodeLine{\textcolor{comment}{//====================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class}\ ELEMENT>\ }
\DoxyCodeLine{\textcolor{keyword}{class\ }\mbox{\hyperlink{classUnstructuredSolidProblem}{UnstructuredSolidProblem}}\ :\ \textcolor{keyword}{public}\ Problem}
\DoxyCodeLine{\{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{public}:}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Constructor:\ }}
\DoxyCodeLine{\textcolor{comment}{}\ \mbox{\hyperlink{classUnstructuredSolidProblem_a18ce02b6e4bbc86403c9e1b32c095772}{UnstructuredSolidProblem}}();}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Destructor\ (empty)}}
\DoxyCodeLine{\textcolor{comment}{}\ \mbox{\hyperlink{classUnstructuredSolidProblem_a25fe105d949498bf8f7c15aff96a7d00}{\string~UnstructuredSolidProblem}}()\{\}}
\DoxyCodeLine{\ \textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Set\ the\ problem\ to\ be\ incompressible}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classUnstructuredSolidProblem_a9b725d83bc051b594d080a40d6d317d3}{set\_incompressible}}()\ \{\mbox{\hyperlink{classUnstructuredSolidProblem_a956386972054504cdc23fd970b126934}{Incompressible}}=\textcolor{keyword}{true};\}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Doc\ the\ solution}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classUnstructuredSolidProblem_ab3d66fd61b69d12b4f159d763fc44f15}{doc\_solution}}(DocInfo\&\ doc\_info);}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Calculate\ the\ strain\ energy}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classUnstructuredSolidProblem_a4da918a1f0cf94ebccc5112b58c28ece}{get\_strain\_energy}}();}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Remove\ Traction\ Mesh}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classUnstructuredSolidProblem_a463b4b976fdd12129ac2bd23bece1b8b}{actions\_before\_adapt}}();}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Add\ on\ the\ traction\ elements\ after\ adaptation}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classUnstructuredSolidProblem_acf0bbf57534a1516a633d702d9fd21ab}{actions\_after\_adapt}}();}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{private}:}
\DoxyCodeLine{\ \textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Bulk\ mesh}}
\DoxyCodeLine{\textcolor{comment}{}\ RefineableSolidTriangleMesh<ELEMENT>*\ \mbox{\hyperlink{classUnstructuredSolidProblem_af121067bd532a78b4360373b60aaddd0}{Solid\_mesh\_pt}};}
\DoxyCodeLine{\ \textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Pointer\ to\ mesh\ of\ traction\ elements}}
\DoxyCodeLine{\textcolor{comment}{}\ SolidMesh*\ \mbox{\hyperlink{classUnstructuredSolidProblem_a42018e62ce6bf48968f389880669c8f4}{Traction\_mesh\_pt}};}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Triangle\ mesh\ polygon\ for\ outer\ boundary\ }}
\DoxyCodeLine{\textcolor{comment}{}\ TriangleMeshPolygon*\ \mbox{\hyperlink{classUnstructuredSolidProblem_a2e7ef7b4984d6d2a063c0c2374931d0c}{Outer\_boundary\_polyline\_pt}};\ }
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Boolean\ flag\ used\ in\ an\ incompressible\ problem}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classUnstructuredSolidProblem_a956386972054504cdc23fd970b126934}{Incompressible}};}
\DoxyCodeLine{}
\DoxyCodeLine{\};}

\end{DoxyCodeInclude}
 \DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_constructor}{}\doxysection{\texorpdfstring{The Problem constructor}{The Problem constructor}}\label{index_constructor}
We begin by building the closed, piecewise linear boundary of the undeformed solid body $ x_{1} \in [0,1] $, $
 x_{2} \in [0,5]. $ The boundaries are labelled anticlockwise with boundary with the left-\/hand boundary being boundary 0, see the sketch above. This process is a simplified version of the construction used in \href{../../../../doc/meshes/mesh_from_inline_triangle/html/index.html}{\texttt{ another tutorial. }}

 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//===============start\_constructor========================================}}
\DoxyCodeLine{\textcolor{comment}{///\ Constructor\ for\ unstructured\ solid\ problem}}
\DoxyCodeLine{\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class}\ ELEMENT>}
\DoxyCodeLine{\mbox{\hyperlink{classUnstructuredSolidProblem_a18ce02b6e4bbc86403c9e1b32c095772}{UnstructuredSolidProblem<ELEMENT>::UnstructuredSolidProblem}}()\ :}
\DoxyCodeLine{\ Incompressible(false)}
\DoxyCodeLine{\{\ \ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Build\ the\ boundary\ segments\ for\ outer\ boundary,\ consisting\ of}}
\DoxyCodeLine{\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\ \textcolor{comment}{//\ four\ separeate\ polyline\ segments}}
\DoxyCodeLine{\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\ Vector<TriangleMeshCurveSection*>\ boundary\_segment\_pt(4);}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Initialize\ boundary\ segment}}
\DoxyCodeLine{\ Vector<Vector<double>\ >\ bound\_seg(2);}
\DoxyCodeLine{\ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ i=0;i<2;i++)\ \{bound\_seg[i].resize(2);\}}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//\ First\ boundary\ segment}}
\DoxyCodeLine{\ bound\_seg[0][0]=0.0;}
\DoxyCodeLine{\ bound\_seg[0][1]=0.0;}
\DoxyCodeLine{\ bound\_seg[1][0]=0.0;}
\DoxyCodeLine{\ bound\_seg[1][1]=5.0;}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Specify\ 1st\ boundary\ id}}
\DoxyCodeLine{\ \textcolor{keywordtype}{unsigned}\ bound\_id\ =\ 0;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Build\ the\ 1st\ boundary\ segment}}
\DoxyCodeLine{\ boundary\_segment\_pt[0]\ =\ \textcolor{keyword}{new}\ TriangleMeshPolyLine(bound\_seg,bound\_id);}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Second\ boundary\ segment}}
\DoxyCodeLine{\ bound\_seg[0][0]=0.0;}
\DoxyCodeLine{\ bound\_seg[0][1]=5.0;}
\DoxyCodeLine{\ bound\_seg[1][0]=1.0;}
\DoxyCodeLine{\ bound\_seg[1][1]=5.0;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Specify\ 2nd\ boundary\ id}}
\DoxyCodeLine{\ bound\_id\ =\ 1;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Build\ the\ 2nd\ boundary\ segment}}
\DoxyCodeLine{\ boundary\_segment\_pt[1]\ =\ \textcolor{keyword}{new}\ TriangleMeshPolyLine(bound\_seg,bound\_id);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Third\ boundary\ segment}}
\DoxyCodeLine{\ bound\_seg[0][0]=1.0;}
\DoxyCodeLine{\ bound\_seg[0][1]=5.0;}
\DoxyCodeLine{\ bound\_seg[1][0]=1.0;}
\DoxyCodeLine{\ bound\_seg[1][1]=0.0;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Specify\ 3rd\ boundary\ id}}
\DoxyCodeLine{\ bound\_id\ =\ 2;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Build\ the\ 3rd\ boundary\ segment}}
\DoxyCodeLine{\ boundary\_segment\_pt[2]\ =\ \textcolor{keyword}{new}\ TriangleMeshPolyLine(bound\_seg,bound\_id);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Fourth\ boundary\ segment}}
\DoxyCodeLine{\ bound\_seg[0][0]=1.0;}
\DoxyCodeLine{\ bound\_seg[0][1]=0.0;}
\DoxyCodeLine{\ bound\_seg[1][0]=0.0;}
\DoxyCodeLine{\ bound\_seg[1][1]=0.0;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Specify\ 4th\ boundary\ id}}
\DoxyCodeLine{\ bound\_id\ =\ 3;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Build\ the\ 4th\ boundary\ segment}}
\DoxyCodeLine{\ boundary\_segment\_pt[3]\ =\ \textcolor{keyword}{new}\ TriangleMeshPolyLine(bound\_seg,bound\_id);}
\DoxyCodeLine{\ \ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Create\ the\ triangle\ mesh\ polygon\ for\ outer\ boundary\ using\ boundary\ segment}}
\DoxyCodeLine{\ Outer\_boundary\_polyline\_pt\ =\ \textcolor{keyword}{new}\ TriangleMeshPolygon(boundary\_segment\_pt);}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ There\ are\ no\ holes}}
\DoxyCodeLine{\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Now\ build\ the\ mesh,\ based\ on\ the\ boundaries\ specified\ by}}
\DoxyCodeLine{\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\ \textcolor{comment}{//\ polygons\ just\ created}}
\DoxyCodeLine{\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\ \textcolor{keywordtype}{double}\ uniform\_element\_area=0.2;}
\DoxyCodeLine{}
\DoxyCodeLine{\ TriangleMeshClosedCurve*\ closed\_curve\_pt=Outer\_boundary\_polyline\_pt;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Use\ the\ TriangleMeshParameters\ object\ for\ gathering\ all}}
\DoxyCodeLine{\ \textcolor{comment}{//\ the\ necessary\ arguments\ for\ the\ TriangleMesh\ object}}
\DoxyCodeLine{\ TriangleMeshParameters\ triangle\_mesh\_parameters(}
\DoxyCodeLine{\ \ \ closed\_curve\_pt);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Define\ the\ maximum\ element\ area}}
\DoxyCodeLine{\ triangle\_mesh\_parameters.element\_area()\ =}
\DoxyCodeLine{\ \ \ uniform\_element\_area;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Create\ the\ mesh}}
\DoxyCodeLine{\ Solid\_mesh\_pt\ =}
\DoxyCodeLine{\ \ \ \textcolor{keyword}{new}\ RefineableSolidTriangleMesh<ELEMENT>(}
\DoxyCodeLine{\ \ \ \ \ triangle\_mesh\_parameters);}

\end{DoxyCodeInclude}
 We next construct an error estimator and specify the target errors and element sizes.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//hierher}}
\DoxyCodeLine{\ \textcolor{comment}{//\ Disable\ the\ use\ of\ an\ iterative\ solver\ for\ the\ projection}}
\DoxyCodeLine{\ \textcolor{comment}{//\ stage\ during\ mesh\ adaptation}}
\DoxyCodeLine{\ Solid\_mesh\_pt-\/>disable\_iterative\_solver\_for\_projection();}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Set\ error\ estimator\ for\ bulk\ mesh}}
\DoxyCodeLine{\ Z2ErrorEstimator*\ error\_estimator\_pt=\textcolor{keyword}{new}\ Z2ErrorEstimator;}
\DoxyCodeLine{\ Solid\_mesh\_pt-\/>spatial\_error\_estimator\_pt()=error\_estimator\_pt;}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Set\ targets\ for\ spatial\ adaptivity}}
\DoxyCodeLine{\ Solid\_mesh\_pt-\/>max\_permitted\_error()=0.0001;}
\DoxyCodeLine{\ Solid\_mesh\_pt-\/>min\_permitted\_error()=0.001;\ }
\DoxyCodeLine{\ Solid\_mesh\_pt-\/>max\_element\_size()=0.2;}
\DoxyCodeLine{\ Solid\_mesh\_pt-\/>min\_element\_size()=0.001;\ }

\end{DoxyCodeInclude}
 We output the boundaries, construct an empty traction mesh and combine the bulk and traction meshes into a global mesh.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\ \ \ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Output\ mesh\ boundaries}}
\DoxyCodeLine{\ this-\/>Solid\_mesh\_pt-\/>output\_boundaries(\textcolor{stringliteral}{"{}boundaries.dat"{}});}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Make\ the\ traction\ mesh}}
\DoxyCodeLine{\ Traction\_mesh\_pt=\textcolor{keyword}{new}\ SolidMesh;}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Add\ sub\ meshes}}
\DoxyCodeLine{\ add\_sub\_mesh(Solid\_mesh\_pt);}
\DoxyCodeLine{\ add\_sub\_mesh(Traction\_mesh\_pt);}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Build\ the\ global\ mesh}}
\DoxyCodeLine{\ build\_global\_mesh();}

\end{DoxyCodeInclude}
 Finally we call {\ttfamily actions\+\_\+after\+\_\+adapt()}, which constructs the traction elements, sets the boundary conditions and completes the build of the elements, and then we assign the equation numbers


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//Call\ actions\ after\ adapt:}}
\DoxyCodeLine{\ \textcolor{comment}{//\ 1)\ to\ build\ the\ traction\ elements}}
\DoxyCodeLine{\ \textcolor{comment}{//\ 2)\ to\ pin\ the\ nodes\ on\ the\ lower\ boundary\ (boundary\ 3)}}
\DoxyCodeLine{\ \textcolor{comment}{//\ 3)\ to\ complete\ the\ build\ of\ the\ elements}}
\DoxyCodeLine{\ \textcolor{comment}{//\ Note\ there\ is\ slight\ duplication\ here\ because\ we\ rebuild\ the\ global\ mesh}}
\DoxyCodeLine{\ \textcolor{comment}{//\ twice.}}
\DoxyCodeLine{\ this-\/>actions\_after\_adapt();}
\DoxyCodeLine{\ \ \ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Setup\ equation\ numbering\ scheme}}
\DoxyCodeLine{\ cout\ <<\textcolor{stringliteral}{"{}Number\ of\ equations:\ "{}}\ <<\ assign\_eqn\_numbers()\ <<\ std::endl;\ }
\DoxyCodeLine{\ }
\DoxyCodeLine{\}\ \textcolor{comment}{//end\ constructor}}

\end{DoxyCodeInclude}
 \DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_adapt_after}{}\doxysection{\texorpdfstring{Actions before adaptation}{Actions before adaptation}}\label{index_adapt_after}
The {\ttfamily actions\+\_\+before\+\_\+adapt()} function simply deletes the traction elements and clears the storage in the face mesh.

 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//==============start\_actions\_before\_adapt================================}}
\DoxyCodeLine{\textcolor{comment}{///\ Actions\ before\ adapt:\ remove\ the\ traction\ elements\ in\ the\ surface\ mesh}}
\DoxyCodeLine{\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class}\ ELEMENT>}
\DoxyCodeLine{\textcolor{keywordtype}{void}\ \mbox{\hyperlink{classUnstructuredSolidProblem_a463b4b976fdd12129ac2bd23bece1b8b}{UnstructuredSolidProblem<ELEMENT>::actions\_before\_adapt}}()}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \textcolor{comment}{//\ How\ many\ surface\ elements\ are\ in\ the\ surface\ mesh}}
\DoxyCodeLine{\ \textcolor{keywordtype}{unsigned}\ n\_element\ =\ Traction\_mesh\_pt-\/>nelement();}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Loop\ over\ the\ surface\ elements\ and\ kill\ them}}
\DoxyCodeLine{\ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ e=0;e<n\_element;e++)\ \{\textcolor{keyword}{delete}\ Traction\_mesh\_pt-\/>element\_pt(e);\}}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Wipe\ the\ mesh}}
\DoxyCodeLine{\ Traction\_mesh\_pt-\/>flush\_element\_and\_node\_storage();}
\DoxyCodeLine{}
\DoxyCodeLine{\}\ \textcolor{comment}{//\ end\_actions\_before\_adapt}}

\end{DoxyCodeInclude}
 \DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_adapt_after}{}\doxysection{\texorpdfstring{Actions before adaptation}{Actions before adaptation}}\label{index_adapt_after}
The function {\ttfamily actions\+\_\+after\+\_\+adapt()} first builds the traction elements adjacent to the left-\/hand boundary (boundary 0) and rebuilds the global mesh. The {\ttfamily constant\+\_\+pressure()} load function is passed to each of the traction elements.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//=================start\_actions\_after\_adapt=============================}\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Need\ to\ add\ on\ the\ traction\ elements\ after\ adaptation}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class}\ ELEMENT>}
\DoxyCodeLine{\textcolor{keywordtype}{void}\ \mbox{\hyperlink{classUnstructuredSolidProblem_acf0bbf57534a1516a633d702d9fd21ab}{UnstructuredSolidProblem<ELEMENT>::actions\_after\_adapt}}()}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \textcolor{comment}{//The\ boundary\ in\ question\ is\ boundary\ 0}}
\DoxyCodeLine{\ \textcolor{keywordtype}{unsigned}\ b=0;}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//\ How\ many\ bulk\ elements\ are\ adjacent\ to\ boundary\ b?}}
\DoxyCodeLine{\ \textcolor{keywordtype}{unsigned}\ n\_element\ =\ Solid\_mesh\_pt-\/>nboundary\_element(b);}
\DoxyCodeLine{\ \textcolor{comment}{//\ Loop\ over\ the\ bulk\ elements\ adjacent\ to\ boundary\ b}}
\DoxyCodeLine{\ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ e=0;e<n\_element;e++)}
\DoxyCodeLine{\ \ \{}
\DoxyCodeLine{\ \ \ \textcolor{comment}{//\ Get\ pointer\ to\ the\ bulk\ element\ that\ is\ adjacent\ to\ boundary\ b}}
\DoxyCodeLine{\ \ \ ELEMENT*\ bulk\_elem\_pt\ =\ \textcolor{keyword}{dynamic\_cast<}ELEMENT*\textcolor{keyword}{>}(}
\DoxyCodeLine{\ \ \ \ Solid\_mesh\_pt-\/>boundary\_element\_pt(b,e));}
\DoxyCodeLine{\ \ \ }
\DoxyCodeLine{\ \ \ \textcolor{comment}{//Find\ the\ index\ of\ the\ face\ of\ element\ e\ along\ boundary\ b}}
\DoxyCodeLine{\ \ \ \textcolor{keywordtype}{int}\ face\_index\ =\ Solid\_mesh\_pt-\/>face\_index\_at\_boundary(b,e);}
\DoxyCodeLine{\ \ \ }
\DoxyCodeLine{\ \ \ \textcolor{comment}{//Create\ solid\ traction\ element}}
\DoxyCodeLine{\ \ \ SolidTractionElement<ELEMENT>\ *el\_pt\ =\ }
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{new}\ SolidTractionElement<ELEMENT>(bulk\_elem\_pt,face\_index);\ \ \ }
\DoxyCodeLine{\ \ \ }
\DoxyCodeLine{\ \ \ \textcolor{comment}{//\ Add\ to\ mesh}}
\DoxyCodeLine{\ \ \ Traction\_mesh\_pt-\/>add\_element\_pt(el\_pt);}
\DoxyCodeLine{\ \ \ }
\DoxyCodeLine{\ \ \ \textcolor{comment}{//Set\ the\ traction\ function}}
\DoxyCodeLine{\ \ \ el\_pt-\/>traction\_fct\_pt()\ =\ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a19f4e20a92e7d216b4d2b00308f96917}{Global\_Physical\_Variables::constant\_pressure}};}
\DoxyCodeLine{\ \ \}\ \ }
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//Now\ rebuild\ the\ global\ mesh}}
\DoxyCodeLine{\ this-\/>rebuild\_global\_mesh();}

\end{DoxyCodeInclude}
 Next, the boundary conditions of a fixed base (boundary 3) are set. These must be reset every time after an adaptation because completely new nodes are generated.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//(Re)set\ the\ boundary\ conditions}}
\DoxyCodeLine{\ \textcolor{comment}{//Pin\ both\ positions\ at\ lower\ boundary\ (boundary\ 3)}}
\DoxyCodeLine{\ \textcolor{keywordtype}{unsigned}\ ibound=3;}
\DoxyCodeLine{\ \textcolor{keywordtype}{unsigned}\ num\_nod=\ mesh\_pt()-\/>nboundary\_node(ibound);}
\DoxyCodeLine{\ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ inod=0;inod<num\_nod;inod++)}
\DoxyCodeLine{\ \ \{\ \ }
\DoxyCodeLine{\ \ \ \textcolor{comment}{//\ Get\ node}}
\DoxyCodeLine{\ \ \ SolidNode*\ nod\_pt=Solid\_mesh\_pt-\/>boundary\_node\_pt(ibound,inod);}
\DoxyCodeLine{\ \ \ }
\DoxyCodeLine{\ \ \ \textcolor{comment}{//\ Pin\ both\ directions}}
\DoxyCodeLine{\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i=0;i<2;i++)\ \{nod\_pt-\/>pin\_position(i);\}}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\ \textcolor{comment}{//End\ of\ set\ boundary\ conditions\ }}

\end{DoxyCodeInclude}
 Finally, the constitutive law and, if required, incompressibility flag are passed to the bulk (solid) elements. Again, this must be performed after every adaptation because a completely new mesh is generated.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Complete\ the\ build\ of\ all\ elements\ so\ they\ are\ fully\ functional}}
\DoxyCodeLine{\ n\_element\ =\ Solid\_mesh\_pt-\/>nelement();}
\DoxyCodeLine{\ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ e=0;e<n\_element;e++)}
\DoxyCodeLine{\ \ \{}
\DoxyCodeLine{\ \ \ \textcolor{comment}{//Cast\ to\ a\ solid\ element}}
\DoxyCodeLine{\ \ \ ELEMENT\ *el\_pt\ =\ \textcolor{keyword}{dynamic\_cast<}ELEMENT*\textcolor{keyword}{>}(Solid\_mesh\_pt-\/>element\_pt(e));}
\DoxyCodeLine{\ \ \ }
\DoxyCodeLine{\ \ \ \textcolor{comment}{//\ Set\ the\ constitutive\ law}}
\DoxyCodeLine{\ \ \ el\_pt-\/>constitutive\_law\_pt()\ =}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a2a37fb040c832ee7a086bb13bb02a100}{Global\_Physical\_Variables::Constitutive\_law\_pt}};}
\DoxyCodeLine{\ \ \ }
\DoxyCodeLine{\ \ \ \textcolor{comment}{//Set\ the\ incompressibility\ flag\ if\ required}}
\DoxyCodeLine{\ \ \ \textcolor{keywordflow}{if}(Incompressible)\ }
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \textcolor{comment}{//Need\ another\ dynamic\ cast}}
\DoxyCodeLine{\ \ \ \ \ \textcolor{keyword}{dynamic\_cast<}TPVDElementWithContinuousPressure<2>*\textcolor{keyword}{>}(el\_pt)}
\DoxyCodeLine{\ \ \ \ \ \ -\/>set\_incompressible();}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\}\ \textcolor{comment}{//\ end\_actions\_after\_adapt}}

\end{DoxyCodeInclude}
 \DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_strain}{}\doxysection{\texorpdfstring{Computation of the strain energy}{Computation of the strain energy}}\label{index_strain}
The strain energy is computed by looping over all elements in the bulk mesh and adding their contributions to the potential (strain) energy.

 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//================start\_get\_strain\_energy================================}}
\DoxyCodeLine{\textcolor{comment}{///\ Calculate\ the\ strain\ energy\ in\ the\ entire\ elastic\ solid}}
\DoxyCodeLine{\textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class}\ ELEMENT>}
\DoxyCodeLine{\textcolor{keywordtype}{double}\ \mbox{\hyperlink{classUnstructuredSolidProblem_a4da918a1f0cf94ebccc5112b58c28ece}{UnstructuredSolidProblem<ELEMENT>::get\_strain\_energy}}()}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \textcolor{keywordtype}{double}\ strain\_energy=0.0;}
\DoxyCodeLine{\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ n\_element\ =\ Solid\_mesh\_pt-\/>nelement();}
\DoxyCodeLine{\ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ e=0;e<n\_element;e++)}
\DoxyCodeLine{\ \ \{}
\DoxyCodeLine{\ \ \ \textcolor{comment}{//Cast\ to\ a\ solid\ element}}
\DoxyCodeLine{\ \ \ ELEMENT\ *el\_pt\ =\ \textcolor{keyword}{dynamic\_cast<}ELEMENT*\textcolor{keyword}{>}(Solid\_mesh\_pt-\/>element\_pt(e));}
\DoxyCodeLine{\ \ \ }
\DoxyCodeLine{\ \ \ \textcolor{keywordtype}{double}\ pot\_en,\ kin\_en;}
\DoxyCodeLine{\ \ \ el\_pt-\/>get\_energy(pot\_en,kin\_en);}
\DoxyCodeLine{\ \ \ strain\_energy\ +=\ pot\_en;}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{keywordflow}{return}\ strain\_energy;}
\DoxyCodeLine{\}\ \textcolor{comment}{//\ end\_get\_strain\_energy}}

\end{DoxyCodeInclude}
 \DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_doc}{}\doxysection{\texorpdfstring{Post-\/processing}{Post-processing}}\label{index_doc}
The post-\/processing routine outputs the deformed domain shape and the applied traction. In the spirit of continuing paranoia we also document the domain boundaries. It is exactly the same as in the related \href{../../unstructured_solid/html/index.html}{\texttt{ non-\/adaptive unstructured solid tutorial. }}

\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_comm_ex}{}\doxysection{\texorpdfstring{Comments and Exercises}{Comments and Exercises}}\label{index_comm_ex}
\hypertarget{index_ex}{}\doxysubsection{\texorpdfstring{Exercises}{Exercises}}\label{index_ex}

\begin{DoxyEnumerate}
\item Examine the changes in strain energy under variations in mesh refinement tolerances and number of intermediate steps between the undeformed and maximally deformed states.
\item What happens if the Lagrangian coordinates are reset after every adaptation? Why?
\item Modify the problem so that compression is from the upper surface, rather than the left-\/hand side. What happens when the material is incompressible?
\end{DoxyEnumerate}

\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_sources}{}\doxysection{\texorpdfstring{Source files for this tutorial}{Source files for this tutorial}}\label{index_sources}

\begin{DoxyItemize}
\item The source files for this tutorial are located in the directory\+:~\newline
~\newline
\begin{center} \href{../../../../demo_drivers/solid/unstructured_adaptive_solid/}{\texttt{ demo\+\_\+drivers/solid/unstructured\+\_\+adaptive\+\_\+solid/ }} \end{center} ~\newline

\item The driver codes are\+: ~\newline
~\newline
\begin{center} \href{../../../../demo_drivers/solid/unstructured_adaptive_solid/unstructured_adaptive_solid.cc}{\texttt{ demo\+\_\+drivers/solid/unstructured\+\_\+solid/unstructured\+\_\+adaptive\+\_\+solid.\+cc }} \end{center} 
\end{DoxyItemize}

\DoxyHorRuler{0}
 \DoxyHorRuler{0}
 \hypertarget{index_pdf}{}\doxysection{\texorpdfstring{PDF file}{PDF file}}\label{index_pdf}
A \href{../latex/refman.pdf}{\texttt{ pdf version}} of this document is available. \end{document}
