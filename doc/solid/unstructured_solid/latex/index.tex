\chapter{Demo problem\+: Solid Mechanics using unstructured meshes}
\hypertarget{index}{}\label{index}\index{Demo problem: Solid Mechanics using unstructured meshes@{Demo problem: Solid Mechanics using unstructured meshes}}
The purpose of this tutorial is to demonstrate the solution of solid mechanics problems using unstructured meshes. We focus primarily on two-\/dimensional meshes, generated using \href{http://www.cs.berkeley.edu/~jrs/}{\texttt{ Jonathan Shewchuk\textquotesingle{}s}} open-\/source mesh generator \href{http://www.cs.cmu.edu/~quake/triangle.html}{\texttt{ {\ttfamily Triangle},}} based on the output from the open-\/source drawing program \href{http://en.wikipedia.org/wiki/Xfig}{\texttt{ xfig.}} An example three-\/dimensional problem is described \href{../../unstructured_three_d_solid/html/index.html}{\texttt{ here; }} see also \doxysectlink{index_three_d}{3D Problems}{2} later in this document.

The solid mechanics problem studied here also serves as a "{}warm-\/up problem"{} for the \href{../../../interaction/unstructured_fsi/html/index.html}{\texttt{ corresponding fluid-\/structure interaction problem }} in which the solid object is immersed in (and loaded by) a viscous fluid.

\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_problem}{}\doxysection{\texorpdfstring{The problem}{The problem}}\label{index_problem}
Here is a sketch of the problem\+: A slightly strange-\/looking elastic solid is loaded by gravity and by a pressure load, acting on its upper face.

 
\begin{DoxyImage}
\includegraphics[width=0.75\textwidth]{solid_sketch}
\doxyfigcaption{Sketch of the problem. }
\end{DoxyImage}


\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_mesh}{}\doxysection{\texorpdfstring{Mesh generation}{Mesh generation}}\label{index_mesh}
We employ the combination of \href{http://en.wikipedia.org/wiki/Xfig}{\texttt{ xfig}}, {\ttfamily oomph-\/lib\textquotesingle{}s} conversion code \href{../../../meshes/mesh_from_xfig/html/index.html}{\texttt{ {\ttfamily fig2poly} }}, and the unstructured mesh generator \href{http://www.cs.cmu.edu/~quake/triangle.html}{\texttt{ {\ttfamily Triangle} }} to generate the mesh, using the procedure discussed in \href{../../../meshes/mesh_from_xfig/html/index.html}{\texttt{ another tutorial.}}

We start by drawing the outline of the solid as a polyline in \href{http://en.wikipedia.org/wiki/Xfig}{\texttt{ xfig}}\+:

 
\begin{DoxyImage}
\includegraphics[width=0.75\textwidth]{xfig_screenshot}
\doxyfigcaption{xfig drawing of the solid body. }
\end{DoxyImage}


(Note that we draw the solid upside-\/down because of the way \href{http://en.wikipedia.org/wiki/Xfig}{\texttt{ xfig}} orients its coordinate axes.)

We save the figure as a \texorpdfstring{$\ast$}{*}.fig file and convert it to a \texorpdfstring{$\ast$}{*}.poly file using {\ttfamily oomph-\/lib\textquotesingle{}s} conversion code \href{../../../meshes/mesh_from_xfig/html/index.html}{\texttt{ {\ttfamily fig2poly} }} (a copy of which is located in {\ttfamily oomph-\/lib\textquotesingle{}s} {\ttfamily bin} directory)\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{classElasticTetMesh}{fig3poly}}\ \mbox{\hyperlink{classElasticTetMesh}{solid}}.fig\ }

\end{DoxyCode}


This creates a file called {\ttfamily solid.\+fig.\+poly} that can be processed using Triangle. For instance, to create a quality mesh with a maximum element size of \doxylink{classElasticTetMesh_afa0c8df37665c2b31b430de7e50dcc6b}{0.\+025} we use 
\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{classElasticTetMesh}{triangle}}\ -\/\mbox{\hyperlink{classElasticTetMesh}{q}}\ -\/\mbox{\hyperlink{classElasticTetMesh}{a0}}.025\ \mbox{\hyperlink{classElasticTetMesh}{solid}}.fig.poly}

\end{DoxyCode}


Here is a plot of the mesh, generated by {\ttfamily showme} distributed with \href{http://www.cs.cmu.edu/~quake/triangle.html}{\texttt{ {\ttfamily Triangle} }}\+:

 
\begin{DoxyImage}
\includegraphics[width=0.75\textwidth]{showme_screenshot}
\doxyfigcaption{Visualisation of the mesh with showme. }
\end{DoxyImage}


The {\ttfamily  \texorpdfstring{$\ast$}{*}.poly, \texorpdfstring{$\ast$}{*}.ele } and {\ttfamily  \texorpdfstring{$\ast$}{*}.node } files generated by \href{http://www.cs.cmu.edu/~quake/triangle.html}{\texttt{ {\ttfamily Triangle} }} can now be used as input to {\ttfamily oomph-\/lib\textquotesingle{}s} {\ttfamily Triangle\+Mesh} class.

\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_results}{}\doxysection{\texorpdfstring{Results}{Results}}\label{index_results}
The animation shown below illustrates the solid\textquotesingle{}s deformation. The first frame shows the undeformed, stress-\/free reference configuration; the second frame shows the deformation induced by gravity. Subsequent frames illustrate the deformation in response to the (additional) increasing "{}suction"{} applied at the upper face.

 
\begin{DoxyImage}
\includegraphics[width=0.75\textwidth]{two_d}
\doxyfigcaption{Plot of the deformation. }
\end{DoxyImage}


The blue markers show the position of pinned nodes.

\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_mesh_code}{}\doxysection{\texorpdfstring{Creating the mesh}{Creating the mesh}}\label{index_mesh_code}
We create the mesh by multiple inheritance from {\ttfamily oomph-\/lib\textquotesingle{}s} {\ttfamily Triangle\+Mesh} and the {\ttfamily Solid\+Mesh} base class\+:

 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//================start\_mesh===============================================}}
\DoxyCodeLine{\textcolor{comment}{///\ Triangle-\/based\ mesh\ upgraded\ to\ become\ a\ solid\ mesh}}
\DoxyCodeLine{\textcolor{comment}{//=========================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class}\ ELEMENT>}
\DoxyCodeLine{\textcolor{keyword}{class\ }\mbox{\hyperlink{classElasticTriangleMesh}{ElasticTriangleMesh}}\ :\ \textcolor{keyword}{public}\ \textcolor{keyword}{virtual}\ TriangleMesh<ELEMENT>,\ }
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{virtual}\ SolidMesh\ }
\DoxyCodeLine{\{}

\end{DoxyCodeInclude}
 The constructor calls the constructor of the underlying {\ttfamily Triangle\+Mesh}, and, as usual, sets the Lagrangian coordinates to the current nodal positions, making the current configuration stress-\/free.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\ }
\DoxyCodeLine{\textcolor{keyword}{public}:}
\DoxyCodeLine{\ \textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Constructor:\ }}
\DoxyCodeLine{\textcolor{comment}{}\ \mbox{\hyperlink{classElasticTriangleMesh}{ElasticTriangleMesh}}(\textcolor{keyword}{const}\ std::string\&\ \mbox{\hyperlink{classElasticTetMesh}{node\_file\_name}},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ \mbox{\hyperlink{classElasticTetMesh}{element\_file\_name}},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ \mbox{\hyperlink{classElasticTetMesh}{poly\_file\_name}},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classElasticTetMesh}{TimeStepper}}*\ \mbox{\hyperlink{classElasticTetMesh}{time\_stepper\_pt}}=}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{classElasticTetMesh_afa0c8df37665c2b31b430de7e50dcc6b}{Mesh::Default\_TimeStepper}})\ :\ }
\DoxyCodeLine{\ TriangleMesh<\mbox{\hyperlink{classElasticTetMesh}{ELEMENT}}>(\mbox{\hyperlink{classElasticTetMesh}{node\_file\_name}},\mbox{\hyperlink{classElasticTetMesh}{element\_file\_name}},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classElasticTetMesh}{poly\_file\_name}},\ \mbox{\hyperlink{classElasticTetMesh}{time\_stepper\_pt}})}
\DoxyCodeLine{\ \ \{}
\DoxyCodeLine{\ \ \ \textcolor{comment}{//Assign\ the\ Lagrangian\ coordinates}}
\DoxyCodeLine{\ \ \ \mbox{\hyperlink{classElasticTetMesh}{set\_lagrangian\_nodal\_coordinates}}();}

\end{DoxyCodeInclude}
 The {\ttfamily Triangle\+Mesh} constructor associates each polyline in the {\ttfamily xfig} drawing with a distinct {\ttfamily oomph-\/lib} mesh boundary. Hence the boundary nodes are initially located on the same, single boundary. To facilitate the application of boundary conditions, we divide the single boundary into three\+:


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \textcolor{comment}{//\ Identify\ special\ boundaries}}
\DoxyCodeLine{\ \ \ \mbox{\hyperlink{classElasticTetMesh}{set\_nboundary}}(3);}

\end{DoxyCodeInclude}
 We loop over all nodes in the mesh and identify nodes on the lower (pinned) boundary by their y-\/coordinate. We remove the node from the boundary 0 and re-\/allocate it to the new boundary 1\+:


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classElasticTetMesh}{n\_node}}=this-\/>\mbox{\hyperlink{classElasticTetMesh}{nnode}}();}
\DoxyCodeLine{\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classElasticTetMesh}{j}}=0;\mbox{\hyperlink{classElasticTetMesh}{j}}<\mbox{\hyperlink{classElasticTetMesh}{n\_node}};\mbox{\hyperlink{classElasticTetMesh}{j}}++)}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \mbox{\hyperlink{classElasticTetMesh}{Node}}*\ \mbox{\hyperlink{classElasticTetMesh}{nod\_pt}}=this-\/>\mbox{\hyperlink{classElasticTetMesh}{node\_pt}}(\mbox{\hyperlink{classElasticTetMesh}{j}});}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \textcolor{comment}{//\ Boundary\ 1\ is\ lower\ boundary}}
\DoxyCodeLine{\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classElasticTetMesh}{nod\_pt}}-\/>x(1)<0.15)}
\DoxyCodeLine{\ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ this-\/>\mbox{\hyperlink{classElasticTetMesh}{remove\_boundary\_node}}(0,\mbox{\hyperlink{classElasticTetMesh}{nod\_pt}});}
\DoxyCodeLine{\ \ \ \ \ \ \ this-\/>\mbox{\hyperlink{classElasticTetMesh}{add\_boundary\_node}}(1,\mbox{\hyperlink{classElasticTetMesh}{nod\_pt}});}
\DoxyCodeLine{\ \ \ \ \ \ \}}

\end{DoxyCodeInclude}
 Similarly, we identify all nodes on the upper boundary and re-\/assign them to boundary 2, before re-\/generating the various boundary lookup schemes that identify which elements are located next to the various mesh boundaries\+:


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \textcolor{comment}{//\ Boundary\ 2\ is\ upper\ boundary}}
\DoxyCodeLine{\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classElasticTetMesh}{nod\_pt}}-\/>x(1)>2.69)}
\DoxyCodeLine{\ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ this-\/>\mbox{\hyperlink{classElasticTetMesh}{remove\_boundary\_node}}(0,\mbox{\hyperlink{classElasticTetMesh}{nod\_pt}});}
\DoxyCodeLine{\ \ \ \ \ \ \ this-\/>\mbox{\hyperlink{classElasticTetMesh}{add\_boundary\_node}}(2,\mbox{\hyperlink{classElasticTetMesh}{nod\_pt}});}
\DoxyCodeLine{\ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}About\ to\ setup\ the\ boundary\ elements"{}}\ <<\ std::endl;}
\DoxyCodeLine{\ \ \ \textcolor{comment}{//\ Re-\/setup\ boundary\ info,\ i.e.\ elements\ next\ to\ boundaries}}
\DoxyCodeLine{\ \ \ TriangleMesh<ELEMENT>::setup\_boundary\_element\_info();}
\DoxyCodeLine{\ \ \ \textcolor{comment}{//This\ is\ the\ bit\ that\ has\ gone\ wrong}}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Empty\ Destructor}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classElasticTriangleMesh}{\string~ElasticTriangleMesh}}()\ \{\ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\};}

\end{DoxyCodeInclude}
 \DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_namespace}{}\doxysection{\texorpdfstring{Problem Parameters}{Problem Parameters}}\label{index_namespace}
As usual we define the various problem parameters in a global namespace. We define Poisson\textquotesingle{}s ratio and prepare a pointer to a constitutive equation.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//=======start\_namespace==========================================}}
\DoxyCodeLine{\textcolor{comment}{///\ Global\ variables}}
\DoxyCodeLine{\textcolor{comment}{//================================================================}}
\DoxyCodeLine{\textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceGlobal__Physical__Variables}{Global\_Physical\_Variables}}}
\DoxyCodeLine{\{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Poisson's\ ratio}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a3962c36313826b19f216f6bbbdd6a477}{Nu}}=0.3;}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Pointer\ to\ constitutive\ law}}
\DoxyCodeLine{\textcolor{comment}{}\ \mbox{\hyperlink{classElasticTetMesh}{ConstitutiveLaw}}*\ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a5d5f19442938130d36ee7476ae25049c}{Constitutive\_law\_pt}}=0;}

\end{DoxyCodeInclude}
 Next we define the gravitational body force


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Non-\/dim\ gravity}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a8b80d3e8d63b8d0a0ed435a2dd7fe2ad}{Gravity}}=0.0;}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Non-\/dimensional\ gravity\ as\ body\ force}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a0777aef63372db7f91ad894c38159681}{gravity}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\&\ \mbox{\hyperlink{classElasticTetMesh}{time}},\ }
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classElasticTetMesh}{Vector<double>}}\ \&\mbox{\hyperlink{classElasticTetMesh}{xi}},\ }
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classElasticTetMesh}{Vector<double>}}\ \&\mbox{\hyperlink{classElasticTetMesh}{b}})}
\DoxyCodeLine{\ \{}
\DoxyCodeLine{\ \ \mbox{\hyperlink{classElasticTetMesh}{b}}[0]=0.0;}
\DoxyCodeLine{\ \ \mbox{\hyperlink{classElasticTetMesh}{b}}[1]=-\/\mbox{\hyperlink{namespaceGlobal__Physical__Variables_a8b80d3e8d63b8d0a0ed435a2dd7fe2ad}{Gravity}};}
\DoxyCodeLine{\ \}}

\end{DoxyCodeInclude}
 and the pressure load to be applied at the upper boundary


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\ \textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Uniform\ pressure}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a23c2ade6398f54040b869f7f3a2bcc4b}{P}}\ =\ 0.0;}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Constant\ pressure\ load.\ The\ arguments\ to\ this\ function\ are\ imposed}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ on\ us\ by\ the\ SolidTractionElements\ which\ allow\ the\ traction\ to\ }}
\DoxyCodeLine{\textcolor{comment}{\ ///\ depend\ on\ the\ Lagrangian\ and\ Eulerian\ coordinates\ x\ and\ xi,\ and\ on\ the\ }}
\DoxyCodeLine{\textcolor{comment}{\ ///\ outer\ unit\ normal\ to\ the\ surface.\ Here\ we\ only\ need\ the\ outer\ unit}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ normal.}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a19f4e20a92e7d216b4d2b00308f96917}{constant\_pressure}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classElasticTetMesh}{Vector<double>}}\ \&\mbox{\hyperlink{classElasticTetMesh}{xi}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classElasticTetMesh}{Vector<double>}}\ \&\mbox{\hyperlink{classElasticTetMesh}{x}},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classElasticTetMesh}{Vector<double>}}\ \&\mbox{\hyperlink{classElasticTetMesh}{n}},\ \mbox{\hyperlink{classElasticTetMesh}{Vector<double>}}\ \&\mbox{\hyperlink{classElasticTetMesh}{traction}})}
\DoxyCodeLine{\ \{}
\DoxyCodeLine{\ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classElasticTetMesh}{dim}}\ =\ \mbox{\hyperlink{classElasticTetMesh}{traction}}.size();}
\DoxyCodeLine{\ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classElasticTetMesh}{i}}=0;\mbox{\hyperlink{classElasticTetMesh}{i}}<\mbox{\hyperlink{classElasticTetMesh}{dim}};\mbox{\hyperlink{classElasticTetMesh}{i}}++)}
\DoxyCodeLine{\ \ \ \{}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{classElasticTetMesh}{traction}}[\mbox{\hyperlink{classElasticTetMesh}{i}}]\ =\ -\/\mbox{\hyperlink{namespaceGlobal__Physical__Variables_a23c2ade6398f54040b869f7f3a2bcc4b}{P}}*\mbox{\hyperlink{classElasticTetMesh}{n}}[\mbox{\hyperlink{classElasticTetMesh}{i}}];}
\DoxyCodeLine{\ \ \ \}}
\DoxyCodeLine{\ \}\ }
\DoxyCodeLine{}
\DoxyCodeLine{\}\ \textcolor{comment}{//end\ namespace}}

\end{DoxyCodeInclude}
 \DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_main}{}\doxysection{\texorpdfstring{The driver code}{The driver code}}\label{index_main}
The driver code is straightforward. We specify an output directory and instantiate a constitutive equation. (Recall that the single-\/argument constructor to the {\ttfamily Generalised\+Hookean} constitutive law implies that all stresses are non-\/dimensionalised on Young\textquotesingle{}s modulus $ E $).

 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//===========start\_main===================================================}}
\DoxyCodeLine{\textcolor{comment}{///\ Demonstrate\ how\ to\ solve\ an\ unstructured\ solid\ problem}}
\DoxyCodeLine{\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\textcolor{keywordtype}{int}\ \mbox{\hyperlink{unstructured__three__d__solid_8cc_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}}()}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Label\ for\ output}}
\DoxyCodeLine{\ \mbox{\hyperlink{classElasticTetMesh}{DocInfo}}\ \mbox{\hyperlink{classElasticTetMesh}{doc\_info}};}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Output\ directory}}
\DoxyCodeLine{\ \mbox{\hyperlink{classElasticTetMesh}{doc\_info}}.set\_directory(\textcolor{stringliteral}{"{}RESLT"{}});}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Create\ generalised\ Hookean\ constitutive\ equations}}
\DoxyCodeLine{\ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a5d5f19442938130d36ee7476ae25049c}{Global\_Physical\_Variables::Constitutive\_law\_pt}}\ =\ }
\DoxyCodeLine{\ \ \textcolor{keyword}{new}\ \mbox{\hyperlink{classElasticTetMesh}{GeneralisedHookean}}(\&\mbox{\hyperlink{namespaceGlobal__Physical__Variables_a3962c36313826b19f216f6bbbdd6a477}{Global\_Physical\_Variables::Nu}});}

\end{DoxyCodeInclude}
 We create the {\ttfamily Problem} object using a displacement formulation of the equations and output the initial configuration


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \{}
\DoxyCodeLine{\ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Running\ with\ pure\ displacement\ formulation\(\backslash\)n"{}};}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \textcolor{comment}{//Set\ up\ the\ problem}}
\DoxyCodeLine{\ \ \mbox{\hyperlink{classElasticTetMesh}{UnstructuredSolidProblem<TPVDElement<2,3>}}\ >\ \mbox{\hyperlink{classElasticTetMesh}{problem}};}
\DoxyCodeLine{\ \ }
\DoxyCodeLine{\ \ \textcolor{comment}{//Output\ initial\ configuration}}
\DoxyCodeLine{\ \ \mbox{\hyperlink{classElasticTetMesh}{problem}}.doc\_solution(\mbox{\hyperlink{classElasticTetMesh}{doc\_info}});}
\DoxyCodeLine{\ \ \mbox{\hyperlink{classElasticTetMesh}{doc\_info}}.number()++;}

\end{DoxyCodeInclude}
 Finally, we perform a straightforward parameter study, applying a constant gravitational load and slowly increasing the suction (negative pressure) on the upper boundary.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\ \ }
\DoxyCodeLine{\ \ \textcolor{comment}{//\ Parameter\ study}}
\DoxyCodeLine{\ \ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a8b80d3e8d63b8d0a0ed435a2dd7fe2ad}{Global\_Physical\_Variables::Gravity}}=2.0e-\/4;}
\DoxyCodeLine{\ \ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a23c2ade6398f54040b869f7f3a2bcc4b}{Global\_Physical\_Variables::P}}=0.0;}
\DoxyCodeLine{\ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classElasticTetMesh}{pressure\_increment}}=-\/1.0e-\/4;}
\DoxyCodeLine{\ \ }
\DoxyCodeLine{\ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classElasticTetMesh}{nstep}}=2;\ \textcolor{comment}{//\ 10;}}
\DoxyCodeLine{\ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classElasticTetMesh}{istep}}=0;\mbox{\hyperlink{classElasticTetMesh}{istep}}<\mbox{\hyperlink{classElasticTetMesh}{nstep}};\mbox{\hyperlink{classElasticTetMesh}{istep}}++)}
\DoxyCodeLine{\ \ \ \{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Solve\ the\ problem}}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{classElasticTetMesh}{problem}}.newton\_solve();}
\DoxyCodeLine{\ \ \ \ }
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//Output\ solution}}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{classElasticTetMesh}{problem}}.doc\_solution(\mbox{\hyperlink{classElasticTetMesh}{doc\_info}});}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{classElasticTetMesh}{doc\_info}}.number()++;}
\DoxyCodeLine{\ \ \ \ }
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Bump\ up\ suction}}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a23c2ade6398f54040b869f7f3a2bcc4b}{Global\_Physical\_Variables::P}}+=\mbox{\hyperlink{classElasticTetMesh}{pressure\_increment}};}
\DoxyCodeLine{\ \ \ \}}
\DoxyCodeLine{\ \}\ \textcolor{comment}{//end\_displacement\_formulation}}

\end{DoxyCodeInclude}
 The parameter study is then repeated for a pressure-\/displacement formulation with and without an incompressibility constraint, see the \href{../../../../demo_drivers/solid/unstructured_solid/unstructured_two_d_solid.cc}{\texttt{ source code }} for details.

\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_class}{}\doxysection{\texorpdfstring{The Problem class}{The Problem class}}\label{index_class}
The {\ttfamily Problem} class has the usual member functions and provides storage for the two sub-\/meshes\+: the bulk mesh of 2D solid elements and the mesh of 1D traction elements that will be attached to the upper boundary.

 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//==============start\_problem=========================================}}
\DoxyCodeLine{\textcolor{comment}{///\ Unstructured\ solid\ problem}}
\DoxyCodeLine{\textcolor{comment}{//====================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class}\ ELEMENT>\ }
\DoxyCodeLine{\textcolor{keyword}{class\ }\mbox{\hyperlink{classUnstructuredSolidProblem}{UnstructuredSolidProblem}}\ :\ \textcolor{keyword}{public}\ Problem}
\DoxyCodeLine{\{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{public}:}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Constructor:\ }}
\DoxyCodeLine{\textcolor{comment}{}\ \mbox{\hyperlink{classUnstructuredSolidProblem_a18ce02b6e4bbc86403c9e1b32c095772}{UnstructuredSolidProblem}}();}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Destructor\ (empty)}}
\DoxyCodeLine{\textcolor{comment}{}\ \mbox{\hyperlink{classUnstructuredSolidProblem_a25fe105d949498bf8f7c15aff96a7d00}{\string~UnstructuredSolidProblem}}()\{\}}
\DoxyCodeLine{\ \textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Doc\ the\ solution}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classUnstructuredSolidProblem_ab3d66fd61b69d12b4f159d763fc44f15}{doc\_solution}}(\mbox{\hyperlink{classElasticTetMesh}{DocInfo}}\&\ \mbox{\hyperlink{classElasticTetMesh}{doc\_info}});}
\DoxyCodeLine{\ }
\DoxyCodeLine{\textcolor{keyword}{private}:}
\DoxyCodeLine{\ \textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Bulk\ mesh}}
\DoxyCodeLine{\textcolor{comment}{}\ \mbox{\hyperlink{classElasticTetMesh}{ElasticTriangleMesh<ELEMENT>}}*\ \mbox{\hyperlink{classUnstructuredSolidProblem_a09c0a07feb1586f2cca3766b4ac92099}{Solid\_mesh\_pt}};}
\DoxyCodeLine{\ \textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Pointer\ to\ mesh\ of\ traction\ elements}}
\DoxyCodeLine{\textcolor{comment}{}\ SolidMesh*\ \mbox{\hyperlink{classUnstructuredSolidProblem_ade114e509464031ba8657600584b9743}{Traction\_mesh\_pt}};}
\DoxyCodeLine{}
\DoxyCodeLine{\};}

\end{DoxyCodeInclude}


\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_constructor}{}\doxysection{\texorpdfstring{The Problem constructor}{The Problem constructor}}\label{index_constructor}
We start by building the bulk mesh, using the files created by \href{http://www.cs.cmu.edu/~quake/triangle.html}{\texttt{ {\ttfamily Triangle} }}.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//===============start\_constructor========================================}}
\DoxyCodeLine{\textcolor{comment}{///\ Constructor\ for\ unstructured\ solid\ problem}}
\DoxyCodeLine{\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class}\ ELEMENT>}
\DoxyCodeLine{\mbox{\hyperlink{classUnstructuredSolidProblem_a18ce02b6e4bbc86403c9e1b32c095772}{UnstructuredSolidProblem<ELEMENT>::UnstructuredSolidProblem}}()}
\DoxyCodeLine{\{\ \ }
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//Create\ solid\ mesh}}
\DoxyCodeLine{\ \textcolor{keywordtype}{string}\ \mbox{\hyperlink{classElasticTetMesh}{node\_file\_name}}=\textcolor{stringliteral}{"{}solid.fig.1.node"{}};}
\DoxyCodeLine{\ \textcolor{keywordtype}{string}\ \mbox{\hyperlink{classElasticTetMesh}{element\_file\_name}}=\textcolor{stringliteral}{"{}solid.fig.1.ele"{}};}
\DoxyCodeLine{\ \textcolor{keywordtype}{string}\ \mbox{\hyperlink{classElasticTetMesh}{poly\_file\_name}}=\textcolor{stringliteral}{"{}solid.fig.1.poly"{}};\ }
\DoxyCodeLine{\ Solid\_mesh\_pt\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classElasticTetMesh}{ElasticTriangleMesh<ELEMENT>}}(\mbox{\hyperlink{classElasticTetMesh}{node\_file\_name}},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classElasticTetMesh}{element\_file\_name}},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classElasticTetMesh}{poly\_file\_name}});}

\end{DoxyCodeInclude}
 Next we create traction elements, attaching them to the "{}bulk"{} solid elements that are adjacent to boundary 2. We also specify the load function.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Traction\ elements\ are\ located\ on\ boundary\ 2:}}
\DoxyCodeLine{\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classElasticTetMesh}{b}}=2;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Make\ traction\ mesh}}
\DoxyCodeLine{\ Traction\_mesh\_pt=\textcolor{keyword}{new}\ SolidMesh;}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//\ How\ many\ bulk\ elements\ are\ adjacent\ to\ boundary\ b?}}
\DoxyCodeLine{\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classElasticTetMesh}{n\_element}}\ =\ Solid\_mesh\_pt-\/>nboundary\_element(\mbox{\hyperlink{classElasticTetMesh}{b}});}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Loop\ over\ the\ bulk\ elements\ adjacent\ to\ boundary\ b}}
\DoxyCodeLine{\ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classElasticTetMesh}{e}}=0;\mbox{\hyperlink{classElasticTetMesh}{e}}<\mbox{\hyperlink{classElasticTetMesh}{n\_element}};\mbox{\hyperlink{classElasticTetMesh}{e}}++)}
\DoxyCodeLine{\ \ \{}
\DoxyCodeLine{\ \ \ \textcolor{comment}{//\ Get\ pointer\ to\ the\ bulk\ element\ that\ is\ adjacent\ to\ boundary\ b}}
\DoxyCodeLine{\ \ \ \mbox{\hyperlink{classElasticTetMesh}{ELEMENT}}*\ \mbox{\hyperlink{classElasticTetMesh}{bulk\_elem\_pt}}\ =\ \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classElasticTetMesh}{ELEMENT}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\ \ \ \ Solid\_mesh\_pt-\/>boundary\_element\_pt(\mbox{\hyperlink{classElasticTetMesh}{b}},\mbox{\hyperlink{classElasticTetMesh}{e}}));}
\DoxyCodeLine{\ \ \ }
\DoxyCodeLine{\ \ \ \textcolor{comment}{//Find\ the\ index\ of\ the\ face\ of\ element\ e\ along\ boundary\ b}}
\DoxyCodeLine{\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classElasticTetMesh}{face\_index}}\ =\ Solid\_mesh\_pt-\/>face\_index\_at\_boundary(\mbox{\hyperlink{classElasticTetMesh}{b}},\mbox{\hyperlink{classElasticTetMesh}{e}});}
\DoxyCodeLine{\ \ \ }
\DoxyCodeLine{\ \ \ \textcolor{comment}{//Create\ solid\ traction\ element}}
\DoxyCodeLine{\ \ \ \mbox{\hyperlink{classElasticTetMesh}{SolidTractionElement<ELEMENT>}}\ *\mbox{\hyperlink{classElasticTetMesh}{el\_pt}}\ =\ }
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{new}\ \mbox{\hyperlink{classElasticTetMesh}{SolidTractionElement<ELEMENT>}}(\mbox{\hyperlink{classElasticTetMesh}{bulk\_elem\_pt}},\mbox{\hyperlink{classElasticTetMesh}{face\_index}});\ \ \ }
\DoxyCodeLine{\ \ \ }
\DoxyCodeLine{\ \ \ \textcolor{comment}{//\ Add\ to\ mesh}}
\DoxyCodeLine{\ \ \ Traction\_mesh\_pt-\/>add\_element\_pt(\mbox{\hyperlink{classElasticTetMesh}{el\_pt}});}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \ \ \textcolor{comment}{//Set\ the\ traction\ function}}
\DoxyCodeLine{\ \ \ \mbox{\hyperlink{classElasticTetMesh}{el\_pt}}-\/>traction\_fct\_pt()\ =\ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a19f4e20a92e7d216b4d2b00308f96917}{Global\_Physical\_Variables::constant\_pressure}};}
\DoxyCodeLine{\ \ \}\ \ }

\end{DoxyCodeInclude}
 We add both meshes as sub-\/meshes to the {\ttfamily Problem} and build the global mesh


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Add\ sub\ meshes}}
\DoxyCodeLine{\ \mbox{\hyperlink{classElasticTetMesh}{add\_sub\_mesh}}(Solid\_mesh\_pt);}
\DoxyCodeLine{\ \mbox{\hyperlink{classElasticTetMesh}{add\_sub\_mesh}}(Traction\_mesh\_pt);}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Build\ global\ mesh}}
\DoxyCodeLine{\ \mbox{\hyperlink{classElasticTetMesh}{build\_global\_mesh}}();}

\end{DoxyCodeInclude}
 Next we apply the boundary conditions at the lower boundary where we suppress the displacements in both directions. We document the position of the pinned nodes to allow us to check that the boundary IDs were identified correctly -- see \doxysectlink{index_comm_ex}{Comments and Exercises}{1} for a further discussion of this issue.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Doc\ pinned\ solid\ nodes}}
\DoxyCodeLine{\ std::ofstream\ \mbox{\hyperlink{classElasticTetMesh}{bc\_file}}(\textcolor{stringliteral}{"{}pinned\_nodes.dat"{}});}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Pin\ both\ positions\ at\ lower\ boundary\ (boundary\ 1)}}
\DoxyCodeLine{\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classElasticTetMesh}{ibound}}=1;}
\DoxyCodeLine{\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classElasticTetMesh}{num\_nod}}=\ \mbox{\hyperlink{classElasticTetMesh}{mesh\_pt}}()-\/>nboundary\_node(\mbox{\hyperlink{classElasticTetMesh}{ibound}});}
\DoxyCodeLine{\ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classElasticTetMesh}{inod}}=0;\mbox{\hyperlink{classElasticTetMesh}{inod}}<\mbox{\hyperlink{classElasticTetMesh}{num\_nod}};\mbox{\hyperlink{classElasticTetMesh}{inod}}++)}
\DoxyCodeLine{\ \ \{\ \ }
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \textcolor{comment}{//\ Get\ node}}
\DoxyCodeLine{\ \ \ \mbox{\hyperlink{classElasticTetMesh}{SolidNode}}*\ \mbox{\hyperlink{classElasticTetMesh}{nod\_pt}}=Solid\_mesh\_pt-\/>boundary\_node\_pt(\mbox{\hyperlink{classElasticTetMesh}{ibound}},\mbox{\hyperlink{classElasticTetMesh}{inod}});}
\DoxyCodeLine{\ \ \ }
\DoxyCodeLine{\ \ \ \textcolor{comment}{//\ Pin\ both\ directions}}
\DoxyCodeLine{\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classElasticTetMesh}{i}}=0;\mbox{\hyperlink{classElasticTetMesh}{i}}<2;\mbox{\hyperlink{classElasticTetMesh}{i}}++)}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \mbox{\hyperlink{classElasticTetMesh}{nod\_pt}}-\/>pin\_position(\mbox{\hyperlink{classElasticTetMesh}{i}});}
\DoxyCodeLine{\ \ \ \ \ }
\DoxyCodeLine{\ \ \ \ \ \textcolor{comment}{//\ ...and\ doc\ it\ as\ pinned}}
\DoxyCodeLine{\ \ \ \ \ \mbox{\hyperlink{classElasticTetMesh}{bc\_file}}\ <<\ \mbox{\hyperlink{classElasticTetMesh}{nod\_pt}}-\/>x(\mbox{\hyperlink{classElasticTetMesh}{i}})\ <<\ \textcolor{stringliteral}{"{}\ "{}};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \mbox{\hyperlink{classElasticTetMesh}{bc\_file}}\ <<\ std::endl;}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\ \mbox{\hyperlink{classElasticTetMesh}{bc\_file}}.close();}

\end{DoxyCodeInclude}
 Finally, we complete the build of the solid elements by specifying their constitutive equation and the body force before assigning the equation numbers.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Complete\ the\ build\ of\ all\ elements\ so\ they\ are\ fully\ functional}}
\DoxyCodeLine{\ \mbox{\hyperlink{classElasticTetMesh}{n\_element}}\ =\ Solid\_mesh\_pt-\/>nelement();}
\DoxyCodeLine{\ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classElasticTetMesh}{i}}=0;\mbox{\hyperlink{classElasticTetMesh}{i}}<\mbox{\hyperlink{classElasticTetMesh}{n\_element}};\mbox{\hyperlink{classElasticTetMesh}{i}}++)}
\DoxyCodeLine{\ \ \{}
\DoxyCodeLine{\ \ \ \textcolor{comment}{//Cast\ to\ a\ solid\ element}}
\DoxyCodeLine{\ \ \ \mbox{\hyperlink{classElasticTetMesh}{ELEMENT}}\ *\mbox{\hyperlink{classElasticTetMesh}{el\_pt}}\ =\ \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classElasticTetMesh}{ELEMENT}}*\textcolor{keyword}{>}(Solid\_mesh\_pt-\/>element\_pt(\mbox{\hyperlink{classElasticTetMesh}{i}}));}
\DoxyCodeLine{\ \ \ }
\DoxyCodeLine{\ \ \ \textcolor{comment}{//\ Set\ the\ constitutive\ law}}
\DoxyCodeLine{\ \ \ \mbox{\hyperlink{classElasticTetMesh}{el\_pt}}-\/>constitutive\_law\_pt()\ =}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a5d5f19442938130d36ee7476ae25049c}{Global\_Physical\_Variables::Constitutive\_law\_pt}};}
\DoxyCodeLine{\ \ \ }
\DoxyCodeLine{\ \ \ \textcolor{comment}{//Set\ the\ body\ force}}
\DoxyCodeLine{\ \ \ \mbox{\hyperlink{classElasticTetMesh}{el\_pt}}-\/>body\_force\_fct\_pt()\ =\ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a0777aef63372db7f91ad894c38159681}{Global\_Physical\_Variables::gravity}};}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\ \ \ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Setup\ equation\ numbering\ scheme}}
\DoxyCodeLine{\ \mbox{\hyperlink{classElasticTetMesh}{cout}}\ <<\textcolor{stringliteral}{"{}Number\ of\ equations:\ "{}}\ <<\ \mbox{\hyperlink{classElasticTetMesh}{assign\_eqn\_numbers}}()\ <<\ std::endl;\ }
\DoxyCodeLine{\ }
\DoxyCodeLine{\}\ \textcolor{comment}{//end\ constructor}}

\end{DoxyCodeInclude}


\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_doc}{}\doxysection{\texorpdfstring{Post-\/processing}{Post-processing}}\label{index_doc}
The post-\/processing routine outputs the deformed domain shape and the applied traction. In the spirit of continuing paranoia we also document the domain boundaries; see \doxysectlink{index_comm_ex}{Comments and Exercises}{1}.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{///\ Doc\ the\ solution}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class}\ ELEMENT>}
\DoxyCodeLine{\textcolor{keywordtype}{void}\ \mbox{\hyperlink{classUnstructuredSolidProblem_ab3d66fd61b69d12b4f159d763fc44f15}{UnstructuredSolidProblem<ELEMENT>::doc\_solution}}(\mbox{\hyperlink{classElasticTetMesh}{DocInfo}}\&\ \mbox{\hyperlink{classElasticTetMesh}{doc\_info}})}
\DoxyCodeLine{\{\ }
\DoxyCodeLine{}
\DoxyCodeLine{\ \mbox{\hyperlink{classElasticTetMesh}{ofstream}}\ \mbox{\hyperlink{classElasticTetMesh}{some\_file}};}
\DoxyCodeLine{\ \textcolor{keywordtype}{char}\ \mbox{\hyperlink{classElasticTetMesh}{filename}}[100];}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Number\ of\ plot\ points}}
\DoxyCodeLine{\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classElasticTetMesh}{npts}};}
\DoxyCodeLine{\ \mbox{\hyperlink{classElasticTetMesh}{npts}}=5;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Output\ solution}}
\DoxyCodeLine{\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\ \mbox{\hyperlink{classElasticTetMesh}{sprintf}}(\mbox{\hyperlink{classElasticTetMesh}{filename}},\textcolor{stringliteral}{"{}\%s/soln\%i.dat"{}},\mbox{\hyperlink{classElasticTetMesh}{doc\_info}}.directory().c\_str(),}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classElasticTetMesh}{doc\_info}}.number());}
\DoxyCodeLine{\ \mbox{\hyperlink{classElasticTetMesh}{some\_file}}.open(\mbox{\hyperlink{classElasticTetMesh}{filename}});}
\DoxyCodeLine{\ Solid\_mesh\_pt-\/>output(\mbox{\hyperlink{classElasticTetMesh}{some\_file}},\mbox{\hyperlink{classElasticTetMesh}{npts}});}
\DoxyCodeLine{\ \mbox{\hyperlink{classElasticTetMesh}{some\_file}}.close();}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Output\ traction}}
\DoxyCodeLine{\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\ \mbox{\hyperlink{classElasticTetMesh}{sprintf}}(\mbox{\hyperlink{classElasticTetMesh}{filename}},\textcolor{stringliteral}{"{}\%s/traction\%i.dat"{}},\mbox{\hyperlink{classElasticTetMesh}{doc\_info}}.directory().c\_str(),}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classElasticTetMesh}{doc\_info}}.number());}
\DoxyCodeLine{\ \mbox{\hyperlink{classElasticTetMesh}{some\_file}}.open(\mbox{\hyperlink{classElasticTetMesh}{filename}});}
\DoxyCodeLine{\ Traction\_mesh\_pt-\/>output(\mbox{\hyperlink{classElasticTetMesh}{some\_file}},\mbox{\hyperlink{classElasticTetMesh}{npts}});}
\DoxyCodeLine{\ \mbox{\hyperlink{classElasticTetMesh}{some\_file}}.close();}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Output\ boundaries}}
\DoxyCodeLine{\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\ \mbox{\hyperlink{classElasticTetMesh}{sprintf}}(\mbox{\hyperlink{classElasticTetMesh}{filename}},\textcolor{stringliteral}{"{}\%s/boundaries.dat"{}},\mbox{\hyperlink{classElasticTetMesh}{doc\_info}}.directory().c\_str());}
\DoxyCodeLine{\ \mbox{\hyperlink{classElasticTetMesh}{some\_file}}.open(\mbox{\hyperlink{classElasticTetMesh}{filename}});}
\DoxyCodeLine{\ Solid\_mesh\_pt-\/>output\_boundaries(\mbox{\hyperlink{classElasticTetMesh}{some\_file}});}
\DoxyCodeLine{\ \mbox{\hyperlink{classElasticTetMesh}{some\_file}}.close();}
\DoxyCodeLine{}
\DoxyCodeLine{\}}

\end{DoxyCodeInclude}


\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_comm_ex}{}\doxysection{\texorpdfstring{Comments and Exercises}{Comments and Exercises}}\label{index_comm_ex}
\hypertarget{index_bound}{}\doxysubsection{\texorpdfstring{Identification/assignment of mesh boundaries}{Identification/assignment of mesh boundaries}}\label{index_bound}
This tutorial demonstrates that the use of unstructured meshes for solid mechanics problems is extremely straightforward. The only aspect that requires some care (and not just for solid mechanics applications) is the correct identification/assignment of domain boundaries when the mesh is generated with \href{http://en.wikipedia.org/wiki/Xfig}{\texttt{ xfig.}} The fact that we documented the mesh boundaries and the positions of the pinned nodes in the driver code suggests (correctly!) that we managed to get both assignments (slightly) wrong when we first wrote the driver code. The manual identification of nodes on domain boundaries is tedious and therefore error prone and, as usual, it pays to {\bfseries{be as a paranoid as possible}}! Ignore this advice at your own risk...

We also welcome any improvements to our conversion code \href{../../../../demo_drivers/meshing/mesh_from_xfig_triangle/fig2poly.cc}{\texttt{ fig2poly.\+cc }} that would allow the specification of domain boundaries from within \href{http://en.wikipedia.org/wiki/Xfig}{\texttt{ xfig.}} It\textquotesingle{}s probably not possible but if you have any ideas how to go about this (either by hijacking information that can be generated by \href{http://en.wikipedia.org/wiki/Xfig}{\texttt{ xfig}} or via some other GUI interface), \href{../../../contact/html/index.html}{\texttt{ let us know.}}

\DoxyHorRuler{0}
\hypertarget{index_three_d}{}\doxysubsection{\texorpdfstring{3\+D Problems}{3D Problems}}\label{index_three_d}
Unstructured meshes may also be used for the 3D solid mechanics problems. The overall procedure is very similar to that documented above, we will not provide a detailed discussion of the corresponding 3D driver code

\begin{center} \href{../../../../demo_drivers/solid/unstructured_solid/unstructured_three_d_solid.cc}{\texttt{ demo\+\_\+drivers/solid/unstructured\+\_\+solid/unstructured\+\_\+three\+\_\+d\+\_\+solid.\+cc }} \end{center} 

which computes the deformation of the hollow cube used in the \href{../../../meshes/mesh_from_tetgen/html/index.html}{\texttt{ Mesh Generation with Tetgen Tutorial}}.

Here is an animation of the cube\textquotesingle{}s deformation when it is subjected to gravity, acting in the negative $ z $-\/direction, and a "{}suction"{} force applied on the upper face, while its right face is held in a fixed position.

 
\begin{DoxyImage}
\includegraphics[width=0.75\textwidth]{three_d}
\doxyfigcaption{Plot of the deformation of a hollow 3D cube. }
\end{DoxyImage}


An alternative three-\/dimensional problem\+: the deformation of a bifurcating tube is described \href{../../unstructured_three_d_solid/html/index.html}{\texttt{ here. }}

\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_sources}{}\doxysection{\texorpdfstring{Source files for this tutorial}{Source files for this tutorial}}\label{index_sources}

\begin{DoxyItemize}
\item The source files for this tutorial are located in the directory\+:~\newline
~\newline
\begin{center} \href{../../../../demo_drivers/solid/unstructured_solid/}{\texttt{ demo\+\_\+drivers/solid/unstructured\+\_\+solid/ }} \end{center} ~\newline

\item The driver codes are\+: ~\newline
~\newline
\begin{center} \href{../../../../demo_drivers/solid/unstructured_solid/unstructured_two_d_solid.cc}{\texttt{ demo\+\_\+drivers/solid/unstructured\+\_\+solid/unstructured\+\_\+two\+\_\+d\+\_\+solid.\+cc }} \end{center}  and \begin{center} \href{../../../../demo_drivers/solid/unstructured_solid/unstructured_three_d_solid.cc}{\texttt{ demo\+\_\+drivers/solid/unstructured\+\_\+solid/unstructured\+\_\+three\+\_\+d\+\_\+solid.\+cc }} \end{center} 
\end{DoxyItemize}

\DoxyHorRuler{0}
 \DoxyHorRuler{0}
 \hypertarget{index_pdf}{}\doxysection{\texorpdfstring{PDF file}{PDF file}}\label{index_pdf}
A \href{../latex/refman.pdf}{\texttt{ pdf version}} of this document is available. \end{document}
