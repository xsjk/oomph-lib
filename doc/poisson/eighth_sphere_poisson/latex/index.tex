\chapter{Example problem\+: Adaptive solution of the 3D Poisson equation in a spherical domain}
\hypertarget{index}{}\label{index}\index{Example problem: Adaptive solution of the 3D Poisson equation in a spherical domain@{Example problem: Adaptive solution of the 3D Poisson equation in a spherical domain}}
Following the numerous 2D problems discussed in earlier examples we now demonstrate that the solution of 3D problems is just as easy. For this purpose we discuss the adaptive solution of the 3D Poisson problem \begin{center} \tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{1}{|X[-1]}|}
\hline
\begin{center} {\bfseries{Three-\/dimensional model Poisson problem}} \end{center}  Solve  \[
\sum_{i=1}^3 \frac{\partial^2u}{\partial x_i^2} = f(x_1,x_2,x_3),
 \ \ \ \ \ \ \ \ \ \ (1)
\] in the "{}eighth-\/of-\/a-\/sphere"{} domain $D$, with Dirichlet boundary conditions  \[
\left. u\right|_{\partial D}=u_0 
\ \ \ \ \ \ \ \ \ \ (2)
\] where the function $ u_0 $ is given.   \\\cline{1-1}
\end{longtabu}
~\newline
 \end{center} 

We choose a source function and boundary conditions for which  \[
u_0(x_1,x_2,x_3) = 
\tanh\left(1-\alpha(({\bf x}-{\bf x_0}) \cdot {\bf N})\right),
\ \ \ \ \ \ \ \ \  (3)
\] is the exact solution. Here where ${\bf x} = (x_1,x_2,x_3)$ ~\newline
 is the vector of the spatial coordinates, and the vectors ${\bf x}_0 = \left(x_1^{(0)},x_2^{(0)},x_3^{(0)}\right)$ and ${\bf N}_0 = (N_1,N_2,N_3)$ are constants. For large values of the constant $ \alpha $ the solution varies rapidly across the plane through ${\bf x}_0$ whose normal is given by ${\bf N}$.

Here are some plots of the exact and computed solutions for ${\bf x}_0 = (0,0,0)$, ${\bf N}_0 = 1/\sqrt{3} \ (-1,-1,1)$, and $ \alpha=50$ at various levels of mesh refinement. Note that the plot of the exact solution was produced by setting the nodal values to the exact solution, obtained by evaluating (3) at the nodal positions. The elements\textquotesingle{} basis functions were then used to interpolate between the nodal values. On the coarse meshes, the interpolation between the "{}exact"{} nodal values is clearly inadequate to resolve the rapid variation of the solution.

 
\begin{DoxyImage}
\includegraphics[width=0.75\textwidth]{eight_sphere_poisson}
\doxyfigcaption{Plot of the solution }
\end{DoxyImage}


\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_global}{}\doxysection{\texorpdfstring{Global parameters and functions}{Global parameters and functions}}\label{index_global}
Following our usual practice, we use a namespace, {\ttfamily \doxylink{namespaceTanhSolnForPoisson}{Tanh\+Soln\+For\+Poisson}}, to define the source function, the exact solution and various problem parameters.

 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//=============start\_of\_namespace=====================================}}
\DoxyCodeLine{\textcolor{comment}{///\ Namespace\ for\ exact\ solution\ for\ Poisson\ equation\ with\ sharp\ step\ }}
\DoxyCodeLine{\textcolor{comment}{//====================================================================}}
\DoxyCodeLine{\textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceTanhSolnForPoisson}{TanhSolnForPoisson}}}
\DoxyCodeLine{\{}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Parameter\ for\ steepness\ of\ step}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespaceTanhSolnForPoisson_ae676ccd186d5df119cce811596d949c1}{Alpha}}=1;}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Orientation\ (non-\/normalised\ x-\/component\ of\ unit\ vector\ in\ direction}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ of\ step\ plane)}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}=-\/1.0;}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Orientation\ (non-\/normalised\ y-\/component\ of\ unit\ vector\ in\ direction}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ of\ step\ plane)}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}=-\/1.0;}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Orientation\ (non-\/normalised\ z-\/component\ of\ unit\ vector\ in\ direction}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ of\ step\ plane)}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}=1.0;}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Orientation\ (x-\/coordinate\ of\ step\ plane)\ }}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespaceTanhSolnForPoisson_af55e0479c15ab58929eb96ee9d6cf07a}{X\_0}}=0.0;}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Orientation\ (y-\/coordinate\ of\ step\ plane)\ }}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespaceTanhSolnForPoisson_addc6dc6578b16a1d9aa774c25776b921}{Y\_0}}=0.0;}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Orientation\ (z-\/coordinate\ of\ step\ plane)\ }}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespaceTanhSolnForPoisson_abf4856ed1855c34c2b2ea57fd6783644}{Z\_0}}=0.0;}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Exact\ solution\ as\ a\ Vector}}
\DoxyCodeLine{\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespaceTanhSolnForPoisson_af7896e9c18ce6438c73ae2a875e8b7de}{get\_exact\_u}}(\textcolor{keyword}{const}\ Vector<double>\&\ x,\ Vector<double>\&\ u)}
\DoxyCodeLine{\ \{}
\DoxyCodeLine{\ \ u[0]\ =\ tanh(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae676ccd186d5df119cce811596d949c1}{Alpha}}*((x[0]-\/\mbox{\hyperlink{namespaceTanhSolnForPoisson_af55e0479c15ab58929eb96ee9d6cf07a}{X\_0}})*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}/sqrt(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}})+(x[1]-\/\mbox{\hyperlink{namespaceTanhSolnForPoisson_addc6dc6578b16a1d9aa774c25776b921}{Y\_0}})*}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}/sqrt(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}})+(x[2]-\/\mbox{\hyperlink{namespaceTanhSolnForPoisson_abf4856ed1855c34c2b2ea57fd6783644}{Z\_0}})*}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}/sqrt(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}})));}
\DoxyCodeLine{\ \}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Exact\ solution\ as\ a\ scalar}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespaceTanhSolnForPoisson_af7896e9c18ce6438c73ae2a875e8b7de}{get\_exact\_u}}(\textcolor{keyword}{const}\ Vector<double>\&\ x,\ \textcolor{keywordtype}{double}\&\ u)}
\DoxyCodeLine{\ \{}
\DoxyCodeLine{\ \ u\ =\ tanh(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae676ccd186d5df119cce811596d949c1}{Alpha}}*((x[0]-\/\mbox{\hyperlink{namespaceTanhSolnForPoisson_af55e0479c15ab58929eb96ee9d6cf07a}{X\_0}})*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}/sqrt(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}})+(x[1]-\/\mbox{\hyperlink{namespaceTanhSolnForPoisson_addc6dc6578b16a1d9aa774c25776b921}{Y\_0}})*}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}/sqrt(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}})+(x[2]-\/\mbox{\hyperlink{namespaceTanhSolnForPoisson_abf4856ed1855c34c2b2ea57fd6783644}{Z\_0}})*}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}/sqrt(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}})));}
\DoxyCodeLine{\ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Source\ function\ to\ make\ it\ an\ exact\ solution\ }}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespaceTanhSolnForPoisson_ae1b9d6789ff301e3d63a4e292213036c}{get\_source}}(\textcolor{keyword}{const}\ Vector<double>\&\ x,\ \textcolor{keywordtype}{double}\&\ source)}
\DoxyCodeLine{\ \{}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \textcolor{keywordtype}{double}\ s1,s2,s3,s4;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ s1\ =\ -\/2.0*tanh(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae676ccd186d5df119cce811596d949c1}{Alpha}}*((x[0]-\/\mbox{\hyperlink{namespaceTanhSolnForPoisson_af55e0479c15ab58929eb96ee9d6cf07a}{X\_0}})*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}/sqrt(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}})+(x[1]-\/}
\DoxyCodeLine{\mbox{\hyperlink{namespaceTanhSolnForPoisson_addc6dc6578b16a1d9aa774c25776b921}{Y\_0}})*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}/sqrt(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}})+(x[2]-\/\mbox{\hyperlink{namespaceTanhSolnForPoisson_abf4856ed1855c34c2b2ea57fd6783644}{Z\_0}})*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}/sqrt(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*}
\DoxyCodeLine{\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}})))*(1.0-\/pow(tanh(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae676ccd186d5df119cce811596d949c1}{Alpha}}*((x[0]-\/\mbox{\hyperlink{namespaceTanhSolnForPoisson_af55e0479c15ab58929eb96ee9d6cf07a}{X\_0}})*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}/sqrt(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}})+(x[1]-\/}
\DoxyCodeLine{\mbox{\hyperlink{namespaceTanhSolnForPoisson_addc6dc6578b16a1d9aa774c25776b921}{Y\_0}})*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}/sqrt(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}})+(x[2]-\/\mbox{\hyperlink{namespaceTanhSolnForPoisson_abf4856ed1855c34c2b2ea57fd6783644}{Z\_0}})*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}/sqrt(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*}
\DoxyCodeLine{\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}))),2.0))*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae676ccd186d5df119cce811596d949c1}{Alpha}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae676ccd186d5df119cce811596d949c1}{Alpha}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}/(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}});}
\DoxyCodeLine{\ \ \ \ \ \ s3\ =\ -\/2.0*tanh(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae676ccd186d5df119cce811596d949c1}{Alpha}}*((x[0]-\/\mbox{\hyperlink{namespaceTanhSolnForPoisson_af55e0479c15ab58929eb96ee9d6cf07a}{X\_0}})*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}/sqrt(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}})+(x[1]-\/}
\DoxyCodeLine{\mbox{\hyperlink{namespaceTanhSolnForPoisson_addc6dc6578b16a1d9aa774c25776b921}{Y\_0}})*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}/sqrt(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}})+(x[2]-\/\mbox{\hyperlink{namespaceTanhSolnForPoisson_abf4856ed1855c34c2b2ea57fd6783644}{Z\_0}})*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}/sqrt(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*}
\DoxyCodeLine{\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}})))*(1.0-\/pow(tanh(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae676ccd186d5df119cce811596d949c1}{Alpha}}*((x[0]-\/\mbox{\hyperlink{namespaceTanhSolnForPoisson_af55e0479c15ab58929eb96ee9d6cf07a}{X\_0}})*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}/sqrt(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}})+(x[1]-\/}
\DoxyCodeLine{\mbox{\hyperlink{namespaceTanhSolnForPoisson_addc6dc6578b16a1d9aa774c25776b921}{Y\_0}})*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}/sqrt(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}})+(x[2]-\/\mbox{\hyperlink{namespaceTanhSolnForPoisson_abf4856ed1855c34c2b2ea57fd6783644}{Z\_0}})*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}/sqrt(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*}
\DoxyCodeLine{\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}))),2.0))*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae676ccd186d5df119cce811596d949c1}{Alpha}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae676ccd186d5df119cce811596d949c1}{Alpha}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}/(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}});}
\DoxyCodeLine{\ \ \ \ \ \ s4\ =\ -\/2.0*tanh(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae676ccd186d5df119cce811596d949c1}{Alpha}}*((x[0]-\/\mbox{\hyperlink{namespaceTanhSolnForPoisson_af55e0479c15ab58929eb96ee9d6cf07a}{X\_0}})*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}/sqrt(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}})+(x[1]-\/}
\DoxyCodeLine{\mbox{\hyperlink{namespaceTanhSolnForPoisson_addc6dc6578b16a1d9aa774c25776b921}{Y\_0}})*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}/sqrt(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}})+(x[2]-\/\mbox{\hyperlink{namespaceTanhSolnForPoisson_abf4856ed1855c34c2b2ea57fd6783644}{Z\_0}})*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}/sqrt(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*}
\DoxyCodeLine{\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}})))*(1.0-\/pow(tanh(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae676ccd186d5df119cce811596d949c1}{Alpha}}*((x[0]-\/\mbox{\hyperlink{namespaceTanhSolnForPoisson_af55e0479c15ab58929eb96ee9d6cf07a}{X\_0}})*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}/sqrt(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}})+(x[1]-\/}
\DoxyCodeLine{\mbox{\hyperlink{namespaceTanhSolnForPoisson_addc6dc6578b16a1d9aa774c25776b921}{Y\_0}})*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}/sqrt(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}})+(x[2]-\/\mbox{\hyperlink{namespaceTanhSolnForPoisson_abf4856ed1855c34c2b2ea57fd6783644}{Z\_0}})*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}/sqrt(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*}
\DoxyCodeLine{\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}))),2.0))*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae676ccd186d5df119cce811596d949c1}{Alpha}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae676ccd186d5df119cce811596d949c1}{Alpha}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}/(\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ac3d25f0791c1363f487600e02757bc97}{N\_x}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_a482d668ef91071985d1f4ce7cf29a926}{N\_y}}+\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}}*\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae6b5b5d21747a45776004756dc97dc5c}{N\_z}});}
\DoxyCodeLine{\ \ \ \ \ \ s2\ =\ s3+s4;}
\DoxyCodeLine{\ \ \ \ \ \ source\ =\ s1+s2;}
\DoxyCodeLine{\ \}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\}\ \textcolor{comment}{//\ end\ of\ namespace}}

\end{DoxyCodeInclude}


\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_main}{}\doxysection{\texorpdfstring{The driver code}{The driver code}}\label{index_main}
The driver code solves the 3D Poisson problem with full spatial adaptivity -- a fairly time-\/consuming process. To minimise the run-\/times when the code is executed during {\ttfamily oomph-\/lib\textquotesingle{}s} self-\/tests, we use command line arguments to optionally limit the number of adaptive refinements. If the code is run with a(ny) command line arguments, only a single adaptive refinement is performed; otherwise up to four levels of refinement are permitted. {\ttfamily oomph-\/lib} provides storage for the command line arguments in the namespace {\ttfamily Command\+Line\+Args} to make them accessible to other parts of the code.

Otherwise the driver code is very similar to that used in the \href{../../../poisson/fish_poisson/html/index.html}{\texttt{ corresponding 2D Poisson problems}}\+: We construct the problem, passing the pointer to the source function. Next, we create a {\ttfamily Doc\+Info} object to specify the output directory, and execute the global self-\/test to assert that the problem has been set up correctly. Next we solve the problem on the coarse initial mesh (comprising four 27-\/node brick elements) and then adapt the problem based on the elemental error estimates, until the maximum number of adaptations has been reached or until the adaptation ceases to changes the mesh.

 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//=========start\_of\_main=============================================}}
\DoxyCodeLine{\textcolor{comment}{///\ Driver\ for\ 3D\ Poisson\ problem\ in\ eighth\ of\ a\ sphere.\ Solution\ }\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{///\ has\ a\ sharp\ step.\ If\ there\ are}}
\DoxyCodeLine{\textcolor{comment}{///\ any\ command\ line\ arguments,\ we\ regard\ this\ as\ a\ validation\ run}}
\DoxyCodeLine{\textcolor{comment}{///\ and\ perform\ only\ a\ single\ adaptation.}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\textcolor{keywordtype}{int}\ \mbox{\hyperlink{eighth__sphere__poisson_8cc_a0ddf1224851353fc92bfbff6f499fa97}{main}}(\textcolor{keywordtype}{int}\ argc,\ \textcolor{keywordtype}{char}\ *argv[])\ }
\DoxyCodeLine{\{\ }
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Store\ command\ line\ arguments}}
\DoxyCodeLine{\ CommandLineArgs::setup(argc,argv);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Set\ up\ the\ problem\ with\ 27-\/node\ brick\ elements,\ pass\ pointer\ to\ }}
\DoxyCodeLine{\ \textcolor{comment}{//\ source\ function}}
\DoxyCodeLine{\ \mbox{\hyperlink{classEighthSpherePoissonProblem}{EighthSpherePoissonProblem<RefineableQPoissonElement<3,3>}}\ >}
\DoxyCodeLine{\ \ problem(\&\mbox{\hyperlink{namespaceTanhSolnForPoisson_ae1b9d6789ff301e3d63a4e292213036c}{TanhSolnForPoisson::get\_source}});}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Setup\ labels\ for\ output}}
\DoxyCodeLine{\ \ DocInfo\ doc\_info;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Output\ directory}}
\DoxyCodeLine{\ doc\_info.set\_directory(\textcolor{stringliteral}{"{}RESLT"{}});}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Step\ number}}
\DoxyCodeLine{\ doc\_info.number()=0;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Check\ if\ we're\ ready\ to\ go}}
\DoxyCodeLine{\ cout\ <<\ \textcolor{stringliteral}{"{}Self\ test:\ "{}}\ <<\ problem.self\_test()\ <<\ std::endl;}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//\ Solve\ the\ problem}}
\DoxyCodeLine{\ problem.newton\_solve();}
\DoxyCodeLine{\ }
\DoxyCodeLine{\ \textcolor{comment}{//Output\ solution}}
\DoxyCodeLine{\ problem.doc\_solution(doc\_info);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//Increment\ counter\ for\ solutions\ }}
\DoxyCodeLine{\ doc\_info.number()++;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Now\ do\ (up\ to)\ three\ rounds\ of\ fully\ automatic\ adapation\ in\ response\ to\ }}
\DoxyCodeLine{\ \textcolor{comment}{//\ error\ estimate}}
\DoxyCodeLine{\ \textcolor{keywordtype}{unsigned}\ max\_solve;}
\DoxyCodeLine{\ \textcolor{keywordflow}{if}\ (CommandLineArgs::Argc>1)}
\DoxyCodeLine{\ \ \{}
\DoxyCodeLine{\ \ \ \textcolor{comment}{//\ Validation\ run:\ Just\ one\ adaptation}}
\DoxyCodeLine{\ \ \ max\_solve=1;}
\DoxyCodeLine{\ \ \ cout\ <<\ \textcolor{stringliteral}{"{}Only\ doing\ one\ adaptation\ for\ validation"{}}\ <<\ std::endl;}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\ \ \{}
\DoxyCodeLine{\ \ \ \textcolor{comment}{//\ Up\ to\ four\ adaptations}}
\DoxyCodeLine{\ \ \ max\_solve=4;}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ isolve=0;isolve<max\_solve;isolve++)}
\DoxyCodeLine{\ \ \{}
\DoxyCodeLine{\ \ \ \textcolor{comment}{//\ Adapt\ problem/mesh}}
\DoxyCodeLine{\ \ \ problem.adapt();\ }
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\ \ \ \textcolor{comment}{//\ Re-\/solve\ the\ problem\ if\ the\ adaptation\ has\ changed\ anything}}
\DoxyCodeLine{\ \ \ \textcolor{keywordflow}{if}\ ((problem.mesh\_pt()-\/>nrefined()\ \ !=0)||}
\DoxyCodeLine{\ \ \ \ \ \ \ (problem.mesh\_pt()-\/>nunrefined()!=0))}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ problem.newton\_solve();}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ cout\ <<\ \textcolor{stringliteral}{"{}Mesh\ wasn't\ adapted\ -\/-\/>\ we'll\ stop\ here"{}}\ <<\ std::endl;}
\DoxyCodeLine{\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ }
\DoxyCodeLine{\ \ \ \textcolor{comment}{//Output\ solution}}
\DoxyCodeLine{\ \ \ problem.doc\_solution(doc\_info);}
\DoxyCodeLine{\ \ \ }
\DoxyCodeLine{\ \ \ \textcolor{comment}{//Increment\ counter\ for\ solutions\ }}
\DoxyCodeLine{\ \ \ doc\_info.number()++;}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//\ pause("{}done"{});}}
\DoxyCodeLine{}
\DoxyCodeLine{\}\ \textcolor{comment}{//\ end\ of\ main}}

\end{DoxyCodeInclude}


\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_problem}{}\doxysection{\texorpdfstring{The problem class}{The problem class}}\label{index_problem}
The problem class has the usual structure -- the only difference to the corresponding 2D codes is that the assignment of the boundary conditions in {\ttfamily actions\+\_\+before\+\_\+newton\+\_\+solve()} now involves thee nodal coordinates rather than two.

 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//=======start\_of\_class\_definition====================================}}
\DoxyCodeLine{\textcolor{comment}{///\ Poisson\ problem\ in\ refineable\ eighth\ of\ a\ sphere\ mesh.}}
\DoxyCodeLine{\textcolor{comment}{//====================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class}\ ELEMENT>}
\DoxyCodeLine{\textcolor{keyword}{class\ }\mbox{\hyperlink{classEighthSpherePoissonProblem}{EighthSpherePoissonProblem}}\ :\ \textcolor{keyword}{public}\ Problem}
\DoxyCodeLine{\{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{public}:}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Constructor:\ Pass\ pointer\ to\ source\ function}}
\DoxyCodeLine{\textcolor{comment}{}\ \mbox{\hyperlink{classEighthSpherePoissonProblem}{EighthSpherePoissonProblem}}(}
\DoxyCodeLine{\ \ PoissonEquations<3>::PoissonSourceFctPt\ source\_fct\_pt);}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Destructor:\ Empty}}
\DoxyCodeLine{\textcolor{comment}{}\ \mbox{\hyperlink{classEighthSpherePoissonProblem_a043c7aa08c939fdc019870ad2c2270cc}{\string~EighthSpherePoissonProblem}}()\{\}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Overload\ generic\ access\ function\ by\ one\ that\ returns}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ a\ pointer\ to\ the\ specific\ \ mesh}}
\DoxyCodeLine{\textcolor{comment}{}\ RefineableEighthSphereMesh<ELEMENT>*\ \mbox{\hyperlink{classEighthSpherePoissonProblem_a6264a1973b4779b4ffc8fcc1b584b775}{mesh\_pt}}()\ }
\DoxyCodeLine{\ \ \{}
\DoxyCodeLine{\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{dynamic\_cast<}RefineableEighthSphereMesh<ELEMENT>*\textcolor{keyword}{>}(Problem::mesh\_pt());}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Update\ the\ problem\ specs\ after\ solve\ (empty)}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEighthSpherePoissonProblem_a480189fe5d2f42fe3ff6062d5f151ea3}{actions\_after\_newton\_solve}}()\ \ \{\}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Update\ the\ problem\ specs\ before\ solve:\ }}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Set\ Dirchlet\ boundary\ conditions\ from\ exact\ solution.}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEighthSpherePoissonProblem_af82dd7abdf631950a68c997af314be5d}{actions\_before\_newton\_solve}}()}
\DoxyCodeLine{\ \{}
\DoxyCodeLine{\ \ \textcolor{comment}{//Loop\ over\ the\ boundaries}}
\DoxyCodeLine{\ \ \textcolor{keywordtype}{unsigned}\ num\_bound\ =\ \mbox{\hyperlink{classEighthSpherePoissonProblem_a6264a1973b4779b4ffc8fcc1b584b775}{mesh\_pt}}()-\/>nboundary();}
\DoxyCodeLine{\ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ ibound=0;ibound<num\_bound;ibound++)}
\DoxyCodeLine{\ \ \ \{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Loop\ over\ the\ nodes\ on\ boundary}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{unsigned}\ num\_nod=\mbox{\hyperlink{classEighthSpherePoissonProblem_a6264a1973b4779b4ffc8fcc1b584b775}{mesh\_pt}}()-\/>nboundary\_node(ibound);}
\DoxyCodeLine{\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ inod=0;inod<num\_nod;inod++)}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ Node*\ nod\_pt=\mbox{\hyperlink{classEighthSpherePoissonProblem_a6264a1973b4779b4ffc8fcc1b584b775}{mesh\_pt}}()-\/>boundary\_node\_pt(ibound,inod);}
\DoxyCodeLine{\ \ \ \ \ \textcolor{keywordtype}{double}\ u;}
\DoxyCodeLine{\ \ \ \ \ Vector<double>\ x(3);}
\DoxyCodeLine{\ \ \ \ \ x[0]=nod\_pt-\/>x(0);}
\DoxyCodeLine{\ \ \ \ \ x[1]=nod\_pt-\/>x(1);}
\DoxyCodeLine{\ \ \ \ \ x[2]=nod\_pt-\/>x(2);}
\DoxyCodeLine{\ \ \ \ \ \mbox{\hyperlink{namespaceTanhSolnForPoisson_af7896e9c18ce6438c73ae2a875e8b7de}{TanhSolnForPoisson::get\_exact\_u}}(x,u);}
\DoxyCodeLine{\ \ \ \ \ nod\_pt-\/>set\_value(0,u);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \}}
\DoxyCodeLine{\ \}}
\DoxyCodeLine{\ \textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Doc\ the\ solution}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEighthSpherePoissonProblem_ac8e9911536d04bab829cfe92bb40e302}{doc\_solution}}(DocInfo\&\ doc\_info);}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{private}:}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Pointer\ to\ source\ function}}
\DoxyCodeLine{\textcolor{comment}{}\ PoissonEquations<3>::PoissonSourceFctPt\ \mbox{\hyperlink{classEighthSpherePoissonProblem_af41ed0ce372d5932c64b3cd4fe69f312}{Source\_fct\_pt}};}
\DoxyCodeLine{}
\DoxyCodeLine{\};\ \textcolor{comment}{//\ end\ of\ class\ definition}}

\end{DoxyCodeInclude}
 \mbox{[}See the discussion of the \href{../../../poisson/one_d_poisson/html/index.html}{\texttt{ 1D Poisson problem}} for a more detailed discussion of the function type Poisson\+Equations$<$3$>$\+::\+Poisson\+Source\+Fct\+Pt.\mbox{]}

\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_constructor}{}\doxysection{\texorpdfstring{The Problem constructor}{The Problem constructor}}\label{index_constructor}
In the {\ttfamily Problem} constructor, we set the "{}steepness parameter"{} $ \alpha $ to a large value and create the mesh for a a sphere of radius 5. Next, we create the error estimator and pass it to the adaptive mesh.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//====================start\_of\_constructor================================}}
\DoxyCodeLine{\textcolor{comment}{///\ Constructor\ for\ Poisson\ problem\ on\ eighth\ of\ a\ sphere\ mesh}}
\DoxyCodeLine{\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class}\ ELEMENT>}
\DoxyCodeLine{\mbox{\hyperlink{classEighthSpherePoissonProblem_ae51db2c3e80f0d5628e4d81eb1c11db4}{EighthSpherePoissonProblem<ELEMENT>::EighthSpherePoissonProblem}}(}
\DoxyCodeLine{\ \ \ PoissonEquations<3>::PoissonSourceFctPt\ source\_fct\_pt)\ :\ }
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ Source\_fct\_pt(source\_fct\_pt)}
\DoxyCodeLine{\{\ }
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Setup\ parameters\ for\ exact\ tanh\ solution}}
\DoxyCodeLine{\ \textcolor{comment}{//\ Steepness\ of\ step}}
\DoxyCodeLine{\ \mbox{\hyperlink{namespaceTanhSolnForPoisson_ae676ccd186d5df119cce811596d949c1}{TanhSolnForPoisson::Alpha}}=50.0;}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{\ ///\ Create\ mesh\ for\ sphere\ of\ radius\ 5}}
\DoxyCodeLine{\textcolor{comment}{}\ \textcolor{keywordtype}{double}\ radius=5.0;\ }
\DoxyCodeLine{\ Problem::mesh\_pt()\ =\ \textcolor{keyword}{new}\ RefineableEighthSphereMesh<ELEMENT>(radius);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Set\ error\ estimator\ }}
\DoxyCodeLine{\ Z2ErrorEstimator*\ error\_estimator\_pt=\textcolor{keyword}{new}\ Z2ErrorEstimator;}
\DoxyCodeLine{\ mesh\_pt()-\/>spatial\_error\_estimator\_pt()=error\_estimator\_pt;}

\end{DoxyCodeInclude}
 We adjust the targets for the mesh adaptation so that the single mesh adaptation performed during a validation run produces a non-\/uniform refinement pattern. (The error targets for this case were determined by trial and error.) The tighter error tolerances specified otherwise are appropriate to properly resolve the solution, as shown in the animated gif files at the beginning of this document. 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\ \textcolor{comment}{//\ Adjust\ error\ targets\ for\ adaptive\ refinement}}
\DoxyCodeLine{\ \textcolor{keywordflow}{if}\ (CommandLineArgs::Argc>1)}
\DoxyCodeLine{\ \ \{}
\DoxyCodeLine{\ \ \ \textcolor{comment}{//\ Validation:\ Relax\ tolerance\ to\ get\ nonuniform\ refinement\ during}}
\DoxyCodeLine{\ \ \ \textcolor{comment}{//\ first\ step}}
\DoxyCodeLine{\ \ \ mesh\_pt()-\/>max\_permitted\_error()=0.7;}
\DoxyCodeLine{\ \ \ mesh\_pt()-\/>min\_permitted\_error()=0.5;}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\ \ \{}
\DoxyCodeLine{\ \ \ mesh\_pt()-\/>max\_permitted\_error()=0.01;}
\DoxyCodeLine{\ \ \ mesh\_pt()-\/>min\_permitted\_error()=0.001;}
\DoxyCodeLine{\ \ \}\ \textcolor{comment}{//\ end\ adjustment}}

\end{DoxyCodeInclude}
 Next, we assign the boundary conditions. In the present problem all boundaries are Dirichlet boundaries, therefore we loop over all nodes on all boundaries and pin their values. If only a subset of the mesh boundaries were of Dirichlet type, only the nodes on those boundaries would have to be pinned. "{}\+Usually"{} the numbering of the mesh boundaries is (or at least should be!) documented in the mesh constructor but it can also be obtained from the function {\ttfamily Mesh\+::output\+\_\+boundaries(...)} whose use is illustrated here.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\ \textcolor{comment}{//Doc\ the\ mesh\ boundaries}}
\DoxyCodeLine{\ ofstream\ some\_file;}
\DoxyCodeLine{\ some\_file.open(\textcolor{stringliteral}{"{}boundaries.dat"{}});}
\DoxyCodeLine{\ mesh\_pt()-\/>output\_boundaries(some\_file);}
\DoxyCodeLine{\ some\_file.close();}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Set\ the\ boundary\ conditions\ for\ this\ problem:\ All\ nodes\ are}}
\DoxyCodeLine{\ \textcolor{comment}{//\ free\ by\ default\ -\/-\/\ just\ pin\ the\ ones\ that\ have\ Dirichlet\ conditions}}
\DoxyCodeLine{\ \textcolor{comment}{//\ here\ (all\ the\ nodes\ on\ the\ boundary)}}
\DoxyCodeLine{\ \textcolor{keywordtype}{unsigned}\ num\_bound\ =\ mesh\_pt()-\/>nboundary();}
\DoxyCodeLine{\ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ ibound=0;ibound<num\_bound;ibound++)}
\DoxyCodeLine{\ \ \{}
\DoxyCodeLine{\ \ \ \textcolor{keywordtype}{unsigned}\ num\_nod=\ mesh\_pt()-\/>nboundary\_node(ibound);}
\DoxyCodeLine{\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ inod=0;inod<num\_nod;inod++)}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ mesh\_pt()-\/>boundary\_node\_pt(ibound,inod)-\/>pin(0);\ }
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \}\ \textcolor{comment}{//\ end\ of\ pinning}}

\end{DoxyCodeInclude}


Finally we loop over all elements to assign the source function pointer, and then call the generic {\ttfamily Problem\+::assign\+\_\+eqn\+\_\+numbers()} routine to set up the equation numbers.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\ \textcolor{comment}{//Find\ number\ of\ elements\ in\ mesh}}
\DoxyCodeLine{\ \textcolor{keywordtype}{unsigned}\ n\_element\ =\ mesh\_pt()-\/>nelement();}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Loop\ over\ the\ elements\ to\ set\ up\ element-\/specific\ }}
\DoxyCodeLine{\ \textcolor{comment}{//\ things\ that\ cannot\ be\ handled\ by\ constructor}}
\DoxyCodeLine{\ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ i=0;i<n\_element;i++)}
\DoxyCodeLine{\ \ \{}
\DoxyCodeLine{\ \ \ \textcolor{comment}{//\ Upcast\ from\ FiniteElement\ to\ the\ present\ element}}
\DoxyCodeLine{\ \ \ ELEMENT\ *el\_pt\ =\ \textcolor{keyword}{dynamic\_cast<}ELEMENT*\textcolor{keyword}{>}(mesh\_pt()-\/>element\_pt(i));}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \textcolor{comment}{//Set\ the\ source\ function\ pointer}}
\DoxyCodeLine{\ \ \ el\_pt-\/>source\_fct\_pt()\ =\ Source\_fct\_pt;}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Setup\ equation\ numbering\ }}
\DoxyCodeLine{\ cout\ <<\textcolor{stringliteral}{"{}Number\ of\ equations:\ "{}}\ <<\ assign\_eqn\_numbers()\ <<\ std::endl;\ }
\DoxyCodeLine{}
\DoxyCodeLine{\}\ \textcolor{comment}{//\ end\ of\ constructor}}

\end{DoxyCodeInclude}


\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_doc}{}\doxysection{\texorpdfstring{Post-\/processing}{Post-processing}}\label{index_doc}
The function {\ttfamily doc\+\_\+solution(...)} writes the FE solution and the corresponding exact solution, defined in {\ttfamily Tanh\+Soln\+For\+Poisson\+::get\+\_\+exact\+\_\+u(...)} to disk. The {\ttfamily Doc\+Info} object specifies the output directory and the label for the file names. \mbox{[}See the discussion of the ~\newline
 \href{../../../poisson/one_d_poisson/html/index.html}{\texttt{ 1D Poisson problem}} for a more detailed discussion of the generic {\ttfamily Mesh} member functions {\ttfamily Mesh\+::output(...)}, {\ttfamily Mesh\+::output\+\_\+fct(...)} and {\ttfamily Mesh\+::compute\+\_\+error(...)}\mbox{]}.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//========================start\_of\_doc====================================}}
\DoxyCodeLine{\textcolor{comment}{///\ Doc\ the\ solution}}
\DoxyCodeLine{\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class}\ ELEMENT>}
\DoxyCodeLine{\textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEighthSpherePoissonProblem_ac8e9911536d04bab829cfe92bb40e302}{EighthSpherePoissonProblem<ELEMENT>::doc\_solution}}(DocInfo\&\ doc\_info)}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ ofstream\ some\_file;}
\DoxyCodeLine{\ \textcolor{keywordtype}{char}\ filename[100];}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Number\ of\ plot\ points}}
\DoxyCodeLine{\ \textcolor{keywordtype}{unsigned}\ npts;}
\DoxyCodeLine{\ npts=5;\ }
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Output\ solution\ }}
\DoxyCodeLine{\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\ sprintf(filename,\textcolor{stringliteral}{"{}\%s/soln\%i.dat"{}},doc\_info.directory().c\_str(),}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ doc\_info.number());}
\DoxyCodeLine{\ some\_file.open(filename);}
\DoxyCodeLine{\ mesh\_pt()-\/>output(some\_file,npts);}
\DoxyCodeLine{\ some\_file.close();}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Output\ exact\ solution\ }}
\DoxyCodeLine{\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\ sprintf(filename,\textcolor{stringliteral}{"{}\%s/exact\_soln\%i.dat"{}},doc\_info.directory().c\_str(),}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ doc\_info.number());}
\DoxyCodeLine{\ some\_file.open(filename);}
\DoxyCodeLine{\ mesh\_pt()-\/>output\_fct(some\_file,npts,\mbox{\hyperlink{namespaceTanhSolnForPoisson_af7896e9c18ce6438c73ae2a875e8b7de}{TanhSolnForPoisson::get\_exact\_u}});\ }
\DoxyCodeLine{\ some\_file.close();}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\ \textcolor{comment}{//\ Doc\ error}}
\DoxyCodeLine{\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\ \textcolor{keywordtype}{double}\ error,norm;}
\DoxyCodeLine{\ sprintf(filename,\textcolor{stringliteral}{"{}\%s/error\%i.dat"{}},doc\_info.directory().c\_str(),}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ doc\_info.number());}
\DoxyCodeLine{\ some\_file.open(filename);}
\DoxyCodeLine{\ mesh\_pt()-\/>compute\_error(some\_file,\mbox{\hyperlink{namespaceTanhSolnForPoisson_af7896e9c18ce6438c73ae2a875e8b7de}{TanhSolnForPoisson::get\_exact\_u}},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ error,norm);\ }
\DoxyCodeLine{\ some\_file.close();}
\DoxyCodeLine{\ cout\ <<\ \textcolor{stringliteral}{"{}error:\ "{}}\ <<\ sqrt(error)\ <<\ std::endl;\ }
\DoxyCodeLine{\ cout\ <<\ \textcolor{stringliteral}{"{}norm\ :\ "{}}\ <<\ sqrt(norm)\ <<\ std::endl\ <<\ std::endl;}
\DoxyCodeLine{}
\DoxyCodeLine{\}\ \textcolor{comment}{//\ end\ of\ doc}}

\end{DoxyCodeInclude}


\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_sources}{}\doxysection{\texorpdfstring{Source files for this tutorial}{Source files for this tutorial}}\label{index_sources}

\begin{DoxyItemize}
\item The source files for this tutorial are located in the directory\+: \begin{center} \href{
../../../../
demo_drivers/poisson/eighth_sphere_poisson/
}{\texttt{ demo\+\_\+drivers/poisson/eighth\+\_\+sphere\+\_\+poisson/ }} \end{center} 
\item The driver code is\+: \begin{center} \href{
../../../../
demo_drivers/poisson/eighth_sphere_poisson/eighth_sphere_poisson.cc
}{\texttt{ demo\+\_\+drivers/poisson/eighth\+\_\+sphere\+\_\+poisson/eighth\+\_\+sphere\+\_\+poisson.\+cc }} \end{center} 
\end{DoxyItemize}

\DoxyHorRuler{0}
 \DoxyHorRuler{0}
 \hypertarget{index_pdf}{}\doxysection{\texorpdfstring{PDF file}{PDF file}}\label{index_pdf}
A \href{../latex/refman.pdf}{\texttt{ pdf version}} of this document is available. \end{document}
